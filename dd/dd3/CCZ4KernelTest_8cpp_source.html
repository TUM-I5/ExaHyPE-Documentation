<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/dd3/CCZ4KernelTest_8cpp_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">CCZ4KernelTest.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../dd/dd3/CCZ4KernelTest_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;<a class="code" href="../../d7/df2/CCZ4KernelTest_8h.html">CCZ4KernelTest.h</a>&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/df1/Globals_8h.html">peano4/utils/Globals.h</a>&quot;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/d9e/Loop_8h.html">peano4/utils/Loop.h</a>&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/dbe/Vector_8h.html">tarch/la/Vector.h</a>&quot;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d45/Log_8h.html">tarch/logging/Log.h</a>&quot;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="../../df/dc2/fd_2PatchUtils_8h.html">exahype2/fd/PatchUtils.h</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">//#include &quot;exahype2/CellData.h&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">//#include &quot;exahype2/fd/Functors.h&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/de4/FD4_8h.html">exahype2/fd/fd4/FD4.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;../applications/exahype2/ccz4/CCZ4Kernels.h&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;../applications/exahype2/ccz4/CCZ4Kernels.cpph&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="../../da/dc8/AoSLexicographicEnumerator_8h.html">exahype2/enumerator/AoSLexicographicEnumerator.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="../../df/dbd/SoALexicographicEnumerator_8h.html">exahype2/enumerator/SoALexicographicEnumerator.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/da0/AoSoALexicographicEnumerator_8h.html">exahype2/enumerator/AoSoALexicographicEnumerator.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="../../df/db1/math_8h.html">math.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="foldopen" id="foldopen00025" data-start="{" data-end="}">
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a85ba2937d40e26129d1091d985bf3807">   25</a></span><a class="code hl_function" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a85ba2937d40e26129d1091d985bf3807">exahype2::fd::tests::CCZ4KernelTest::CCZ4KernelTest</a>():</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>  TestCase (<span class="stringliteral">&quot;exahype2::fd::tests::CCZ4KernelTest&quot;</span>) {</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>}</div>
</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="foldopen" id="foldopen00030" data-start="{" data-end="}">
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a1a0231259e373cd60ab1c4fbe997d99b">   30</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a1a0231259e373cd60ab1c4fbe997d99b">exahype2::fd::tests::CCZ4KernelTest::run</a>() {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>  <a class="code hl_define" href="../../dc/d61/TestMacros_8h.html#a321d2883e56477558db3f31126b28b86">testMethod</a> (AppleWithAppleTest);</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>}</div>
</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="foldopen" id="foldopen00035" data-start="{" data-end="}">
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ab2b7f6c7f1896f153c037789f32b90f6">   35</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ab2b7f6c7f1896f153c037789f32b90f6">exahype2::fd::tests::CCZ4KernelTest::AppleWithAppleTest</a>() {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  <span class="comment">//in this test, the out layers inside the patch is not valid as the volumes </span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  <span class="comment">// in the halos can not update their first-derivatives. So only volumes with index between [3,26]^3</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="comment">// holds valid test data.</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <span class="comment">// make no sense to test in 2d</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">  #if Dimensions==3</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> unknowns = 59;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> auxiliaryVariables = 0;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numberOfDoFsPerAxisInCell = 30;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> haloSize = 3;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numberOfDoFsPerAxisInCellWithHalos= 30+2*haloSize;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;3, double&gt;</a> x({0.5, 0.5, 0.5});</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;3, double&gt;</a> <a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>({30.0/29.0, 30.0/29.0, 30.0/29.0});</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;3, int&gt;</a> currentPosition({0,0,0});</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>  <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;3, double&gt;</a> volumeCoordinates({0,0,0});</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="keywordtype">double</span>* oldQWithHalos = <span class="keyword">new</span> <span class="keywordtype">double</span>[numberOfDoFsPerAxisInCellWithHalos*numberOfDoFsPerAxisInCellWithHalos*numberOfDoFsPerAxisInCellWithHalos*(unknowns+auxiliaryVariables)];</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <span class="keywordtype">double</span>* QOut = <span class="keyword">new</span> <span class="keywordtype">double</span>[numberOfDoFsPerAxisInCell*numberOfDoFsPerAxisInCell*numberOfDoFsPerAxisInCell*(unknowns)];</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="comment">//random assignment here, keep the same with GRChombo.</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> scenario=1; <span class="comment">// 0-flat spacetime test case, 1-apple with apple test</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keywordflow">if</span> (scenario==0){ <span class="comment">//flat space</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xx = -haloSize; xx &lt; numberOfDoFsPerAxisInCell+haloSize; xx++)</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = -haloSize; yy &lt; numberOfDoFsPerAxisInCell+haloSize; yy++)</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> zz = -haloSize; zz &lt; numberOfDoFsPerAxisInCell+haloSize; zz++){</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>      currentPosition=gridCellIndex3d(xx,yy,zz); <span class="comment">//current index, notice the halo is included</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        volumeCoordinates(i)  = x(i)-0.5*<a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>(i);</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        volumeCoordinates(i) += (<a class="code hl_variable" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>(currentPosition(i))+0.5)*<a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>(i)/numberOfDoFsPerAxisInCell; <span class="comment">//current position</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>      }</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      <span class="comment">//notice if you index using this routie the index need to start from 0 not -halo!</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>      <span class="keywordtype">int</span> CellIndexSerialised  = <a class="code hl_function" href="../../d9/d8e/namespacepeano4_1_1utils.html#a4f1a4f16c96662b344839f6beb4cd095">peano4::utils::dLinearised</a>((currentPosition+<a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,int&gt;</a>(3)),</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                                                              numberOfDoFsPerAxisInCellWithHalos);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      <span class="comment">//assign quantities</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 0] = 1.0; <span class="comment">//\tilde{\gamma}_11</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 3] = 1.0; <span class="comment">//\tilde{\gamma}_22</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 5] = 1.0; <span class="comment">//\tilde{\gamma}_33</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+16] = 1.0; <span class="comment">//\alpha</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+54] = 1.0; <span class="comment">//\phi</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    }</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scenario==1){ <span class="comment">//apple with apple</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> xx = -haloSize; xx &lt; numberOfDoFsPerAxisInCell+haloSize; xx++)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy = -haloSize; yy &lt; numberOfDoFsPerAxisInCell+haloSize; yy++)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> zz = -haloSize; zz &lt; numberOfDoFsPerAxisInCell+haloSize; zz++){</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      currentPosition=gridCellIndex3d(xx,yy,zz); <span class="comment">//current index, notice the halo is included</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        volumeCoordinates(i)  = x(i)-0.5*<a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>(i);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        volumeCoordinates(i) += (<a class="code hl_variable" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>(currentPosition(i))+0.5)*<a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>(i)/numberOfDoFsPerAxisInCell; <span class="comment">//current position</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>      }</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      <span class="keywordtype">int</span> CellIndexSerialised  = <a class="code hl_function" href="../../d9/d8e/namespacepeano4_1_1utils.html#a4f1a4f16c96662b344839f6beb4cd095">peano4::utils::dLinearised</a>((currentPosition+<a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,int&gt;</a>(3)),</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                                                              numberOfDoFsPerAxisInCellWithHalos);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>      <span class="comment">//assign quantities</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      <span class="keywordtype">double</span> **g, **K;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>      <span class="keywordtype">double</span> phi, trK;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>      <span class="keywordtype">double</span> Theta, Gamma[3];</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>      <span class="keywordtype">double</span> alpha, <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[3], b[3];</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>      g = <span class="keyword">new</span> <span class="keywordtype">double</span>* [3]; K = <span class="keyword">new</span> <span class="keywordtype">double</span>* [3];</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0;l&lt;3;l++){</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        g[l]=<span class="keyword">new</span> <span class="keywordtype">double</span>[3]; K[l]=<span class="keyword">new</span> <span class="keywordtype">double</span>[3];</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>      }</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      prepareFieldData(g, phi, K, trK, Theta, Gamma, alpha, <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>, b,</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        volumeCoordinates(0), volumeCoordinates(1), volumeCoordinates(2));</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>      <span class="comment">//for (int i=0;i&lt;3;i++)</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      <span class="comment">//for (int j=0;j&lt;3;j++) </span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      <span class="comment">//double a=1.0/NAN;</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>      <span class="comment">//std::cout&lt;&lt;1.0/NAN&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 0] = g[0][0];  <span class="comment">// tilde{gamma}_ij</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 1] = g[0][1];</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 2] = g[0][2];</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 3] = g[1][1];</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 4] = g[1][2];</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 5] = g[2][2];</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 6] = K[0][0];  <span class="comment">// tilde{A}_ij  </span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 7] = K[0][1];</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 8] = K[0][2];</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+ 9] = K[1][1];</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+10] = K[1][2];</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+11] = K[2][2];</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+12] = Theta;    <span class="comment">// Theta</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+13] = Gamma[0]; <span class="comment">// hat{Gamma}^i</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+14] = Gamma[1];</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+15] = Gamma[2];</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+16] = alpha;    <span class="comment">// alpha</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+17] = <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[0];  <span class="comment">// beta^i</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+18] = <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[1];</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+19] = <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[2];</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+20] = b[0];     <span class="comment">// b^i</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+21] = b[1];</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+22] = b[2];</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+53] = trK;      <span class="comment">// K</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      oldQWithHalos[CellIndexSerialised*(unknowns+auxiliaryVariables)+54] = phi;      <span class="comment">// phi</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keyword">delete</span> g;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>      <span class="keyword">delete</span> K;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  <a class="code hl_struct" href="../../d4/d3a/structexahype2_1_1CellData.html">::exahype2::CellData</a> patchData(oldQWithHalos, x, <a class="code hl_variable" href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a>, 0, 0.01, QOut);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  <span class="comment">//set parameters</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4KOSigma=8.0;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4itau = 1.0;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4k1 = 0.1;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4k2 = 0.0;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4k3 = 0.5;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4eta = 1.0;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4f = 0.75;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4g = 0.0;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4xi = 1.0;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4e = 1.0;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4c = 1.0;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4mu = 0.2;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4ds = 1.0;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4sk = 1.0;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> CCZ4bs = 1.0;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> CCZ4LapseType = 1;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> CCZ4SO = 1;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  <span class="comment">//then calculate the derivatives first</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <span class="comment">//there is a potential seg error if number of auxiliary variables is not zero.</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  <span class="comment">//but without auxiliary variables everything should be fine. </span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <span class="comment">//notice only the volumes inside the patch get updated</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <a class="code hl_function" href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#abfef00e76cf5aaf5e781052a65ebdbb7">::exahype2::fd::fd4::reconstruct_first_derivatives</a>(</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    patchData,</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    numberOfDoFsPerAxisInCell,</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    haloSize,</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    unknowns,</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    auxiliaryVariables</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>  );</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <span class="comment">//call the kernel</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <a class="code hl_function" href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#ad4c3323ae9e4f3a07afd4d8f4b3476af">::exahype2::fd::fd4::timeStep_patchwise_heap_functors</a>(</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    patchData,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    numberOfDoFsPerAxisInCell,</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    haloSize,</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    unknowns,</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    auxiliaryVariables,</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    CCZ4KOSigma,</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>     <span class="keyword">false</span> ,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>     <span class="keyword">true</span> ,</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>     <span class="keyword">true</span> ,</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keyword">false</span>, <span class="comment">// do not copy the old solution. Abuse this to get the RHS directly</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <a class="code hl_enumvalue" href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#aa4d2f77c5b859acaaaed8eb4469cc4b2aad5364497f0c5e4925a250fad24f09c5">::exahype2::fd::fd4::DifferentialSourceTermVariant::CentralDifferencesWithLopsidedAdvection</a>,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    [&amp;](</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> * __restrict__ Q,</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  faceCentre,</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  volumeH,</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>      <span class="keywordtype">double</span>                                       t,</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>      <span class="keywordtype">double</span>                                       dt,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      <span class="keywordtype">int</span>                                          normal,</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>      <span class="keywordtype">double</span> * __restrict__ F</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    )-&gt;<span class="keywordtype">void</span> {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    },</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    [&amp;](</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> * __restrict__                  Q,</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> * __restrict__     deltaQ,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  faceCentre,</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  volumeH,</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      <span class="keywordtype">double</span>                                       t,</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      <span class="keywordtype">double</span>                                       dt,</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      <span class="keywordtype">int</span>                                          normal,</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      <span class="keywordtype">double</span> * __restrict__ BTimesDeltaQ</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    )-&gt;<span class="keywordtype">void</span> {   </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      <span class="keywordtype">double</span> gradQSerialised[unknowns*3];</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;unknowns; i++) {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        gradQSerialised[i+0*unknowns] = 0.0;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        gradQSerialised[i+1*unknowns] = 0.0;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        gradQSerialised[i+2*unknowns] = 0.0;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        gradQSerialised[i+normal*unknowns] = deltaQ[i];</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      }</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>      <span class="comment">//for (int i=NumberOfUnknowns; i&lt;NumberOfUnknowns+NumberOfAuxiliaryVariables; i++) {</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>      <span class="comment">//  BgradQ[i] = 0.0;</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <span class="comment">//}</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <a class="code hl_function" href="../../db/dbd/namespaceapplications_1_1exahype2_1_1ccz4.html#ab016a412646b8e0aa705dec0145dbb99">applications::exahype2::ccz4::ncp</a>(BTimesDeltaQ, Q, gradQSerialised, normal, CCZ4LapseType, CCZ4ds, CCZ4c, CCZ4e, CCZ4f, CCZ4bs, CCZ4sk, CCZ4xi, CCZ4mu, CCZ4SO);     </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    },</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    [&amp;](</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> * __restrict__ Q,</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  volumeX,</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;Dimensions,double&gt;</a>&amp;  volumeH,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      <span class="keywordtype">double</span>                                       t,</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>      <span class="keywordtype">double</span>                                       dt,</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      <span class="keywordtype">double</span> * __restrict__ S</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    )-&gt;<span class="keywordtype">void</span> {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      std::memset(S, 0, unknowns*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <a class="code hl_function" href="../../db/dbd/namespaceapplications_1_1exahype2_1_1ccz4.html#a347d1eb86d746d4dae4e64b1c694ff9d">applications::exahype2::ccz4::source</a>(S,Q, CCZ4LapseType, CCZ4ds, CCZ4c, CCZ4e, CCZ4f, CCZ4bs, CCZ4sk, CCZ4xi, CCZ4itau, CCZ4eta, CCZ4k1, CCZ4k2, CCZ4k3, CCZ4SO);   </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  );</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="comment">//examine the output, notice voulme index should between [3,26]^3</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="comment">//tarch::la::Vector&lt;3, int&gt; volumeIndex({15,15,15});</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  <span class="comment">//tarch::la::Vector&lt;3, int&gt; volumeIndex({8,20,17});</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>  <a class="code hl_struct" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector&lt;3, int&gt;</a> <a class="code hl_function" href="../../dd/d6c/namespaceexahype2.html#ae62a65e1dd6c633eee9a9b5aba6e14bc">volumeIndex</a>({23,9,18});</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  <span class="comment">//15,15,15</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  <span class="comment">//double dataArrayOfGRChombo[25]={-1.01737, -0.952962, 1.5358, 2.07569, -0.274332, -1.34847, 4.52609, 1.69924, 0.581672, -1.01265, 1.01734, -3.28122, -2.00355, 3.42196, 23.2832, 0.698199, 26.806, -2.87506, -1.21849, -4.32589, 4.44389, 18.9259, -2.17062, -11.1472, -0.0253941};</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  <span class="comment">//8,20,17</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>  <span class="comment">//double dataArrayOfGRChombo[25]={-1.39787, -0.754864, 1.71128, 1.41365, 1.63204, -0.675397, 6.08035, 2.31647, 1.3964, -1.59352, 1.60353, -4.44641, -0.945263, 2.65077, 36.1263, 2.48858, 36.1493, -5.74057, -4.27386, -8.90803, 3.83137, 29.8071, -3.80586, -10.7919, -0.0296434}; </span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  <span class="comment">//23,9,18</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  <span class="keywordtype">double</span> dataArrayOfGRChombo[25]={-3.1866, 0.365012, 3.35262, 0.0372327, 3.36914, 1.34624, 4.88302, 3.09191, 0.296349, -3.06936, 0.936401, -2.12479, 3.00939, 9.47752, 35.5824, -9.94656, 42.4051, -0.753163, 3.48535, -2.7644, 10.7661, 34.7114, -11.501, -9.21531, -0.359624};</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  <span class="keywordtype">int</span> checkingQ=0;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <a class="code hl_struct" href="../../dd/da8/structexahype2_1_1enumerator_1_1AoSLexicographicEnumerator.html">exahype2::enumerator::AoSLexicographicEnumerator</a> QInEnumerator (1,numberOfDoFsPerAxisInCell,haloSize,unknowns,auxiliaryVariables);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <a class="code hl_struct" href="../../dd/da8/structexahype2_1_1enumerator_1_1AoSLexicographicEnumerator.html">exahype2::enumerator::AoSLexicographicEnumerator</a> QOutEnumerator(1,numberOfDoFsPerAxisInCell,0,unknowns,0); <span class="comment">//halosize and auxiliary variables are both 0,</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++){</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    volumeCoordinates(i)  = patchData.<a class="code hl_variable" href="../../d4/d3a/structexahype2_1_1CellData.html#a1f39ab8a44a2e323de57050463e52c43">cellCentre</a>[0](i)-0.5*patchData.<a class="code hl_variable" href="../../d4/d3a/structexahype2_1_1CellData.html#ad9f375724052ada25ecd169c9e211628">cellSize</a>[0](i);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    volumeCoordinates(i) += (<a class="code hl_variable" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>(<a class="code hl_function" href="../../dd/d6c/namespaceexahype2.html#ae62a65e1dd6c633eee9a9b5aba6e14bc">volumeIndex</a>(i))+0.5)*patchData.<a class="code hl_variable" href="../../d4/d3a/structexahype2_1_1CellData.html#ad9f375724052ada25ecd169c9e211628">cellSize</a>[0](i)/QOutEnumerator.<a class="code hl_variable" href="../../dd/da8/structexahype2_1_1enumerator_1_1AoSLexicographicEnumerator.html#a95c113fcf3d2cd8a3c855200b50447fe">_numberOfDoFsPerAxisInCell</a>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  }</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  <span class="comment">/*validateNumericalEqualsWithParams3(0, 1, </span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="comment">    patchData.toString(), </span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">    patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)],</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="comment">    volumeCoordinates</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">  );*/</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>  <span class="comment">//for (checkingQ=0;checkingQ&lt;unknowns;checkingQ++){</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>   <span class="comment">// std::cout&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)]&lt;&lt;&quot;\t&quot;;</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  <span class="comment">//}</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  <span class="comment">//std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  <span class="comment">//std::cout &lt;&lt; &quot;Index: &quot; &lt;&lt; volumeIndex &lt;&lt; &quot; Coordinates: &quot; &lt;&lt; volumeCoordinates &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <span class="comment">//std::cout &lt;&lt; std::fixed &lt;&lt;std::setprecision(6); </span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="comment">/*for (checkingQ=0;checkingQ&lt;23;checkingQ++){</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="comment">    std::cout&lt;&lt;&quot;dtQ[&quot;&lt;&lt;checkingQ&lt;&lt;&quot;]\t=  &quot;&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)]&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="comment">  }</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="comment">  std::cout&lt;&lt;&quot;dtQ[53]\t=  &quot;&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, 53)]&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="comment">  std::cout&lt;&lt;&quot;dtQ[54]\t=  &quot;&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, 54)]&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="comment">  std::cout&lt;&lt;&quot;dtchi=2*Q[54]*dtQ[54]\t=  &quot;</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="comment">    &lt;&lt;2*patchData.QIn[0][QInEnumerator(0, volumeIndex, 54)]*patchData.QOut[0][QOutEnumerator(0, volumeIndex, 54)]</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="comment">    &lt;&lt;std::endl;*/</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="comment">/*for (checkingQ=0;checkingQ&lt;23;checkingQ++){</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment">    std::cout&lt;&lt;&quot;dtQ[&quot;&lt;&lt;checkingQ&lt;&lt;&quot;]\t=  &quot;&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)]</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><span class="comment">      &lt;&lt;&quot;\tGRChombo result = &quot;&lt;&lt;dataArrayOfGRChombo[checkingQ]&lt;&lt;&quot;\t Ratio = &quot;</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="comment">      &lt;&lt;100*patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)]/dataArrayOfGRChombo[checkingQ]</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment">      &lt;&lt;&quot;%&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">  }</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment"></span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">  std::cout&lt;&lt;&quot;dtQ[53]\t=  &quot;&lt;&lt;patchData.QOut[0][QOutEnumerator(0, volumeIndex, 53)]</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="comment">    &lt;&lt;&quot;\tGRChombo result = &quot;&lt;&lt;dataArrayOfGRChombo[23]&lt;&lt;&quot;\t Ratio = &quot;</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">      &lt;&lt;100*patchData.QOut[0][QOutEnumerator(0, volumeIndex, 53)]/dataArrayOfGRChombo[23]</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment">      &lt;&lt;&quot;%&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment"></span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">  double dtphi=patchData.QOut[0][QOutEnumerator(0, volumeIndex, 54)];</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">  std::cout&lt;&lt;&quot;dtchi=2*Q[54]*dtQ[54]\t=  &quot;</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">    &lt;&lt;2*patchData.QIn[0][QInEnumerator(0, volumeIndex, 54)]*dtphi</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">    &lt;&lt;&quot;\tGRChombo result = &quot;&lt;&lt;dataArrayOfGRChombo[24]&lt;&lt;&quot;\t Ratio = &quot;</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment">    &lt;&lt;100*2*patchData.QIn[0][QInEnumerator(0, volumeIndex, 54)]*dtphi/dataArrayOfGRChombo[24]</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">    &lt;&lt;&quot;%&quot;&lt;&lt;std::endl;*/</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <span class="comment">/*for (checkingQ=0;checkingQ&lt;23;checkingQ++){</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">    validateNumericalEqualsWithParams3(0, 1, </span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">      patchData.toString(), </span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">      patchData.QOut[0][QOutEnumerator(0, volumeIndex, checkingQ)],</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="comment">      volumeCoordinates</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="comment">    );</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="comment">  }*/</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>  <span class="keyword">delete</span>[] oldQWithHalos;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  <span class="keyword">delete</span>[] QOut;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span><span class="preprocessor">  #endif</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>}</div>
</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="foldopen" id="foldopen00312" data-start="{" data-end="}">
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno"><a class="line" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ae5ff97c0c9ed7ca6b7698cd0d80543d4">  312</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ae5ff97c0c9ed7ca6b7698cd0d80543d4">exahype2::fd::tests::CCZ4KernelTest::prepareFieldData</a>(</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <span class="keywordtype">double</span>** g, </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <span class="keywordtype">double</span>&amp; phi, </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <span class="keywordtype">double</span>** K, </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <span class="keywordtype">double</span>&amp; trK,</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="keywordtype">double</span>&amp; Theta,</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keywordtype">double</span>* Gamma, </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <span class="keywordtype">double</span>&amp; alpha, </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  <span class="keywordtype">double</span>* <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>,</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="keywordtype">double</span>* b,</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>){</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <span class="keywordtype">double</span> g_UU[3][3];</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  g[0][0] = 1.36778 + 2.39731 * x + 4.53541 * x * x +</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            19.9771 * x * y * y * y + 6.13801 * y * z +</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            5.65185 * z * z + 9.35842 * z * z * z * z;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>  g[0][1] = -0.07646 - 0.48786 * x - 0.75098 * x * x -</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            1.73683 * x * y * y * y + 1.71676 * y * z +  </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>            1.03662 * z * z + 0.35630 * z * z * z * z;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>  g[0][2] = -0.10083 + 0.12445 * x - 1.26649 * x * x -</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            1.95052 * x * y * y * y + 0.73091 * y * z -</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>            1.49835 * z * z - 2.39024 * z * z * z * z;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>  g[1][1] = 0.84072 + 2.31163 * x + 3.32275 * x * x +</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            15.1662 * x * y * y * y + 8.48730 * y * z +</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            3.05098 * z * z + 17.8448 * z * z * z * z;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  g[1][2] = -0.42495 - 0.33464 * x - 0.47012 * x * x -</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>            7.38477 * x * y * y * y + 0.41896 * y * z -</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>            1.36394 * z * z + 5.25894 * z * z * z * z;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  g[2][2] = 0.60995 + 1.30428 * x + 3.86237 * x * x +</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>            22.7614 * x * y * y * y + 6.93818 * y * z +</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>            4.39250 * z * z + 19.0244 * z * z * z * z;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  g[1][0] = g[0][1];</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  g[2][0] = g[0][2];</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  g[2][1] = g[1][2];</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  <span class="keywordtype">double</span> detg = g[0][0] * g[1][1] * g[2][2] +</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                2 * g[0][1] * g[0][2] * g[1][2] -</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>                g[0][0] * g[1][2] * g[1][2] -</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                g[1][1] * g[0][2] * g[0][2] -</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>                g[2][2] * g[0][1] * g[0][1];</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  g_UU[0][0] = (g[1][1] * g[2][2] - g[1][2] * g[1][2]) / detg;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>  g_UU[0][1] = (g[0][2] * g[1][2] - g[0][1] * g[2][2]) / detg;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  g_UU[0][2] = (g[0][1] * g[1][2] - g[0][2] * g[1][1]) / detg;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>  g_UU[1][1] = (g[0][0] * g[2][2] - g[0][2] * g[0][2]) / detg;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  g_UU[1][2] = (g[0][1] * g[0][2] - g[0][0] * g[1][2]) / detg;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  g_UU[2][2] = (g[0][0] * g[1][1] - g[0][1] * g[0][1]) / detg;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>  g_UU[1][0] = g_UU[0][1];</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>  g_UU[2][0] = g_UU[0][2];</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  g_UU[2][1] = g_UU[1][2];</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  phi=std::pow(detg,-1./6.);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  <span class="keywordtype">double</span> phisq=phi*phi;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  trK=0;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  K[0][0] = -0.16238 - 0.74295 * x + 0.51595 * x * x -</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            6.60239 * x * y * y * y - 0.76401 * y * z -</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            1.81131 * z * z - 3.88228 * z * z * z * z;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>  K[0][1] = 0.15054 - 0.60088 * x - 0.15428 * x * x +</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>            3.16779 * x * y * y * y - 2.00687 * y * z -</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            1.35442 * z * z - 0.67601 * z * z * z * z;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>  K[0][2] = -0.02174 - 0.36243 * x + 0.81531 * x * x +</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            4.34918 * x * y * y * y + 0.90419 * y * z -</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            0.85088 * z * z - 6.45097 * z * z * z * z;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  K[1][1] = -0.47653 - 0.43889 * x + 0.87342 * x * x +</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            4.24684 * x * y * y * y + 0.26290 * y * z +</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            1.90095 * z * z + 3.69515 * z * z * z * z;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  K[1][2] = 0.37472 + 0.03657 * x - 0.10327 * x * x -</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>            0.95744 * x * y * y * y - 1.20800 * y * z -</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            0.43064 * z * z - 0.25419 * z * z * z * z;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  K[2][2] = 0.34184 + 0.21495 * x - 0.73195 * x * x +</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            7.81626 * x * y * y * y + 2.48359 * y * z +</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>            1.89657 * z * z - 4.10980 * z * z * z * z;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  K[1][0] = K[0][1];</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  K[2][0] = K[0][2];</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  K[2][1] = K[1][2];</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;3;j++) trK += g_UU[i][j]*K[i][j];</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;i++)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;3;j++) {</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    g[i][j]=phisq*g[i][j]; <span class="comment">//\tilde{\gamma}_ij</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    K[i][j]=phisq*(K[i][j]- 1./3. * trK * g[i][j]/phisq); <span class="comment">//\tilde{A}_ij</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  }</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  Theta = 0.27579 + 0.25791 * x + 1.40488 * x * x +</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>          5.68276 * x * y * y * y +</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>          3.04325 * y * z + 1.81250 * z * z +</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>          1.01832 * z * z * z * z;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  Gamma[0] = -0.49482 + 0.89227 * x + 0.05571 * x * x -</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>             5.38570 * x * y * y * y + 0.13979 * y * z -</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>             0.68588 * z * z - 4.39964 * z * z * z * z;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  Gamma[1] = -0.09082 - 0.31017 * x + 1.06980 * x * x +</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>             7.81524 * x * y * y * y - 1.65016 * y * z -</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>             0.53352 * z * z - 3.20997 * z * z * z * z;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>  Gamma[2] = -0.42367 + 0.03891 * x - 0.87898 * x * x +</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>             6.67657 * x * y * y * y - 3.44662 * y * z -</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>             0.19655 * z * z + 2.97524 * z * z * z * z;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  alpha = 0.73578 + 0.36898 * x + 0.64348 * x * x +</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>          9.33487 * x * y * y * y +</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>          0.99469 * y * z + 0.20515 * z * z +</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>          8.88385 * z * z * z * z;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>  <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[0] = 0.00000 + 0.18795 * x - 0.52389 * x * x -</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            4.14079 * x * y * y * y +</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            0.73135 * y * z - 0.27057 * z * z +</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            3.24187 * z * z * z * z;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[1] = 0.00000 - 0.30316 * x - 0.15184 * x * x -</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            0.48815 * x * y * y * y +</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>            2.45991 * y * z - 0.79248 * z * z +</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            7.14007 * z * z * z * z;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>  <a class="code hl_variable" href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a>[2] = 0.00000 + 0.68835 * x - 0.52219 * x * x -</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>            7.50449 * x * y * y * y -</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            2.35372 * y * z - 0.21476 * z * z +</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>            4.36363 * z * z * z * z;</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span> </div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>  b[0] = -0.26928 + 0.35045 * x - 0.48884 * x * x +</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>         2.72465 * x * y * y * y - 2.59022 * y * z -</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>         0.27384 * z * z + 0.38748 * z * z * z * z;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>  b[1] = 0.40234 + 0.26741 * x + 1.94822 * x * x -</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>         0.78276 * x * y * y * y + 2.12346 * y * z +</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>         0.69086 * z * z - 4.47639 * z * z * z * z;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  b[2] = 0.40313 + 0.00569 * x - 1.12452 * x * x -</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>         5.49255 * x * y * y * y - 2.21932 * y * z +</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>         0.49523 * z * z + 1.29460 * z * z * z * z;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>}</div>
</div>
<div class="ttc" id="aAoSLexicographicEnumerator_8h_html"><div class="ttname"><a href="../../da/dc8/AoSLexicographicEnumerator_8h.html">AoSLexicographicEnumerator.h</a></div></div>
<div class="ttc" id="aAoSoALexicographicEnumerator_8h_html"><div class="ttname"><a href="../../d0/da0/AoSoALexicographicEnumerator_8h.html">AoSoALexicographicEnumerator.h</a></div></div>
<div class="ttc" id="aCCZ4KernelTest_8h_html"><div class="ttname"><a href="../../d7/df2/CCZ4KernelTest_8h.html">CCZ4KernelTest.h</a></div></div>
<div class="ttc" id="aDiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp_html_a962c06c0fea2c76dd28c454654a79417"><div class="ttname"><a href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></div><div class="ttdeci">const double</div><div class="ttdef"><b>Definition</b> <a href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp_source.html#l00008">DiscontinuousGalerkinDiscretisation.Abstract.template.cpp:8</a></div></div>
<div class="ttc" id="aFD4_8h_html"><div class="ttname"><a href="../../d1/de4/FD4_8h.html">FD4.h</a></div></div>
<div class="ttc" id="aGlobals_8h_html"><div class="ttname"><a href="../../d9/df1/Globals_8h.html">Globals.h</a></div></div>
<div class="ttc" id="aLog_8h_html"><div class="ttname"><a href="../../d1/d45/Log_8h.html">Log.h</a></div></div>
<div class="ttc" id="aLoop_8h_html"><div class="ttname"><a href="../../db/d9e/Loop_8h.html">Loop.h</a></div></div>
<div class="ttc" id="aSoALexicographicEnumerator_8h_html"><div class="ttname"><a href="../../df/dbd/SoALexicographicEnumerator_8h.html">SoALexicographicEnumerator.h</a></div></div>
<div class="ttc" id="aTestMacros_8h_html_a321d2883e56477558db3f31126b28b86"><div class="ttname"><a href="../../dc/d61/TestMacros_8h.html#a321d2883e56477558db3f31126b28b86">testMethod</a></div><div class="ttdeci">#define testMethod(name)</div><div class="ttdoc">Run a test method and check for errors.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d61/TestMacros_8h_source.html#l00024">TestMacros.h:24</a></div></div>
<div class="ttc" id="aVector_8h_html"><div class="ttname"><a href="../../d6/dbe/Vector_8h.html">Vector.h</a></div></div>
<div class="ttc" id="aaderdg-fused_2KernelBenchmarks-main_8cpp_html_a0445981e6d724051043ca58b254f4f98"><div class="ttname"><a href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp.html#a0445981e6d724051043ca58b254f4f98">cellSize</a></div><div class="ttdeci">const tarch::la::Vector&lt; Dimensions, double &gt; cellSize</div><div class="ttdef"><b>Definition</b> <a href="../../df/dc4/aderdg-fused_2KernelBenchmarks-main_8cpp_source.html#l00052">KernelBenchmarks-main.cpp:52</a></div></div>
<div class="ttc" id="aclassexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest_html_a1a0231259e373cd60ab1c4fbe997d99b"><div class="ttname"><a href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a1a0231259e373cd60ab1c4fbe997d99b">exahype2::fd::tests::CCZ4KernelTest::run</a></div><div class="ttdeci">virtual void run()</div><div class="ttdoc">This routine is triggered by the TestCaseCollection.</div><div class="ttdef"><b>Definition</b> <a href="#l00030">CCZ4KernelTest.cpp:30</a></div></div>
<div class="ttc" id="aclassexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest_html_a85ba2937d40e26129d1091d985bf3807"><div class="ttname"><a href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#a85ba2937d40e26129d1091d985bf3807">exahype2::fd::tests::CCZ4KernelTest::CCZ4KernelTest</a></div><div class="ttdeci">CCZ4KernelTest()</div><div class="ttdef"><b>Definition</b> <a href="#l00025">CCZ4KernelTest.cpp:25</a></div></div>
<div class="ttc" id="aclassexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest_html_ab2b7f6c7f1896f153c037789f32b90f6"><div class="ttname"><a href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ab2b7f6c7f1896f153c037789f32b90f6">exahype2::fd::tests::CCZ4KernelTest::AppleWithAppleTest</a></div><div class="ttdeci">void AppleWithAppleTest()</div><div class="ttdef"><b>Definition</b> <a href="#l00035">CCZ4KernelTest.cpp:35</a></div></div>
<div class="ttc" id="aclassexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest_html_ae5ff97c0c9ed7ca6b7698cd0d80543d4"><div class="ttname"><a href="../../df/de4/classexahype2_1_1fd_1_1tests_1_1CCZ4KernelTest.html#ae5ff97c0c9ed7ca6b7698cd0d80543d4">exahype2::fd::tests::CCZ4KernelTest::prepareFieldData</a></div><div class="ttdeci">void prepareFieldData(double **g, double &amp;phi, double **K, double &amp;trK, double &amp;Theta, double *Gamma, double &amp;alpha, double *beta, double *b, double x, double y, double z)</div><div class="ttdef"><b>Definition</b> <a href="#l00312">CCZ4KernelTest.cpp:312</a></div></div>
<div class="ttc" id="afd_2PatchUtils_8h_html"><div class="ttname"><a href="../../df/dc2/fd_2PatchUtils_8h.html">PatchUtils.h</a></div></div>
<div class="ttc" id="amath_8h_html"><div class="ttname"><a href="../../df/db1/math_8h.html">math.h</a></div></div>
<div class="ttc" id="anamespaceapplications_1_1exahype2_1_1ccz4_html_a347d1eb86d746d4dae4e64b1c694ff9d"><div class="ttname"><a href="../../db/dbd/namespaceapplications_1_1exahype2_1_1ccz4.html#a347d1eb86d746d4dae4e64b1c694ff9d">applications::exahype2::ccz4::source</a></div><div class="ttdeci">static void source(double *S, const double *const Q, const int CCZ4LapseType, const double CCZ4ds, const double CCZ4c, const double CCZ4e, const double CCZ4f, const double CCZ4bs, const double CCZ4sk, const double CCZ4xi, const double CCZ4itau, const double CCZ4eta, const double CCZ4k1, const double CCZ4k2, const double CCZ4k3, const double CCZ4SO) InlineMethod</div><div class="ttdoc">The source term is one out of two terms that we use in our CCZ4 formulation.</div></div>
<div class="ttc" id="anamespaceapplications_1_1exahype2_1_1ccz4_html_ab016a412646b8e0aa705dec0145dbb99"><div class="ttname"><a href="../../db/dbd/namespaceapplications_1_1exahype2_1_1ccz4.html#ab016a412646b8e0aa705dec0145dbb99">applications::exahype2::ccz4::ncp</a></div><div class="ttdeci">static void ncp(double *BgradQ, const double *const Q, const double *const gradQSerialised, const int normal, const int CCZ4LapseType, const double CCZ4ds, const double CCZ4c, const double CCZ4e, const double CCZ4f, const double CCZ4bs, const double CCZ4sk, const double CCZ4xi, const double CCZ4mu, const double CCZ4SO) InlineMethod</div></div>
<div class="ttc" id="anamespaceexahype2_1_1fd_1_1fd4_html_aa4d2f77c5b859acaaaed8eb4469cc4b2aad5364497f0c5e4925a250fad24f09c5"><div class="ttname"><a href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#aa4d2f77c5b859acaaaed8eb4469cc4b2aad5364497f0c5e4925a250fad24f09c5">exahype2::fd::fd4::DifferentialSourceTermVariant::CentralDifferencesWithLopsidedAdvection</a></div><div class="ttdeci">@ CentralDifferencesWithLopsidedAdvection</div></div>
<div class="ttc" id="anamespaceexahype2_1_1fd_1_1fd4_html_abfef00e76cf5aaf5e781052a65ebdbb7"><div class="ttname"><a href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#abfef00e76cf5aaf5e781052a65ebdbb7">exahype2::fd::fd4::reconstruct_first_derivatives</a></div><div class="ttdeci">void reconstruct_first_derivatives(::exahype2::CellData&lt; double, double &gt; &amp;patchData, int numberOfGridCellsPerPatchPerAxis, int haloSize, int unknowns, int auxiliaryVariables)</div><div class="ttdoc">Helper routine to reconstruct the first derivatives.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db8/FD4__patchwise__functors_8cpp_source.html#l00629">FD4_patchwise_functors.cpp:629</a></div></div>
<div class="ttc" id="anamespaceexahype2_1_1fd_1_1fd4_html_ad4c3323ae9e4f3a07afd4d8f4b3476af"><div class="ttname"><a href="../../db/d32/namespaceexahype2_1_1fd_1_1fd4.html#ad4c3323ae9e4f3a07afd4d8f4b3476af">exahype2::fd::fd4::timeStep_patchwise_heap_functors</a></div><div class="ttdeci">void timeStep_patchwise_heap_functors(::exahype2::CellData&lt; double, double &gt; &amp;patchData, int numberOfGridCellsPerPatchPerAxis, int haloSize, int unknowns, int auxiliaryVariables, double KOSigma, bool evaluateFlux, bool evaluateDifferentialSource, bool evaluateAlgebraicSource, bool copyOldTimeStepAndScaleWithTimeStepSize, DifferentialSourceTermVariant variant, Flux flux, NonconservativeProduct DifferentialSource, Source AlgebraicSource)</div><div class="ttdoc">Fourth-order Finite Differences.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/db8/FD4__patchwise__functors_8cpp_source.html#l00009">FD4_patchwise_functors.cpp:9</a></div></div>
<div class="ttc" id="anamespaceexahype2_html_ae62a65e1dd6c633eee9a9b5aba6e14bc"><div class="ttname"><a href="../../dd/d6c/namespaceexahype2.html#ae62a65e1dd6c633eee9a9b5aba6e14bc">exahype2::volumeIndex</a></div><div class="ttdeci">static GPUCallableMethod auto volumeIndex(Args... args) InlineMethod</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dcf/VolumeIndex_8h_source.html#l00078">VolumeIndex.h:78</a></div></div>
<div class="ttc" id="anamespacepeano4_1_1utils_html_a4f1a4f16c96662b344839f6beb4cd095"><div class="ttname"><a href="../../d9/d8e/namespacepeano4_1_1utils.html#a4f1a4f16c96662b344839f6beb4cd095">peano4::utils::dLinearised</a></div><div class="ttdeci">GPUCallableMethod int dLinearised(const std::bitset&lt; Dimensions &gt; &amp;counter)</div><div class="ttdoc">Map d-dimensional vector onto integer index.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc2/Linearised_8cpph_source.html#l00034">Linearised.cpph:34</a></div></div>
<div class="ttc" id="asignal__velocity_8h_html_a41e3d113c39f81fd2f130c9b217e0e90"><div class="ttname"><a href="../../db/d34/signal__velocity_8h.html#a41e3d113c39f81fd2f130c9b217e0e90">beta</a></div><div class="ttdeci">const struct part *restrict const struct part *restrict const float const float beta</div><div class="ttdef"><b>Definition</b> <a href="../../db/d34/signal__velocity_8h_source.html#l00045">signal_velocity.h:45</a></div></div>
<div class="ttc" id="astructexahype2_1_1CellData_html"><div class="ttname"><a href="../../d4/d3a/structexahype2_1_1CellData.html">exahype2::CellData</a></div><div class="ttdoc">Representation of a number of cells which contains all information that's required to process the sto...</div><div class="ttdef"><b>Definition</b> <a href="../../da/dff/CellData_8h_source.html#l00025">CellData.h:25</a></div></div>
<div class="ttc" id="astructexahype2_1_1CellData_html_a1f39ab8a44a2e323de57050463e52c43"><div class="ttname"><a href="../../d4/d3a/structexahype2_1_1CellData.html#a1f39ab8a44a2e323de57050463e52c43">exahype2::CellData::cellCentre</a></div><div class="ttdeci">tarch::la::Vector&lt; Dimensions, double &gt; * cellCentre</div><div class="ttdef"><b>Definition</b> <a href="../../da/dff/CellData_8h_source.html#l00032">CellData.h:32</a></div></div>
<div class="ttc" id="astructexahype2_1_1CellData_html_ad9f375724052ada25ecd169c9e211628"><div class="ttname"><a href="../../d4/d3a/structexahype2_1_1CellData.html#ad9f375724052ada25ecd169c9e211628">exahype2::CellData::cellSize</a></div><div class="ttdeci">tarch::la::Vector&lt; Dimensions, double &gt; * cellSize</div><div class="ttdef"><b>Definition</b> <a href="../../da/dff/CellData_8h_source.html#l00033">CellData.h:33</a></div></div>
<div class="ttc" id="astructexahype2_1_1enumerator_1_1AoSLexicographicEnumerator_html"><div class="ttname"><a href="../../dd/da8/structexahype2_1_1enumerator_1_1AoSLexicographicEnumerator.html">exahype2::enumerator::AoSLexicographicEnumerator</a></div><div class="ttdoc">Array of struct enumerator.</div><div class="ttdef"><b>Definition</b> <a href="../../da/dc8/AoSLexicographicEnumerator_8h_source.html#l00037">AoSLexicographicEnumerator.h:37</a></div></div>
<div class="ttc" id="astructexahype2_1_1enumerator_1_1AoSLexicographicEnumerator_html_a95c113fcf3d2cd8a3c855200b50447fe"><div class="ttname"><a href="../../dd/da8/structexahype2_1_1enumerator_1_1AoSLexicographicEnumerator.html#a95c113fcf3d2cd8a3c855200b50447fe">exahype2::enumerator::AoSLexicographicEnumerator::_numberOfDoFsPerAxisInCell</a></div><div class="ttdeci">const int _numberOfDoFsPerAxisInCell</div><div class="ttdef"><b>Definition</b> <a href="../../da/dc8/AoSLexicographicEnumerator_8h_source.html#l00101">AoSLexicographicEnumerator.h:101</a></div></div>
<div class="ttc" id="astructtarch_1_1la_1_1Vector_html"><div class="ttname"><a href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a></div><div class="ttdoc">Simple vector class.</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbe/Vector_8h_source.html#l00084">Vector.h:84</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_ec46d2656e0724bb5df21a6a186ad064.html">exahype2</a></li><li class="navelem"><a class="el" href="../../dir_a537829b77564306f878f6ec1c81bccd.html">fd</a></li><li class="navelem"><a class="el" href="../../dir_1227f9bc5daae600854021aef9a4a260.html">tests</a></li><li class="navelem"><a class="el" href="../../dd/dd3/CCZ4KernelTest_8cpp.html">CCZ4KernelTest.cpp</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:24:11 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
