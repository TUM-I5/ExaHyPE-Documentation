<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d2/d00/classtarch_1_1services_1_1Service.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle"><div class="title">tarch::services::Service Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="../../d2/d00/classtarch_1_1services_1_1Service.html" title="Service Interface.">Service</a> Interface.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for tarch::services::Service:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/d30/classtarch_1_1services_1_1Service__inherit__graph.png" border="0" usemap="#atarch_1_1services_1_1Service_inherit__map" alt="Inheritance graph"/></div>
<map name="atarch_1_1services_1_1Service_inherit__map" id="atarch_1_1services_1_1Service_inherit__map">
<area shape="rect" title="Service Interface." alt="" coords="5,99,179,125"/>
<area shape="rect" href="../../d4/df3/classexahype2_1_1RefinementControlService.html" title=" " alt="" coords="230,5,446,45"/>
<area shape="poly" title=" " alt="" coords="134,91,226,55,263,43,264,48,228,60,136,96"/>
<area shape="rect" href="../../da/d58/classpeano4_1_1parallel_1_1SpacetreeSet.html" title="The spacetree set has to be a singleton, as it is reponsible to accept requests for new trees from re..." alt="" coords="227,70,449,95"/>
<area shape="poly" title=" " alt="" coords="192,97,231,93,232,98,192,103"/>
<area shape="rect" href="../../d1/d1a/classtarch_1_1mpi_1_1BooleanSemaphore_1_1BooleanSemaphoreService.html" title=" " alt="" coords="227,120,449,160"/>
<area shape="poly" title=" " alt="" coords="193,121,227,125,226,130,192,126"/>
<area shape="rect" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html" title="Service Repository." alt="" coords="251,184,425,224"/>
<area shape="poly" title=" " alt="" coords="132,128,228,170,263,181,261,186,226,174,130,133"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for tarch::services::Service:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/dab/classtarch_1_1services_1_1Service__coll__graph.png" border="0" usemap="#atarch_1_1services_1_1Service_coll__map" alt="Collaboration graph"/></div>
<map name="atarch_1_1services_1_1Service_coll__map" id="atarch_1_1services_1_1Service_coll__map">
<area shape="rect" title="Service Interface." alt="" coords="17,211,191,236"/>
<area shape="rect" href="../../d7/d99/classtarch_1_1multicore_1_1RecursiveSemaphore.html" title="Recursive Semaphore." alt="" coords="5,93,203,133"/>
<area shape="poly" title=" " alt="" coords="107,147,107,210,101,210,101,147"/>
<area shape="rect" title=" " alt="" coords="25,5,183,31"/>
<area shape="poly" title=" " alt="" coords="107,44,107,93,101,93,101,44"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad5d43d40e8c9cd5d80ad66a4d19f4e3d" id="r_ad5d43d40e8c9cd5d80ad66a4d19f4e3d"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5d43d40e8c9cd5d80ad66a4d19f4e3d">~Service</a> ()</td></tr>
<tr class="separator:ad5d43d40e8c9cd5d80ad66a4d19f4e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a87127274196bdaffb4bad9e80a89f4" id="r_a6a87127274196bdaffb4bad9e80a89f4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a87127274196bdaffb4bad9e80a89f4">receiveDanglingMessages</a> ()=0</td></tr>
<tr class="memdesc:a6a87127274196bdaffb4bad9e80a89f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive the dangling messages from the MPI subsystem.  <br /></td></tr>
<tr class="separator:a6a87127274196bdaffb4bad9e80a89f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aebe2a268fd6233ccb6cc808ac51b0dcb" id="r_aebe2a268fd6233ccb6cc808ac51b0dcb"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebe2a268fd6233ccb6cc808ac51b0dcb">shutdown</a> ()=0</td></tr>
<tr class="separator:aebe2a268fd6233ccb6cc808ac51b0dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a5851dadd19960ab869f27ea8eb4aa8a3" id="r_a5851dadd19960ab869f27ea8eb4aa8a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d99/classtarch_1_1multicore_1_1RecursiveSemaphore.html">tarch::multicore::RecursiveSemaphore</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5851dadd19960ab869f27ea8eb4aa8a3">_receiveDanglingMessagesSemaphore</a></td></tr>
<tr class="memdesc:a5851dadd19960ab869f27ea8eb4aa8a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursive semaphores.  <br /></td></tr>
<tr class="separator:a5851dadd19960ab869f27ea8eb4aa8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a4e772eb6e913c1169976ea77b11247ba" id="r_a4e772eb6e913c1169976ea77b11247ba"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e772eb6e913c1169976ea77b11247ba">ServiceRepository</a></td></tr>
<tr class="separator:a4e772eb6e913c1169976ea77b11247ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="../../d2/d00/classtarch_1_1services_1_1Service.html" title="Service Interface.">Service</a> Interface. </p>
<p>A service is a singleton running the background which is available always. If it is shut down, all calls to the service becomes nop, i.e. it is a robust thing. On a parallel machine, services are also do exist only once, i.e. they are global singletons. Therefore, you shall never access a service directly, but always via a proxy/accessor. This proxy either invokes the service directly (if the services are on the local node) or it creates an MPI call to the real service. Consequently, services have to poll the MPI queue regularly. To enable them to do so, all services register at the service repository, and this service repository has a poll operation. Services also have to be protected by semaphores in a multicore environment.</p>
<p>If you wanna write a service yourself, you have to do two things:</p><ul>
<li>Implement this interface.</li>
<li>Register your object through <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#a6a3a85cf6082b5f2711cf046176cd42c">tarch::services::ServiceRepository::getInstance()</a>.addService().</li>
</ul>
<p>I usually make services singletons. I can then do the registration in the constructor.</p>
<h2>How to implement a singleton </h2>
<p>Historically, I preferred the make singletons classes with private constructor that offer a getInstance() routine. The latter is implemented as follows:</p>
<pre>
MyClass MyClass::getInstance() {
  static MyClass singleton;
  return singleton;
}
   </pre><p>But this pattern breaks down with Peano's static libraries. At least one some systems, I've observed that singletons still are created multiple times, i.e. not only when we first call getInstance(). The canonical solution to this dilemma is to make the singleton a static (class) attribute which is private and to make getInstance() hand out this static attribute.</p>
<p>While this solves the problem of multiple instantiation, it does not solve another problem: If the constructor of a singleton registers the singleton, it could happen that the linker creates the singletons in the wrong order. There's no way to ensure that the tarch's service is created first. So what can happen is that the memory for the <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html" title="Service Repository.">ServiceRepository</a> (where all the services register) is allocated. Then, an arbitrary service is created and registers, i.e. it adds is pointer to the repository. Later, the repository's constructor is invoked and effectively overwrites the registered service. It is hence important that we create the repository first. The only way to ensure this, is to init all services manually.</p>
<p>So here's the takeaway:</p>
<p>(1) Singletons are always realised via a private constructor. (2) Singletons are always realised via a class attribute. (3) Singletons don't do anything in their constructor. They are not allowed to. (4) <a class="el" href="../../db/d37/structAny.html">Any</a> singleton has an init() operation, as well as a shutdown (if required).</p>
<p>To enforce this behaviour with init() and <a class="el" href="#aebe2a268fd6233ccb6cc808ac51b0dcb">shutdown()</a>, I make shutdown an abstract functions. You therefore have to implement it. I refrained from doing the same with init(), as services might want init() to have service-specific arguments.</p>
<dl class="section author"><dt>Author</dt><dd>Tobias Weinzierl </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/de7/Service_8h_source.html#l00087">87</a> of file <a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad5d43d40e8c9cd5d80ad66a4d19f4e3d" name="ad5d43d40e8c9cd5d80ad66a4d19f4e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d43d40e8c9cd5d80ad66a4d19f4e3d">&#9670;&#160;</a></span>~Service()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual tarch::services::Service::~Service </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/de7/Service_8h_source.html#l00091">91</a> of file <a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6a87127274196bdaffb4bad9e80a89f4" name="a6a87127274196bdaffb4bad9e80a89f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a87127274196bdaffb4bad9e80a89f4">&#9670;&#160;</a></span>receiveDanglingMessages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> tarch::services::Service::receiveDanglingMessages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive the dangling messages from the MPI subsystem. </p>
<p>This, sometimes, is an absolutely necessary operation to ensure that some MPI queues are freed again and MPI can continue to process. If you have too full buffers - in particular full of unexpected messages - you run into a situation where no eager or unexpected receiving can be done at all.</p>
<p>If you invoke this routine, it is absolutely essential that you always do it via the services. The reasons are discussed in <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#a4218d43659ffc951ee3b1c6eab7532bc" title="Answer to MPI Messages.">ServiceRepository::receiveDanglingMessages()</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#a4218d43659ffc951ee3b1c6eab7532bc" title="Answer to MPI Messages.">ServiceRepository::receiveDanglingMessages()</a> </dd></dl>

<p>Implemented in <a class="el" href="../../d4/df3/classexahype2_1_1RefinementControlService.html#a0fc90aa23944364a78dcd153e297a681">exahype2::RefinementControlService</a>, <a class="el" href="../../da/d58/classpeano4_1_1parallel_1_1SpacetreeSet.html#a804983160d3a6236ada166574dee659a">peano4::parallel::SpacetreeSet</a>, <a class="el" href="../../d1/d1a/classtarch_1_1mpi_1_1BooleanSemaphore_1_1BooleanSemaphoreService.html#a34493a69cae791ea0657cb8c3fd19e25">tarch::mpi::BooleanSemaphore::BooleanSemaphoreService</a>, and <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#a4218d43659ffc951ee3b1c6eab7532bc">tarch::services::ServiceRepository</a>.</p>

</div>
</div>
<a id="aebe2a268fd6233ccb6cc808ac51b0dcb" name="aebe2a268fd6233ccb6cc808ac51b0dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebe2a268fd6233ccb6cc808ac51b0dcb">&#9670;&#160;</a></span>shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> tarch::services::Service::shutdown </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="../../d4/df3/classexahype2_1_1RefinementControlService.html#ae9a49bd7f14b6842541bd34dfc2265d6">exahype2::RefinementControlService</a>, <a class="el" href="../../da/d58/classpeano4_1_1parallel_1_1SpacetreeSet.html#ac7383614be7ae6babc6441894be5e1aa">peano4::parallel::SpacetreeSet</a>, <a class="el" href="../../d1/d1a/classtarch_1_1mpi_1_1BooleanSemaphore_1_1BooleanSemaphoreService.html#ae28e35e6d6d869b04c6d2f7442246607">tarch::mpi::BooleanSemaphore::BooleanSemaphoreService</a>, and <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#ad75d325e7fa71452f3822113fb9dc9a4">tarch::services::ServiceRepository</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Symbol Documentation</h2>
<a id="a4e772eb6e913c1169976ea77b11247ba" name="a4e772eb6e913c1169976ea77b11247ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e772eb6e913c1169976ea77b11247ba">&#9670;&#160;</a></span>ServiceRepository</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html">ServiceRepository</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/de7/Service_8h_source.html#l00089">89</a> of file <a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a5851dadd19960ab869f27ea8eb4aa8a3" name="a5851dadd19960ab869f27ea8eb4aa8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5851dadd19960ab869f27ea8eb4aa8a3">&#9670;&#160;</a></span>_receiveDanglingMessagesSemaphore</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d99/classtarch_1_1multicore_1_1RecursiveSemaphore.html">tarch::multicore::RecursiveSemaphore</a> tarch::services::Service::_receiveDanglingMessagesSemaphore</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recursive semaphores. </p>
<p>We have ensure that receiveDanglingMessages is not ran in parallel with other operations on one rank. This holds for example for MPI updates or updates of lists of MPIRequests. Yet, there can be cases where <a class="el" href="#a6a87127274196bdaffb4bad9e80a89f4" title="Receive the dangling messages from the MPI subsystem.">receiveDanglingMessages()</a> in turn invokes <a class="el" href="#a6a87127274196bdaffb4bad9e80a89f4" title="Receive the dangling messages from the MPI subsystem.">receiveDanglingMessages()</a> recursively. With a standard semaphore, we would now run into a deadlock as default semaphores are not recursion-safe. Therefore, I provide this recursive semaphore. The <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html" title="Service Repository.">ServiceRepository</a> does already lock it, so <a class="el" href="#a6a87127274196bdaffb4bad9e80a89f4" title="Receive the dangling messages from the MPI subsystem.">receiveDanglingMessages()</a> invoked through the factory should be fine. You might however want to lock it yourself, too.</p>
<p>I had severe issues when I outsourced the tarch into a library. The static initialisation of the recursive semaphores then led to seg faults from time to time. Therefore, I decided to make this semaphore a pointer. It is initialised lazily <a class="el" href="../../d6/d75/classtarch_1_1services_1_1ServiceRepository.html#a4218d43659ffc951ee3b1c6eab7532bc" title="Answer to MPI Messages.">tarch::services::ServiceRepository::receiveDanglingMessages()</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/de7/Service_8h_source.html#l00128">128</a> of file <a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/tarch/services/<a class="el" href="../../d8/de7/Service_8h_source.html">Service.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/d6a/namespacetarch.html">tarch</a></li><li class="navelem"><a class="el" href="../../db/d68/namespacetarch_1_1services.html">services</a></li><li class="navelem"><a class="el" href="../../d2/d00/classtarch_1_1services_1_1Service.html">Service</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:30:59 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
