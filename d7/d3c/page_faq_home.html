<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d7/d3c/page_faq_home.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">FAQs and Troubleshooting (User Perspective)</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md928">Autotools</a></li>
<li class="level1"><a href="#autotoc_md929">CMake</a></li>
<li class="level1"><a href="#autotoc_md930">Compilation</a></li>
<li class="level1"><a href="#autotoc_md931">Linking</a></li>
<li class="level1"><a href="#autotoc_md932">Runtime</a></li>
<li class="level1"><a href="#autotoc_md933">Python API</a></li>
<li class="level1"><a href="#autotoc_md934">Performance analysis</a></li>
<li class="level1"><a href="#autotoc_md935">External tools</a></li>
<li class="level1"><a href="#autotoc_md936">Debugging</a></li>
<li class="level1"><a href="#autotoc_md937">MPI troubleshooting</a><ul><li class="level2"><a href="#autotoc_md938">C++ core</a></li>
<li class="level2"><a href="#autotoc_md939">Parallelisation</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Some frequently asked questions and problems are discussed below.</p>
<h1><a class="anchor" id="autotoc_md928"></a>
Autotools</h1>
<ul>
<li><em><b>configure fails with ...</b></em> Before you start any further investigation, update to the latest version of the autotools, ensure your configure script suits this version, and rerun the build system configuration: <div class="fragment"><div class="line">autoreconf --install</div>
<div class="line">libtoolize; aclocal; autoconf; autoheader; cp src/config.h.in .; automake --add-missing</div>
</div><!-- fragment --></li>
<li><em><b>checking host system type... Invalid configuration &lsquo;./configure&rsquo;: machine &lsquo;./configure-unknown&rsquo; not recognized</b></em> We got this recently on a number of new Linux installations. In this case, adding <div class="fragment"><div class="line">--build=x86_64 --host=x86_64</div>
</div><!-- fragment --> to your configure call seems to be necessary.</li>
</ul>
<h1><a class="anchor" id="autotoc_md929"></a>
CMake</h1>
<ul>
<li><em><b>Why am I seeing "Permission Denied" errors when using CCACHE in a Docker container on MacOS?</b></em></li>
</ul>
<p>This error is common when using CCACHE in Docker containers on macOS due to how Docker handles file permissions in mounted volumes. CCACHE requires write access to its cache directory, but MacOS and Docker can have mismatched UID/GID (user and group IDs), especially when the cache directory is a mounted volume. This mismatch can prevent CCACHE from writing to the directory, causing "Permission Denied" errors.</p>
<p>This can be easily resolve by setting</p>
<div class="fragment"><div class="line">-DUSE_CCACHE=OFF</div>
</div><!-- fragment --><p>in the CMake configuration.</p>
<ul>
<li><em><b>How can I switch between the different build systems?</b></em></li>
</ul>
<p>The code generator always favours autotools. I.e. if an autotools build is present, the code generator chooses to use autotools. The environment variable <code>PEANO_CMAKE_BUILD_DIR</code> can be set to point to a CMake build folder. Then, the code generator will favour CMake instead of autotools. If there are multiple CMake build folders present (e.g. a GPU build and a non-GPU build), simply setting the flag <code>PEANO_CMAKE_BUILD_DIR</code> to one particular build folder tells the code generator which one to use. Unsetting the environment variable allows to switch back to autotools. If only one of the build systems has been configured, the code generator will choose the one present.</p>
<h1><a class="anchor" id="autotoc_md930"></a>
Compilation</h1>
<ul>
<li><em><b>The translation fails with the error</b></em> <div class="fragment"><div class="line"><span class="stringliteral">&#39;#pragma float_control(precise, off)&#39;</span> is illegal when except is enabled</div>
</div><!-- fragment --> We have seen this error with some LLVM-based compilers. Please re-translate with <code>-fno-exceptions</code>. Unfortunately, this disables some error checking in the checkpoint and file output routines. If that does not help, you might want to reduce the optimisation level. On Intel, switching from -fast to -O3 does work in some cases.</li>
<li><em><b>My compiler yields warnings of the type</b></em> <div class="fragment"><div class="line">./<a class="code hl_namespace" href="../../d8/d8f/namespacepeano4.html">peano4</a>/grid/GridTraversalEvent.h:161:7: warning: unknown attribute <span class="stringliteral">&#39;compress&#39;</span> ignored [-Wunknown-attributes]</div>
<div class="line"> [[clang::pack]]  std::bitset&lt;TwoPowerD&gt;   _hasBeenRefined;</div>
<div class="ttc" id="anamespacepeano4_html"><div class="ttname"><a href="../../d8/d8f/namespacepeano4.html">peano4</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d17/CellMarker_8h_source.html#l00014">CellMarker.h:14</a></div></div>
</div><!-- fragment --> Please consult your compiler options. Usually re-configuring with the flag <div class="fragment"><div class="line">-Wno-unknown-attributes</div>
</div><!-- fragment --> eliminates the warnings.</li>
<li><p class="startli"><em><b>My C++ version is too old</b></em> Try to rerun configure with </p><div class="fragment"><div class="line">CXXFLAGS=-<a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>=c++20</div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace.</div></div>
</div><!-- fragment --><p> Depending on your compiler, the flag might also be </p><div class="fragment"><div class="line">CXXFLAGS=--<a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>=c++20</div>
</div><!-- fragment --><p> Some compilers want you to use two hyphens, others expect one. Please note that most Clang-based compiler installations do not bring their own C++ standard library to the table. They use the pre-existing GCC STL. Now, if your Clang-based compiler - that includes NVIDIA and Intel - is built against a version of GNU whose STL is too old, you will get errors despite the std flag. In this case, you have to load a newer GCC module <em>after</em> you have loaded your Intel, NVIDIA or Clang module. You basically load the Clang-based compiler which will introduce a GNU STL, i.e. set the corresponding environment variables. After that, you manually load a newer GCC which redirects all of these variables.</p>
<p class="startli">If there are multiple <code>gcc</code> versions present, it is possible for CLANG to automatically select an outdated version thus creates problem when compiling. You can check what is the selection version with <code>clang++ -v</code>. Use this to select the other listed options: <code>--gcc-install-dir=/path/to/new/gcc</code>.</p>
</li>
<li><em><b>My compiler reports</b></em> <div class="fragment"><div class="line"><a class="code hl_namespace" href="../../da/d6a/namespacetarch.html">tarch</a>/multicore/multicore.cpp:13:19: error: `align_val_t` is not <a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a> member of `<a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>`</div>
<div class="line">  13 |  <span class="keywordflow">return</span> <span class="keyword">new</span> (std::align_val_t(Alignment)) <span class="keywordtype">double</span>[size];</div>
<div class="ttc" id="ahydro__iact_8h_html_a8cbb00f59bca2c48d4560b23f07a4de2"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a></div><div class="ttdeci">const float const float const float struct part *restrict struct part *restrict const float a</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00055">hydro_iact.h:55</a></div></div>
<div class="ttc" id="anamespacetarch_html"><div class="ttname"><a href="../../da/d6a/namespacetarch.html">tarch</a></div><div class="ttdoc">tarch denotes the Technical Architectures.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d46/accelerator_8h_source.html#l00018">accelerator.h:18</a></div></div>
</div><!-- fragment --> We have seen this error with GCC if the supported C++ generation is too old. See remarks above.</li>
<li><em><b>My compiler yields errors like</b></em> <div class="fragment"><div class="line">`warning \#3191: scoped enumeration types are <a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a> C++11 feature`</div>
</div><!-- fragment --> Your compiler seems not to have C++11 (or, newer) enabled by default. See remarks above.</li>
<li><em><b>My compiler fails with</b></em> <div class="fragment"><div class="line"><span class="stringliteral">&quot;tarch/plotter/griddata/unstructured/vtk/VTKBinaryFileWriter.cpp&quot;</span>, line 42: error: name followed by <span class="stringliteral">&quot;::&quot;</span> must be <a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a> <span class="keyword">class </span>or namespace name</div>
<div class="line">        if (not <a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>::filesystem::exists(indexFileName + &quot;.pvd&quot;))</div>
</div><!-- fragment --> We have seen this error with GCC if the supported C++ generation is too old. See remarks above.</li>
<li><em><b>My compiler terminates with</b></em> <div class="fragment"><div class="line">`error: unknown attribute <span class="stringliteral">&#39;optimize&#39;</span> ignored*`</div>
</div><!-- fragment --> We have seen this issue notably on macOS with CLANG replacing GCC. Unfortunately, CLANG seems to pretend to be GNU on some systems and then the wrong header is included. Consult the remarks on compiler-specific settings. Ensure that the flag <code>CompilerCLANG</code> is enabled and used.</li>
<li><em><b>My compiler terminates with errors when I enable OpenMP multithreading</b></em> Make sure that you are using a compiler with OpenMP 5.0 support, such as GCC 9.x.</li>
<li><em><b>I configured Peano with HDF5, but my application (experiment or benchmark) will not compile</b></em> The application will parse the configure call used by Peano to feed its Makefile. To get the correct flags for HDF5 support for your experiment, you might want to add the following or similar flags to your Peano configuration call: <div class="fragment"><div class="line">LDFLAGS=<span class="stringliteral">&quot;-lhdf5_hl_cpp -lhdf5_cpp -lhdf5_hl -lhdf5 -lstdc++&quot;</span></div>
</div><!-- fragment --> This list is not comprehense and might differ on each system. The safest way to find these flags is to run the HDF5 compiler with verbose. It is actually only a wrapper around your real compiler which sets some variables, i.e. the verbose mode should give you the flags that are set, and then you can add these flags manually to your configure call. The Peano 4 applications then will pick up these flags automatically the next time you invoke the Python scripts.</li>
<li><em><b>configure fails for the NVIDIA compiler</b></em> For NVIDIA, we have to make CXX and CC point to the C++ compiler, as both are passed the same arguments by configure, which are actually only understood by the C++ version. So please ensure that both flags delegate to nvc++. <div class="fragment"><div class="line"><span class="keyword">export</span> NVCPP=/opt/nvidia/hpc_sdk/Linux_x86_64/2022/compilers/bin/nvc++</div>
<div class="line">./configure CXX=$NVCPP CC=$NVCPP ...</div>
</div><!-- fragment --> Furthermore, some compute kernels are not available with the NVIDIA tools, as the compiler is pretty picky when it decides which temporary variables it might place on the call stack. This should not affect Peano 4's core, but it can affect some extensions such as ExaHyPE.</li>
<li><p class="startli">***My compiler stops with ***</p>
<div class="fragment"><div class="line">/apps/developers/compilers/gcc/13.2/1/<span class="keywordflow">default</span>/lib/gcc/x86_64-pc-linux-gnu/13.2.0/../../../../include/c++/13.2.0/chrono:2320:48: error: call to <span class="keyword">consteval</span> function <span class="stringliteral">&#39;std::chrono::hh_mm_ss::_S_fractional_width&#39;</span> is not <a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a> constant expression</div>
<div class="line">      <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">unsigned</span> fractional_width = {_S_fractional_width()};</div>
</div><!-- fragment --><p class="startli">We have seen this with too <em><b>new</b></em> C++ standard libs such as the version 13.2. Use an older one such as 11.2.</p>
</li>
<li><p class="startli"><em><b>With Intel's OpenMP, we get the following error</b></em></p>
<div class="fragment"><div class="line">/nobackup/frmh84/Peano/src/libTarch_debug.a(libTarch_debug_a-Tasks.o): In function `<a class="code hl_function" href="../../d3/d3a/namespacetarch_1_1multicore_1_1native.html#a097f4f3ecc9e415257a444e7170fa22d">tarch::multicore::native::spawnTask</a>(<a class="code hl_class" href="../../dd/dd7/classtarch_1_1multicore_1_1Task.html">tarch::multicore::Task</a>*, std::set&lt;<span class="keywordtype">int</span>, std::less&lt;int&gt;, std::allocator&lt;int&gt; &gt; <span class="keyword">const</span>&amp;, <span class="keywordtype">int</span> <span class="keyword">const</span>&amp;)<span class="stringliteral">&#39;:</span></div>
<div class="line"><span class="stringliteral">/nobackup/frmh84/Peano/src/tarch/multicore/omp/Tasks.cpp:275: undefined reference to `__kmpc_omp_taskwait_deps_51&#39;</span></div>
<div class="ttc" id="aclasstarch_1_1multicore_1_1Task_html"><div class="ttname"><a href="../../dd/dd7/classtarch_1_1multicore_1_1Task.html">tarch::multicore::Task</a></div><div class="ttdoc">Abstract super class for a job.</div><div class="ttdef"><b>Definition</b> <a href="../../df/d4f/Task_8h_source.html#l00020">Task.h:20</a></div></div>
<div class="ttc" id="anamespacetarch_1_1multicore_1_1native_html_a097f4f3ecc9e415257a444e7170fa22d"><div class="ttname"><a href="../../d3/d3a/namespacetarch_1_1multicore_1_1native.html#a097f4f3ecc9e415257a444e7170fa22d">tarch::multicore::native::spawnTask</a></div><div class="ttdeci">void spawnTask(Task *task)</div></div>
</div><!-- fragment --><p class="startli">We have seen this with Intel compiler when you use the Clang LLVM OpenMP runtime, i.e. use -fopenmp. Switch to -fiopenmp instead.</p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md931"></a>
Linking</h1>
<ul>
<li><em><b>The linking fails for the tutorials even though I've followed all instructions</b></em> Almost always, this is due to missing packages. You have to configure your build system with ExaHyPE for example to run through ExaHyPE tutorials. Return to your root directory (autotools) or build directory (CMake), and rerun configure (autotools) or ccmake (CMake) picking all packages required.</li>
<li><em><b>My linker complains about a missing tbb, even though I do not use Intel's TBB</b></em> Intel has donated TBB to the open source community and Clang, for example, uses it internally to realise its OpenMP scheduler. Unfortunately, the integration is sometimes not mature, i.e. the compiler then does not automatically add the library to its settings. Reconfigure with <div class="fragment"><div class="line">LDFLAGS=<span class="stringliteral">&quot;-ltbb&quot;</span></div>
</div><!-- fragment --> and you should be fine.</li>
<li><em><b>If I use Fortran as well, I get errors alike</b></em> <div class="fragment"><div class="line">undefined reference to for_stop_core</div>
<div class="line">undefined reference to for_write_seq_list</div>
</div><!-- fragment --> This tells you that the linker failed to find the Fortran standard libraries. For the GNU compilers, you need for example the flag -lgfortran while Intel requires -lifcore within the LDFLAGS. You can add these flags manually via your Python script to the code, but I think this is a flaw. They belong into the configuration not into your Python script.</li>
<li><em><b>The linker complains about some routines/classes from the technical architectures, but they are definitely there</b></em> GCC/C++ is extremely sensitive when it comes to the order of the libraries used. You might have to edit your makefile manually to get a `&lsquo;valid&rsquo;' ordering that works. My recommendation is that you always links from the most abstract library to the lowest level lib. In one ExaHyPE project, e.g., the following order worked whereas all others resulted in linker errors: -lExaHyPE2Core2d_asserts, -lToolboxLoadBalancing2d_asserts, lPeano4Core2d_asserts, -lTarch_asserts. So the link order is high-level extensions, toolboxes, core, tarch. The Makefile which is generated by the Python API should follow this convention.</li>
<li><em><b>Linking fails for Intel icpx compilers</b></em> When encountering linker errors such as undefined reference to &lsquo;__kmpc_omp_taskwait_deps_51&rsquo; when compiling with OpenMP multithreading using the icpx compiler, you are probably not using the new -fiopenmp flag. Make sure to pass -fiopenmp to your configuration instead of -fopenmp.</li>
</ul>
<h1><a class="anchor" id="autotoc_md932"></a>
Runtime</h1>
<ul>
<li><em><b>My unit tests fail in the NodeTest</b></em>. We have found that GCC's STL is buggy (confirmed in version 9.3.0), although we do not know if this bug is found within the unordered_set, the bitset or the pair implementation. Anyway, a newer version of GCC (12 for example) seem to fix this issue. If you use Intel's toolchain or literally any LLVM, you might have to manually load a newer GNU version after you've loaded your core compiler.</li>
<li><em><b>sycl-ls show OpenCL devices instead of Level Zero (Intel PVC)</b></em> This can happen if the following environment variable was set ZET_ENABLE_PROGRAM_DEBUGGING=1. Simply unset it to fix the issue.</li>
</ul>
<h1><a class="anchor" id="autotoc_md933"></a>
Python API</h1>
<ul>
<li>***<code>import <a class="el" href="../../d8/d8f/namespacepeano4.html">peano4</a></code> yields not found error***. You haven't set your <code>PYTHONPATH</code> properly. Ensure that it points to Peano's python subdirectory. So use something similar to <pre class="fragment">     export PYTHONPATH=~/git/Peano/python
</pre></li>
<li>My installation or paraview complains about <em><b>ModuleNotFoundError: No module named 'numpy'</b></em>. For some parts of Peano and its extensions, you need the package numpy. If you don't have numpy on your system install it with either of the following commands: <pre class="fragment">     pip3 install --user numpy
</pre> Similar arguments hold for jinja2. Please note that Peano's API and all extensions are written in a way that they can work without numpy in principle. However, not all features (solvers in ExaHyPE, e.g.) might be available if you have no numpy.</li>
<li><em><b>The formatting scripts yields error messages</b></em>. Remove the .formatting_python_env directory and re-run the format.py script. Sometimes, errors can occur if the system python libraries get updated or the user has altered their pythonpath (which is why the PYTHONPATH variable is best left unmodified.) Removing the .formatting_python_env dir will prompt format.py to re-install all it needs.</li>
</ul>
<h1><a class="anchor" id="autotoc_md934"></a>
Performance analysis</h1>
<ul>
<li><em><b>The Intel/NVIDIA tools do not provide meaningful insight</b></em> Read through the vendor-specific supercomputer/tool remarks and pick the vendor-specific built toolchain. After that, ensure that you profile the code in the profile version and not only in the release version. The release builds of the libraries do not yield much additional information that can be used to spot runtime flaws, e.g.</li>
<li><em><b>The Intel/NVIDIA tools yield too much data</b></em> First, pick the vendor-specific toolchain fitting to your system/compiler. After that, amend your log filter. See <a class="el" href="../../d1/d9e/tarch_logging.html">Logging, tracing, statistics, profiling and assertions</a> for more info.</li>
</ul>
<h1><a class="anchor" id="autotoc_md935"></a>
External tools</h1>
<ul>
<li><em><b>doxygen shows a lot of code as if it were preformatted (source) code, even though it should be proper class/function documentations</b></em> This is a known bug in Doxygen. Update to a newer version of the tool (at least 1.9.7) from <a href="https://www.doxygen.nl/files">https://www.doxygen.nl/files</a> and you should be fine.</li>
<li><em><b>The Intel performance and correctness tools yield invalid or messed-up results</b></em> Ensure you have built your code with -DTBB_USE_ASSERT -DTBB_USE_THREADING_TOOLS. Please consult the vendor-specific supercomputer/tool remarks</li>
<li><em><b>I struggle to configure Peano 4 with Otter</b></em> First, ensure you add &ndash;with-otter to your configure call. If the configure fails, run through the following checks one by one:<ul>
<li>Ensure that you have added <div class="fragment"><div class="line">CXXFLAGS=<span class="stringliteral">&quot;... -Iyour-path/otter/include&quot;</span></div>
</div><!-- fragment --></li>
<li>Ensure that you have added <div class="fragment"><div class="line">LIBS=<span class="stringliteral">&quot;... -lotter-task-graph -lotf2</span></div>
</div><!-- fragment --> to your libraries. Depending on your system, you might need the explicit linking to otf2 or not.</li>
<li>Ensure that you have added <div class="fragment"><div class="line">LDFLAGS=<span class="stringliteral">&quot;... --Lyour-path/otter/build/lib -L/opt/otf2/lib&quot;</span></div>
</div><!-- fragment --> Once again, you might need the explicit OTF2 link or not.</li>
<li>Add the libraries to your library path <div class="fragment"><div class="line">LD_LIBRARY_PATH=$LD_LIBRARY_PATH:your-path/<a class="code hl_namespace" href="../../d8/da8/namespaceotter.html">otter</a>/build/lib:/opt/otf2/lib</div>
<div class="ttc" id="anamespaceotter_html"><div class="ttname"><a href="../../d8/da8/namespaceotter.html">otter</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/d7e/otter_8h_source.html#l00103">otter.h:103</a></div></div>
</div><!-- fragment --> as the checks otherwise will fail.</li>
</ul>
</li>
<li><em><b>pvpython does not find jinja2 and other Python packages</b></em> On some systems, pvpython seems to overwrite/redefine the Python package paths. That means, you manually have to add them to the PYTHONPATH before you invoke pvpython. I do so through <div class="fragment"><div class="line"><span class="keyword">export</span> PYTHONPATH=../Peano/python:/usr/lib/python3/dist-packages</div>
</div><!-- fragment --></li>
<li><em><b>paraview/pyvista is not there in my Jupyter notebook even though I have installed it</b></em> Some Jupyter notebooks seem to fire up their own Python environment. You can always type in <div class="fragment"><div class="line"><span class="keyword">import</span> sys</div>
<div class="line">!{sys.executable} -m pip install --break-system-packages pyvista</div>
</div><!-- fragment --> and then you should have it within your notebook.</li>
</ul>
<h1><a class="anchor" id="autotoc_md936"></a>
Debugging</h1>
<ul>
<li><em><b>I can't see my log/trace statements.</b></em> There's a whole set of things that can go wrong.<ul>
<li>Check that your log filter specifies the class name. For efficiency reasons, you can only filter per class. Ensure you don't specify methods. If you do so, Peano 4 thinks your method name is a (sub)class name and won't apply your filter.</li>
<li>Ensure that your main code is translated with a reasonable debug flag. The makefile has to translate your code with <code>-DPeanoDebug=4</code> (or 1 if you are only interested in tracing).</li>
<li>Ensure you link to libraries which are built with a reasonable debug level. For this, run your code and search for the header <pre class="fragment">         build: 2d, no mpi, C++ threading, debug level=4
</pre> on the terminal. Again, has to be 1 or 4 at least.</li>
<li>Ensure you have a whitelist entry for the routine you are interested in. Study how to use <a class="el" href="../../d1/d9e/tarch_logging.html">Peano's logging</a> or insert manual log filter statements: <pre class="fragment">        tarch::logging::LogFilter::getInstance().addFilterListEntry(
          tarch::logging::LogFilter::FilterListEntry(
            tarch::logging::LogFilter::FilterListEntry::TargetInfo,
            tarch::logging::LogFilter::FilterListEntry::AnyRank,
            "examples::algebraicmg",
            tarch::logging::LogFilter::FilterListEntry::WhiteListEntry
          )
        );
</pre></li>
<li>If you are still unsure which log filters are active, insert <pre class="fragment">         tarch::logging::LogFilter::getInstance().printFilterListToCout();
</pre> into your code and see which entries it does enlist.</li>
</ul>
</li>
<li><em><b>gdb says "not in executable format: file format not recognized"</b></em>. automake puts the actual executable into a <code>.libs</code> directory and creates bash scripts invoking those guys. Change into <code>.libs</code> and run gdb directly on the executable. Before you do so, ensure that <code>LD_LIBRARY_Path</code> points to the directory containing the libraries. Again, those guys are stored in a <code>.libs</code> subdirectory, so the library path should point to that subdirectory.</li>
</ul>
<h1><a class="anchor" id="autotoc_md937"></a>
MPI troubleshooting</h1>
<ul>
<li><em><b>My code crashes unexpectedly with malloc/free errors</b></em>. Please rerun your code with Intel MPI and the flag <code>-check_mpi</code>. You should not get any error reports. If you do, we have had serious problems as some of Peano's classes use <code>MPI_C_BOOL</code> or <code>MPI_CXX_BOOL</code>. They seem not be supported properly.</li>
<li><em><b>With more and more ranks, I suddenly run into timeouts</b></em>. Peano has a built-in timeout detection which you can alter by changing the timeout threshold. This is done via the <code>--timeout XXX</code> parameter.</li>
</ul>
<h2><a class="anchor" id="autotoc_md938"></a>
C++ core</h2>
<ul>
<li><b>Where is the information whether a point or face is at the boundary or not?</b> I do not provide any such feature. Many codes for example use the grid to represent complicated domains, and thus would need such a feature anyway. So what you have to do is to add a bool to each vertex/face and set this boolean yourself.</li>
<li>To be continued ...</li>
</ul>
<h2><a class="anchor" id="autotoc_md939"></a>
Parallelisation</h2>
<ul>
<li><b>Why do I (temporarily) get an adaptive grid even though I specify a regular one?</b> This phenomenon arises if your adaptive refinements and (dynamic) load balancing happen at the same time. Load balancing is realised by transfering a whole tree part (subpartition incl. coarser scales) to another rank after a grid sweep. Refinement happens in multiple stages: After a grid traversal, the rank takes all the refinement instructions and then realises them throughout the subsequent grid sweep. So if a rank gets a refinement command and then gives away parts of its mesh, then it might not be able to realise this refinement. At the same time, the rank accepting the new partition is not aware of the refinement requests yet. So it might get the refinement request, but with one step delay: It sets up the local partition, evaluates the refinement criterion, is informed about a refinement wish for this area, and subsequently realises it. For most codes, that delay by one iteration is not a problem as the newly established rank will just realise the refinement one grid sweep later, but the point is: refine and erase commands in  are always a wishlist to the kernel. The kernel can decide to ignore it&mdash;at least for one grid sweep.</li>
<li><b>Why do I get imbalanced partitions even though I tried to tell my load balancer of choice to balance brilliantly?</b>  is based upon three-partitioning, i.e. whenever it refines a cell it yields $3^d$ new cells. Most users scale up in multiples of two. As $3^d$ cannot be divided into two equally-sized chunks, we always have some imbalance.</li>
<li><b>Why do some load balancing schemes report that they have to extrapolate data?</b> A typical message you get is "global number of
    cells lags behind local one. ..."' Most of my toolbox load balancing relies on asynchronous (non-blocking) collectives to gather information about the total grid structure. As a consequence, this information always might lag behind the actual status quo (load balancing info is sent out while the mesh refines, e.g.). Some load balancing schemes can detect such inconsistencies&mdash;they only arise due to AMR and typically are sorted out an iteration later anyway&mdash;and apply heuristics. If they detect that the global cell number seems to be too small, e.g., they assume that every rank meanwhile has refined once more and multiply the global cell count with $3^d$.</li>
<li><b>I get a timeout but  claims that there are still messages in the MPI queue. How do I know what certain MPI messages tags mean?</b> All tags used in  are registered through the operation <code><a class="el" href="../../d3/dfe/classtarch_1_1mpi_1_1Rank.html#ab501a52fc09ea23bb061edbbfbcc89aa" title="Return a Free Tag.">tarch::mpi::Rank::reserveFreeTag</a></code>. If you translate with any positive value of <code>PeanoDebug</code> (the trace, debug and assert library variants of  do so, e.g.) then you get a list of tag semantics at startup. These lists are the same as the ones you use in release mode, i.e. when this information is not dumped. Please note that the info goes straight to cout, i.e. you can't filter it. That's because the tag allocation usually happens before our logging landscape is up and configured properly.</li>
<li>To be continued ...</li>
<li><p class="startli"><b>I have previously introduced auxiliary (material) parameters and now the code crashes every now and then.</b> Ensure that you initialise all data in your code. That includes any potential auxiliary variables. I usually use</p>
<p class="startli">for (int i=0; i&lt;NumberOfUnknowns+NumberOfAuxiliaryVariables; i++) Q[i] = 0.0;</p>
<p class="startli">as a first step within <code>initialCondition()</code>. So I ensure first that there is no garbage in the data. Further to that, ensure that you also set proper boundary data for any auxiliary value. You might not need these data, as you do not use the auxiliary variables to exchange information between patches, but you have to set proper values nevertheless. Otherwise, all of 's assertions will fail as it detects data corruption.</p>
</li>
<li><b>My higher order solver yields physically slightly unreasonable data for the Riemann solves.</b> If you use a higher-order scheme  has to project your polynomial solution onto the faces. For this, it uses pre-assembled matrices which are stored in double precision. However, round-off errors might lead to situations where you get small deviations&mdash;we have seen densities around $-10^{-8}$ for the Euler equations, e.g. Usually, such round-off errors are fine, but you might run into problems if you take the square root of such tiny negative values, e.g. It is therefore important that you apply the maximum function:</li>
</ul>
<p>Naive code leading into problems: // nonCriticalAssertion8( p&gt;=0.0, Q[0], Q[1], Q[2], Q[3], Q[4], x, t, normal ); // const double c = std::sqrt( gamma * p * irho );</p>
<p>working code: nonCriticalAssertion9( <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a">tarch::la::greaterEquals</a>(p,0.0), Q[0], Q[1], Q[2], Q[3], Q[4], x, t, normal, p ); const double c = std::sqrt( std::max(0.0,gamma * p * irho) ); </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Peano</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:29:04 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
