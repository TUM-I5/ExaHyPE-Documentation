<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d0/d29/namespacetoolbox_1_1particles.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#concepts">Concepts</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">toolbox::particles Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks" id="r_d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks.html">assignmentchecks</a></td></tr>
<tr class="memdesc:d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correctness checks of particle-mesh assignment. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/d68/namespacetoolbox_1_1particles_1_1internal" id="r_d0/d68/namespacetoolbox_1_1particles_1_1internal"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html">internal</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:db/db9/namespacetoolbox_1_1particles_1_1memorypool" id="r_db/db9/namespacetoolbox_1_1particles_1_1memorypool"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/db9/namespacetoolbox_1_1particles_1_1memorypool.html">memorypool</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/d4a/namespacetoolbox_1_1particles_1_1potentials" id="r_d0/d4a/namespacetoolbox_1_1particles_1_1potentials"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d4a/namespacetoolbox_1_1particles_1_1potentials.html">potentials</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/dd4/namespacetoolbox_1_1particles_1_1tests" id="r_d1/dd4/namespacetoolbox_1_1particles_1_1tests"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dd4/namespacetoolbox_1_1particles_1_1tests.html">tests</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dc9/classtoolbox_1_1particles_1_1FileReader.html">FileReader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A file reader.  <a href="../../d3/dc9/classtoolbox_1_1particles_1_1FileReader.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d89/classtoolbox_1_1particles_1_1FileReaderHDF5.html">FileReaderHDF5</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An HDF5 file reader This class works if and only if you have compiled Peano using &ndash;with-hdf5.  <a href="../../d3/d89/classtoolbox_1_1particles_1_1FileReaderHDF5.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d31/structtoolbox_1_1particles_1_1ParticleAccessorIdentity.html">ParticleAccessorIdentity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abstract base class for all flavours of particle sets.  <a href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html">SieveParticles</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility class for global sorting for all flavours of particle sets.  <a href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d84/classtoolbox_1_1particles_1_1TrajectoryDatabase.html">TrajectoryDatabase</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple particle database.  <a href="../../dc/d84/classtoolbox_1_1particles_1_1TrajectoryDatabase.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="concepts" name="concepts"></a>
Concepts</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">concept &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d25/concepttoolbox_1_1particles_1_1ParticleTimeSteppingAccessor.html">ParticleTimeSteppingAccessor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab30ce286caf1b7f3d29300013be3edaf" id="r_ab30ce286caf1b7f3d29300013be3edaf"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a></td></tr>
<tr class="separator:ab30ce286caf1b7f3d29300013be3edaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca8ad847edf923b82ac67aed84f87872" id="r_aca8ad847edf923b82ac67aed84f87872"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:aca8ad847edf923b82ac67aed84f87872"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aca8ad847edf923b82ac67aed84f87872">liftParticleAssociatedWithVertex</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;p, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> marker)</td></tr>
<tr class="memdesc:aca8ad847edf923b82ac67aed84f87872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take particle from current vertex and lift it or keep it local.  <br /></td></tr>
<tr class="separator:aca8ad847edf923b82ac67aed84f87872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4558458059ca35853e539daab9a1497" id="r_af4558458059ca35853e539daab9a1497"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4558458059ca35853e539daab9a1497">liftParticleAssociatedWithVertex</a> (<a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> isLocal, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> marker)</td></tr>
<tr class="memdesc:af4558458059ca35853e539daab9a1497"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of <a class="el" href="#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local.">liftParticleAssociatedWithVertex()</a> without the template.  <br /></td></tr>
<tr class="separator:af4558458059ca35853e539daab9a1497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87df833da9d9721541a2828f40b09162" id="r_a87df833da9d9721541a2828f40b09162"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:a87df833da9d9721541a2828f40b09162"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a87df833da9d9721541a2828f40b09162">sieveParticle</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:a87df833da9d9721541a2828f40b09162"><td class="mdescLeft">&#160;</td><td class="mdescRight">A particle is to be sieved into a vertex if.  <br /></td></tr>
<tr class="separator:a87df833da9d9721541a2828f40b09162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4172f19e8257217f4fb04665c58ae529" id="r_a4172f19e8257217f4fb04665c58ae529"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4172f19e8257217f4fb04665c58ae529">sieveParticle</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="separator:a4172f19e8257217f4fb04665c58ae529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba49c14d40f0e218fb5d1f95daeb65d6" id="r_aba49c14d40f0e218fb5d1f95daeb65d6"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:aba49c14d40f0e218fb5d1f95daeb65d6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="separator:aba49c14d40f0e218fb5d1f95daeb65d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882c7e1446d4cb2eedcb4084b1a02185" id="r_a882c7e1446d4cb2eedcb4084b1a02185"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a882c7e1446d4cb2eedcb4084b1a02185">dropParticle</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:a882c7e1446d4cb2eedcb4084b1a02185"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternative version of <a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle()</a> without templates.  <br /></td></tr>
<tr class="separator:a882c7e1446d4cb2eedcb4084b1a02185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f95ecb24d8df40a2e3c6bb4b44bda4" id="r_a01f95ecb24d8df40a2e3c6bb4b44bda4"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:a01f95ecb24d8df40a2e3c6bb4b44bda4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a01f95ecb24d8df40a2e3c6bb4b44bda4">particleWillBeDroppedFurther</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:a01f95ecb24d8df40a2e3c6bb4b44bda4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will the particle be dropped further throughout the traversal.  <br /></td></tr>
<tr class="separator:a01f95ecb24d8df40a2e3c6bb4b44bda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2988ccd80bf237bd303e5eb86c34f2f6" id="r_a2988ccd80bf237bd303e5eb86c34f2f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2988ccd80bf237bd303e5eb86c34f2f6">particleWillBeDroppedFurther</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker)</td></tr>
<tr class="separator:a2988ccd80bf237bd303e5eb86c34f2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9e6042994f3591eca0d42418965fec" id="r_abc9e6042994f3591eca0d42418965fec"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:abc9e6042994f3591eca0d42418965fec"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#abc9e6042994f3591eca0d42418965fec">particleWillBeDroppedFurther</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:abc9e6042994f3591eca0d42418965fec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will a particle be dropped further.  <br /></td></tr>
<tr class="separator:abc9e6042994f3591eca0d42418965fec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b4a443a1d5b99e293eb8b5aa44181b" id="r_a32b4a443a1d5b99e293eb8b5aa44181b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a32b4a443a1d5b99e293eb8b5aa44181b">particleWillBeDroppedFurther</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="separator:a32b4a443a1d5b99e293eb8b5aa44181b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43a4a60f1417b13ccaf6b7a758078b2" id="r_ac43a4a60f1417b13ccaf6b7a758078b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac43a4a60f1417b13ccaf6b7a758078b2">relativeSpatialOwnershipTolerance</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">::peano4::datamanagement::CellMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:ac43a4a60f1417b13ccaf6b7a758078b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ownership tolerance.  <br /></td></tr>
<tr class="separator:ac43a4a60f1417b13ccaf6b7a758078b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d14cc5bcd11394d8de22a91727d2bd2" id="r_a5d14cc5bcd11394d8de22a91727d2bd2"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:a5d14cc5bcd11394d8de22a91727d2bd2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5d14cc5bcd11394d8de22a91727d2bd2">getParticleReassociationInstructionWithinCellWithIntraCellReassignment</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;p, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker, <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> numberOfVertexWithinCell)</td></tr>
<tr class="memdesc:a5d14cc5bcd11394d8de22a91727d2bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">If you use this operation, you can be sure that every particle is associated to the right vertex after we've finished the traversal, or it is dumped into the set of particles that have to be sieved.  <br /></td></tr>
<tr class="separator:a5d14cc5bcd11394d8de22a91727d2bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad517f8c5b774c192d08e7fb7f8736e06" id="r_ad517f8c5b774c192d08e7fb7f8736e06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad517f8c5b774c192d08e7fb7f8736e06">getParticleReassociationInstructionWithinCellWithIntraCellReassignment</a> (<a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> isLocal, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker, <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> numberOfVertexWithinCell)</td></tr>
<tr class="separator:ad517f8c5b774c192d08e7fb7f8736e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accfeb35fd8694d1efddaf60c6795acd0" id="r_accfeb35fd8694d1efddaf60c6795acd0"><td class="memItemLeft" align="right" valign="top">std::bitset&lt; <a class="el" href="../../d9/df1/Globals_8h.html#ae7c038f02be8703e671d700496803857">TwoPowerD</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#accfeb35fd8694d1efddaf60c6795acd0">getAdjacentCellsOwningParticle</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="memdesc:accfeb35fd8694d1efddaf60c6795acd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find out which adjacent cell will hold a particle.  <br /></td></tr>
<tr class="separator:accfeb35fd8694d1efddaf60c6795acd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14ceda9c0640b68579d0c22646ad8b7" id="r_ac14ceda9c0640b68579d0c22646ad8b7"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:ac14ceda9c0640b68579d0c22646ad8b7"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ac14ceda9c0640b68579d0c22646ad8b7">init</a> (T &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> searchRadius)</td></tr>
<tr class="memdesc:ac14ceda9c0640b68579d0c22646ad8b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init particle.  <br /></td></tr>
<tr class="separator:ac14ceda9c0640b68579d0c22646ad8b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c614f4704c460d9651e869ab13dae1" id="r_aa5c614f4704c460d9651e869ab13dae1"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:aa5c614f4704c460d9651e869ab13dae1"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; T * &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aa5c614f4704c460d9651e869ab13dae1">createEquallySpacedParticles</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> spacingH, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;voxelX, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;voxelH, <a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> addNoise)</td></tr>
<tr class="memdesc:aa5c614f4704c460d9651e869ab13dae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create equally spaced particles for one cell.  <br /></td></tr>
<tr class="separator:aa5c614f4704c460d9651e869ab13dae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c889a88c2a642ee7000e494bf0fd3e4" id="r_a5c889a88c2a642ee7000e494bf0fd3e4"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a5c889a88c2a642ee7000e494bf0fd3e4"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; T * &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5c889a88c2a642ee7000e494bf0fd3e4">createParticlesAlignedWithGlobalCartesianMesh</a> (<a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> spacingH, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;voxelX, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;voxelH, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;domainOffset, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;domainSize, <a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> addNoise)</td></tr>
<tr class="memdesc:a5c889a88c2a642ee7000e494bf0fd3e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert particles that are aligned along a Cartesian grid globally.  <br /></td></tr>
<tr class="separator:a5c889a88c2a642ee7000e494bf0fd3e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedae9d84a277045cf24b9db2a75e56d5" id="r_aedae9d84a277045cf24b9db2a75e56d5"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aedae9d84a277045cf24b9db2a75e56d5"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aedae9d84a277045cf24b9db2a75e56d5">ensureAllParticleListsAreGatheredOrEmpty</a> (<a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; T &gt; vertices)</td></tr>
<tr class="memdesc:aedae9d84a277045cf24b9db2a75e56d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if all particles are either gathered or host the empt set.  <br /></td></tr>
<tr class="separator:aedae9d84a277045cf24b9db2a75e56d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ec7dbf292c79d8069b8c7ecdda8b11" id="r_ad1ec7dbf292c79d8069b8c7ecdda8b11"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ad1ec7dbf292c79d8069b8c7ecdda8b11"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ad1ec7dbf292c79d8069b8c7ecdda8b11">ensureThatParticleListsEncodeContinuousMemoryChunks</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::list&lt; T * &gt; activeParticles, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::vector&lt; <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> &gt; &amp;numberOfParticlesPerVertexAdded)</td></tr>
<tr class="memdesc:ad1ec7dbf292c79d8069b8c7ecdda8b11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate encoding of particle lists.  <br /></td></tr>
<tr class="separator:ad1ec7dbf292c79d8069b8c7ecdda8b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e002bde7d928496eca999a6f686d23" id="r_a70e002bde7d928496eca999a6f686d23"><td class="memTemplParams" colspan="2">template&lt;typename Iterator &gt; </td></tr>
<tr class="memitem:a70e002bde7d928496eca999a6f686d23"><td class="memTemplItemLeft" align="right" valign="top">Iterator&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a70e002bde7d928496eca999a6f686d23">particleIsDuplicate</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> typename Iterator::value_type &amp;particle, Iterator begin, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Iterator &amp;end)</td></tr>
<tr class="memdesc:a70e002bde7d928496eca999a6f686d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if there's already a particle at p's position in the set.  <br /></td></tr>
<tr class="separator:a70e002bde7d928496eca999a6f686d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a5d1708409c2375be02feb440adb54" id="r_ae2a5d1708409c2375be02feb440adb54"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:ae2a5d1708409c2375be02feb440adb54"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ae2a5d1708409c2375be02feb440adb54">particleWillStayWithinComputationalDomain</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;domainOffset, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;domainWidth)</td></tr>
<tr class="memdesc:ae2a5d1708409c2375be02feb440adb54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true if and only if.  <br /></td></tr>
<tr class="separator:ae2a5d1708409c2375be02feb440adb54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac52ee0c1974b7572d5207688f371946" id="r_aac52ee0c1974b7572d5207688f371946"><td class="memTemplParams" colspan="2">template&lt;typename Particle , typename <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; </td></tr>
<tr class="memitem:aac52ee0c1974b7572d5207688f371946"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aac52ee0c1974b7572d5207688f371946">insertParticlesIntoCell</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::vector&lt; Particle * &gt; &amp;newParticles, <a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; &amp;fineGridVertices, <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> spacetreeId)</td></tr>
<tr class="memdesc:aac52ee0c1974b7572d5207688f371946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert particle into a cell.  <br /></td></tr>
<tr class="separator:aac52ee0c1974b7572d5207688f371946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593ad6871d8a624f665e22cb5cfc0ea8" id="r_a593ad6871d8a624f665e22cb5cfc0ea8"><td class="memTemplParams" colspan="2">template&lt;typename Particle , typename <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; </td></tr>
<tr class="memitem:a593ad6871d8a624f665e22cb5cfc0ea8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a593ad6871d8a624f665e22cb5cfc0ea8">insertParticleIntoCell</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker, Particle *newParticles, <a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; &amp;fineGridVertices, <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> spacetreeId)</td></tr>
<tr class="memdesc:a593ad6871d8a624f665e22cb5cfc0ea8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert particle into cell.  <br /></td></tr>
<tr class="separator:a593ad6871d8a624f665e22cb5cfc0ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a696ec1f344752aebc1eae15b646a7ad0" id="r_a696ec1f344752aebc1eae15b646a7ad0"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:a696ec1f344752aebc1eae15b646a7ad0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a696ec1f344752aebc1eae15b646a7ad0">updateContainedInAdjacentCellProperty</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;marker, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt; &amp;assignedVertex, Particle &amp;particle)</td></tr>
<tr class="memdesc:a696ec1f344752aebc1eae15b646a7ad0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update helper flag per particle for cell.  <br /></td></tr>
<tr class="separator:a696ec1f344752aebc1eae15b646a7ad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c1930b6516475ba08fffd651f85fa0" id="r_ab1c1930b6516475ba08fffd651f85fa0"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:ab1c1930b6516475ba08fffd651f85fa0"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ab1c1930b6516475ba08fffd651f85fa0">updateContainedInAdjacentCellProperty</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker, Particle &amp;particle)</td></tr>
<tr class="separator:ab1c1930b6516475ba08fffd651f85fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace5053e90a4ccbddd2732cd8cd8af658" id="r_ace5053e90a4ccbddd2732cd8cd8af658"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:ace5053e90a4ccbddd2732cd8cd8af658"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#ace5053e90a4ccbddd2732cd8cd8af658">updateContainedInAdjacentCellProperty</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;h, Particle &amp;particle)</td></tr>
<tr class="memdesc:ace5053e90a4ccbddd2732cd8cd8af658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update internal marker of particle.  <br /></td></tr>
<tr class="separator:ace5053e90a4ccbddd2732cd8cd8af658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a5760759e013b208463c1ab5cadb0f1" id="r_a9a5760759e013b208463c1ab5cadb0f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9a5760759e013b208463c1ab5cadb0f1">particleAssignedToVertexWillBeLocal</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker)</td></tr>
<tr class="separator:a9a5760759e013b208463c1ab5cadb0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27a33db3cfffb9c89a48754bd0bd48e0" id="r_a27a33db3cfffb9c89a48754bd0bd48e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27a33db3cfffb9c89a48754bd0bd48e0">mirrorParticleAlongPeriodicDomains</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;marker, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; domainOffset, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; domainSize, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt; <a class="el" href="../../dd/dbf/benchmarks_2peano4_2grid_2main_8cpp.html#a57ebc38ae51b6d4b0e7e1dc43442f318">periodicBC</a>)</td></tr>
<tr class="memdesc:a27a33db3cfffb9c89a48754bd0bd48e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mirror a particle along the periodic domain boundaries.  <br /></td></tr>
<tr class="separator:a27a33db3cfffb9c89a48754bd0bd48e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac05d5ff6147e2048c3ca9e3df656280c" id="r_ac05d5ff6147e2048c3ca9e3df656280c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac05d5ff6147e2048c3ca9e3df656280c">applyPeriodicBoundaryConditions</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;x, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; domainOffset, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; domainSize, <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt; <a class="el" href="../../dd/dbf/benchmarks_2peano4_2grid_2main_8cpp.html#a57ebc38ae51b6d4b0e7e1dc43442f318">periodicBC</a>)</td></tr>
<tr class="memdesc:ac05d5ff6147e2048c3ca9e3df656280c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the periodic boundary condition on particle coordinates <code>x</code>.  <br /></td></tr>
<tr class="separator:ac05d5ff6147e2048c3ca9e3df656280c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb77f60ea4069f4895c301af3db1c390" id="r_abb77f60ea4069f4895c301af3db1c390"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:abb77f60ea4069f4895c301af3db1c390"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#abb77f60ea4069f4895c301af3db1c390">staticPosition</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;particle, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> <a class="el" href="../../d8/d7e/exahype2_2solvers_2fv_2godunov_2kernels_2kokkos_2Loop_8template_8h.html#acecd8d5f5f51cdecc27bbd970eeeacb5">timeStepSize</a>)</td></tr>
<tr class="memdesc:abb77f60ea4069f4895c301af3db1c390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Leave the tracer particles where they are.  <br /></td></tr>
<tr class="separator:abb77f60ea4069f4895c301af3db1c390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2476fc7e465b3c27ee0527bf426dddd6" id="r_a2476fc7e465b3c27ee0527bf426dddd6"><td class="memTemplParams" colspan="2">template&lt;typename Particle &gt; </td></tr>
<tr class="memitem:a2476fc7e465b3c27ee0527bf426dddd6"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a2476fc7e465b3c27ee0527bf426dddd6">explicitEuler</a> (Particle &amp;particle, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> <a class="el" href="../../d8/d7e/exahype2_2solvers_2fv_2godunov_2kernels_2kokkos_2Loop_8template_8h.html#acecd8d5f5f51cdecc27bbd970eeeacb5">timeStepSize</a>)</td></tr>
<tr class="memdesc:a2476fc7e465b3c27ee0527bf426dddd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple explicit Euler.  <br /></td></tr>
<tr class="separator:a2476fc7e465b3c27ee0527bf426dddd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75c97578e61400327b1bea2e77c52056" id="r_a75c97578e61400327b1bea2e77c52056"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html">tarch::tests::TestCase</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75c97578e61400327b1bea2e77c52056">getUnitTests</a> ()</td></tr>
<tr class="memdesc:a75c97578e61400327b1bea2e77c52056"><td class="mdescLeft">&#160;</td><td class="mdescRight">Please destroy after usage.  <br /></td></tr>
<tr class="separator:a75c97578e61400327b1bea2e77c52056"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acf81b96409bec4ab025251d611201785" id="r_acf81b96409bec4ab025251d611201785"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf81b96409bec4ab025251d611201785">ReleaseOwnershipSpatialSortingTolerance</a> = 1.01</td></tr>
<tr class="memdesc:acf81b96409bec4ab025251d611201785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorting tolerance.  <br /></td></tr>
<tr class="separator:acf81b96409bec4ab025251d611201785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb9faad12774af486a9ea1353a19c2ee" id="r_adb9faad12774af486a9ea1353a19c2ee"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb9faad12774af486a9ea1353a19c2ee">GrabOwnershipSpatialSortingTolerance</a> = 1.001</td></tr>
<tr class="separator:adb9faad12774af486a9ea1353a19c2ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c5a5545943f3a19f8565724cfbb992" id="r_af9c5a5545943f3a19f8565724cfbb992"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9c5a5545943f3a19f8565724cfbb992">ParticleReassociationInstruction_Keep</a> = -1</td></tr>
<tr class="separator:af9c5a5545943f3a19f8565724cfbb992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0435c43e782c1a0bf5dd4882d5212d04" id="r_a0435c43e782c1a0bf5dd4882d5212d04"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0435c43e782c1a0bf5dd4882d5212d04">ParticleReassociationInstruction_SieveGlobally</a> = -2</td></tr>
<tr class="separator:a0435c43e782c1a0bf5dd4882d5212d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f330e2aca3719717d69e968dec69e4e" id="r_a2f330e2aca3719717d69e968dec69e4e"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f330e2aca3719717d69e968dec69e4e">SpatialDuplicateTolerance</a> = 1e-6</td></tr>
<tr class="memdesc:a2f330e2aca3719717d69e968dec69e4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default tolerance to decide when two particles are the same.  <br /></td></tr>
<tr class="separator:a2f330e2aca3719717d69e968dec69e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ab30ce286caf1b7f3d29300013be3edaf" name="ab30ce286caf1b7f3d29300013be3edaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab30ce286caf1b7f3d29300013be3edaf">&#9670;&#160;</a></span>ParticleReassociationInstruction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> <a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">toolbox::particles::ParticleReassociationInstruction</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00015">15</a> of file <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html">MultiscaleTransitions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac05d5ff6147e2048c3ca9e3df656280c" name="ac05d5ff6147e2048c3ca9e3df656280c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac05d5ff6147e2048c3ca9e3df656280c">&#9670;&#160;</a></span>applyPeriodicBoundaryConditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; toolbox::particles::applyPeriodicBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>domainOffset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>domainSize</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt;</td>          <td class="paramname"><span class="paramname"><em>periodicBC</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the periodic boundary condition on particle coordinates <code>x</code>. </p>
<p>In <a class="el" href="#a27a33db3cfffb9c89a48754bd0bd48e0" title="Mirror a particle along the periodic domain boundaries.">mirrorParticleAlongPeriodicDomains()</a>, we check whether a vertex is located on the boundary, and if it is, apply the boundary conditions such that the vertex would "see" the particles. In contrast, here we blindly apply the periodic boundary conditions to a particle. This function is intended to be run on global particle lists, such as is used e.g. in exchangeSieveListsGlobally(). </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d22/particles_8cpp_source.html#l00042">42</a> of file <a class="el" href="../../dc/d22/particles_8cpp_source.html">particles.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00029">tarch::la::greater()</a>, <a class="el" href="../../dd/dbf/benchmarks_2peano4_2grid_2main_8cpp_source.html#l00019">periodicBC</a>, and <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00047">tarch::la::smaller()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dbc/SieveParticles_8cpph_source.html#l00041">toolbox::particles::SieveParticles&lt; T &gt;::exchangeSieveListsGlobally()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_cgraph">
<area shape="rect" title="Applies the periodic boundary condition on particle coordinates x." alt="" coords="5,23,255,63"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ac6589b2a6a88998920a591807cb5dc31" title=" " alt="" coords="303,5,434,31"/>
<area shape="poly" title=" " alt="" coords="255,27,290,24,290,29,255,33"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ab3cd3664dd66aa6062b2e3feab03171e" title=" " alt="" coords="303,55,435,80"/>
<area shape="poly" title=" " alt="" coords="255,53,290,57,289,62,255,59"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_ac05d5ff6147e2048c3ca9e3df656280c_icgraph">
<area shape="rect" title="Applies the periodic boundary condition on particle coordinates x." alt="" coords="245,13,495,53"/>
<area shape="rect" href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html#ae51b9ce783fc808dae46cd4939abca90" title="Get all the global sieve data consistent." alt="" coords="5,5,197,60"/>
<area shape="poly" title=" " alt="" coords="231,35,197,35,197,30,231,30"/>
</map>
</div>

</div>
</div>
<a id="aa5c614f4704c460d9651e869ab13dae1" name="aa5c614f4704c460d9651e869ab13dae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c614f4704c460d9651e869ab13dae1">&#9670;&#160;</a></span>createEquallySpacedParticles()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; T * &gt; toolbox::particles::createEquallySpacedParticles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>spacingH</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>voxelX</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>voxelH</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a></td>          <td class="paramname"><span class="paramname"><em>addNoise</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create equally spaced particles for one cell. </p>
<p>This routine creates equally spaced particles within one cell. It is a solely cell-local factory method, i.e. it does not take any adjacent cell into account. As a consequence, you will get a locally equidistant layout of particles, but you will not get a globally equidistant layout: The particles will not be spaced the same way across a cell face as they are spaced out inside a cell. If you need a globally equidistant layout, you will have to use <a class="el" href="#a5c889a88c2a642ee7000e494bf0fd3e4" title="Insert particles that are aligned along a Cartesian grid globally.">createParticlesAlignedWithGlobalCartesianMesh()</a>.</p>
<p>The routine creates all the resulting particles on the heap via a plain new(). That is, the particles will be scattered in memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spacingH</td><td>Spacing of particles. Pick it smaller or equal to 0 and we'll always create one particle in the center.</td></tr>
    <tr><td class="paramname">voxelX</td><td>Centre of voxel in space</td></tr>
    <tr><td class="paramname">voxelH</td><td>Size of voxel, i.e. subcell, into which the particles shall be embedded </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html#l00028">28</a> of file <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html">ParticleFactory.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01017">assertion</a>, <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01021">assertion4</a>, <a class="el" href="../../db/d9e/Loop_8h_source.html#l00043">dfor</a>, <a class="el" href="../../d0/deb/Scalar_8cpp_source.html#l00008">tarch::la::max()</a>, <a class="el" href="../../d8/d88/VectorOperations_8cpph_source.html#l00264">tarch::la::min()</a>, and <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00056">tarch::la::smallerEquals()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_aa5c614f4704c460d9651e869ab13dae1_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_aa5c614f4704c460d9651e869ab13dae1_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_aa5c614f4704c460d9651e869ab13dae1_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_aa5c614f4704c460d9651e869ab13dae1_cgraph">
<area shape="rect" title="Create equally spaced particles for one cell." alt="" coords="5,47,227,87"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="306,5,418,31"/>
<area shape="poly" title=" " alt="" coords="216,45,292,29,293,34,217,50"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="308,55,416,80"/>
<area shape="poly" title=" " alt="" coords="227,65,294,65,294,70,227,70"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="275,104,449,129"/>
<area shape="poly" title=" " alt="" coords="217,85,285,99,284,104,216,90"/>
</map>
</div>

</div>
</div>
<a id="a5c889a88c2a642ee7000e494bf0fd3e4" name="a5c889a88c2a642ee7000e494bf0fd3e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c889a88c2a642ee7000e494bf0fd3e4">&#9670;&#160;</a></span>createParticlesAlignedWithGlobalCartesianMesh()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; T * &gt; toolbox::particles::createParticlesAlignedWithGlobalCartesianMesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>spacingH</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>voxelX</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>voxelH</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>domainOffset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>domainSize</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a></td>          <td class="paramname"><span class="paramname"><em>addNoise</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert particles that are aligned along a Cartesian grid globally. </p>
<h2><a class="anchor" id="autotoc_md288"></a>
Biased insertion</h2>
<p>We compute the left number of the particle and the right one. If the left particle ends up exactly on the face, then we add it. If the right one ends up exactly on the face, we skip it. The rationale is that the right neighbour will insert that guy later on, and we don't want to insert particles twice. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html#l00071">71</a> of file <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html">ParticleFactory.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d5/db2/MatrixFreeMain_8template_8cpp.html#a5e0c560fe19fd1cf2f94b84de758afc3">_log</a>, <a class="el" href="../../db/d9e/Loop_8h_source.html#l00043">dfor</a>, <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00038">tarch::la::greaterEquals()</a>, <a class="el" href="../../d1/d45/Log_8h_source.html#l00373">logTraceInWith4Arguments</a>, <a class="el" href="../../d1/d45/Log_8h_source.html#l00380">logTraceOutWith1Argument</a>, <a class="el" href="../../d0/deb/Scalar_8cpp_source.html#l00008">tarch::la::max()</a>, <a class="el" href="../../d8/d88/VectorOperations_8cpph_source.html#l00264">tarch::la::min()</a>, <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#a2e9051e4b68cff83961b93842a1eabf3">tarch::la::remainder()</a>, and <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00047">tarch::la::smaller()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a5c889a88c2a642ee7000e494bf0fd3e4_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a5c889a88c2a642ee7000e494bf0fd3e4_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a5c889a88c2a642ee7000e494bf0fd3e4_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a5c889a88c2a642ee7000e494bf0fd3e4_cgraph">
<area shape="rect" title="Insert particles that are aligned along a Cartesian grid globally." alt="" coords="5,89,211,144"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="259,5,432,31"/>
<area shape="poly" title=" " alt="" coords="157,87,258,40,279,32,281,37,260,44,160,92"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="289,55,401,80"/>
<area shape="poly" title=" " alt="" coords="210,93,275,79,276,84,211,98"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="291,104,399,129"/>
<area shape="poly" title=" " alt="" coords="211,114,277,114,277,119,211,119"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a2e9051e4b68cff83961b93842a1eabf3" title="Return the remainder of a division." alt="" coords="270,153,421,179"/>
<area shape="poly" title=" " alt="" coords="211,135,271,148,270,153,210,141"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ab3cd3664dd66aa6062b2e3feab03171e" title=" " alt="" coords="279,203,411,228"/>
<area shape="poly" title=" " alt="" coords="161,142,260,188,284,196,282,201,258,192,159,147"/>
</map>
</div>

</div>
</div>
<a id="aba49c14d40f0e218fb5d1f95daeb65d6" name="aba49c14d40f0e218fb5d1f95daeb65d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba49c14d40f0e218fb5d1f95daeb65d6">&#9670;&#160;</a></span>dropParticle() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::dropParticle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00042">42</a> of file <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html">MultiscaleTransitions.cpph</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00073">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex01()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00170">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex02()</a>, and <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_aba49c14d40f0e218fb5d1f95daeb65d6_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_aba49c14d40f0e218fb5d1f95daeb65d6_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_aba49c14d40f0e218fb5d1f95daeb65d6_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_aba49c14d40f0e218fb5d1f95daeb65d6_icgraph">
<area shape="rect" title=" " alt="" coords="320,113,455,153"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#af9034a229caf9c65da1753928150e8ba" title="Test the instructions indicatring whether to lift a particle." alt="" coords="5,5,272,75"/>
<area shape="poly" title=" " alt="" coords="325,111,271,89,239,77,241,72,273,84,327,106"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#a948cbb444f1de74b3054bc5480b9a6d7" title=" " alt="" coords="5,99,272,168"/>
<area shape="poly" title=" " alt="" coords="306,136,272,136,272,131,306,131"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#ab16bdd50cac983f6d181cacd6899120f" title=" " alt="" coords="5,192,272,261"/>
<area shape="poly" title=" " alt="" coords="327,161,273,182,241,194,239,189,271,178,325,156"/>
</map>
</div>

</div>
</div>
<a id="a882c7e1446d4cb2eedcb4084b1a02185" name="a882c7e1446d4cb2eedcb4084b1a02185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882c7e1446d4cb2eedcb4084b1a02185">&#9670;&#160;</a></span>dropParticle() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::dropParticle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternative version of <a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle()</a> without templates. </p>
<p>This is the actual implementation, i.e. the template delegates to this one. Through the method, we can unittest the drop logic. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00092">92</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01020">assertion3</a>, <a class="el" href="#aca8ad847edf923b82ac67aed84f87872">liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>, and <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">ParticleReassociationInstruction_SieveGlobally</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a882c7e1446d4cb2eedcb4084b1a02185_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a882c7e1446d4cb2eedcb4084b1a02185_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a882c7e1446d4cb2eedcb4084b1a02185_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a882c7e1446d4cb2eedcb4084b1a02185_cgraph">
<area shape="rect" title="Alternative version of dropParticle() without templates." alt="" coords="5,13,140,53"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local." alt="" coords="188,5,384,60"/>
<area shape="poly" title=" " alt="" coords="140,30,174,30,174,35,140,35"/>
</map>
</div>

</div>
</div>
<a id="aedae9d84a277045cf24b9db2a75e56d5" name="aedae9d84a277045cf24b9db2a75e56d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedae9d84a277045cf24b9db2a75e56d5">&#9670;&#160;</a></span>ensureAllParticleListsAreGatheredOrEmpty()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::ensureAllParticleListsAreGatheredOrEmpty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; T &gt;</td>          <td class="paramname"><span class="paramname"><em>vertices</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if all particles are either gathered or host the empt set. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d59/ParticleListValidation_8cpph_source.html#l00002">2</a> of file <a class="el" href="../../dc/d59/ParticleListValidation_8cpph_source.html">ParticleListValidation.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01019">assertion2</a>, <a class="el" href="../../d1/da7/RefinementControl_8cpp_source.html#l00021">toString()</a>, and <a class="el" href="../../d9/df1/Globals_8h_source.html#l00021">TwoPowerD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_aedae9d84a277045cf24b9db2a75e56d5_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_aedae9d84a277045cf24b9db2a75e56d5_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_aedae9d84a277045cf24b9db2a75e56d5_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_aedae9d84a277045cf24b9db2a75e56d5_cgraph">
<area shape="rect" title="Check if all particles are either gathered or host the empt set." alt="" coords="5,5,196,60"/>
<area shape="rect" href="../../d1/da7/RefinementControl_8cpp.html#a10fbfa607702e35cf41b838edab3f814" title=" " alt="" coords="244,20,317,45"/>
<area shape="poly" title=" " alt="" coords="196,30,230,30,230,35,196,35"/>
</map>
</div>

</div>
</div>
<a id="ad1ec7dbf292c79d8069b8c7ecdda8b11" name="ad1ec7dbf292c79d8069b8c7ecdda8b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1ec7dbf292c79d8069b8c7ecdda8b11">&#9670;&#160;</a></span>ensureThatParticleListsEncodeContinuousMemoryChunks()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::ensureThatParticleListsEncodeContinuousMemoryChunks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::list&lt; T * &gt;</td>          <td class="paramname"><span class="paramname"><em>activeParticles</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::vector&lt; <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>numberOfParticlesPerVertexAdded</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate encoding of particle lists. </p>
<p>The flag numberOfParticlesPerVertexAdded encodes how many particles each vertex contributes to a list. If these particles are continuous in memory (per vertex), then we can iterate over activeParticles and validate that the resulting particles match the particles "reconstructed" via pointer arithmetic. If this is not the case, we dump an assertion. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d59/ParticleListValidation_8cpph_source.html#l00016">16</a> of file <a class="el" href="../../dc/d59/ParticleListValidation_8cpph_source.html">ParticleListValidation.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01017">assertion</a>, and <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01037">assertionEquals2</a>.</p>

</div>
</div>
<a id="a2476fc7e465b3c27ee0527bf426dddd6" name="a2476fc7e465b3c27ee0527bf426dddd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2476fc7e465b3c27ee0527bf426dddd6">&#9670;&#160;</a></span>explicitEuler()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::explicitEuler </td>
          <td>(</td>
          <td class="paramtype">Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>timeStepSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple explicit Euler. </p>
<p>We realise the explicit Euler through a policy template technique: The routine is generic as it accepts a template type as particle. However, it does not expect the template argument to have a particular velocity attribute. Instead, it takes a second template argument which takes the particle and provides setters and getters.</p>
<p>While the construct seems to be complicated, it allows us to write the Euler once, but to use it for various particles. Some of them might have a field called velocity, others might not have such a field and get their data from somewhere else.</p>
<p>The term policy is not uniquely determined in C++ and thus this name might not be optimal.</p>
<h2><a class="anchor" id="autotoc_md299"></a>
Template argument</h2>
<p>ParticleAccesor has to be a class (or struct) which defines a typedef called Particle.</p>
<p>It has to to provide the routines</p>
<ul>
<li>v()</li>
<li>v() const</li>
<li>x()</li>
<li>x() const</li>
</ul>
<p>which return a copy or provide access to the velocity or position, respectively. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d76/toolbox_2particles_2Tracer_8cpph_source.html#l00002">2</a> of file <a class="el" href="../../d8/d76/toolbox_2particles_2Tracer_8cpph_source.html">Tracer.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d7e/exahype2_2solvers_2fv_2godunov_2kernels_2kokkos_2Loop_8template_8h_source.html#l00017">timeStepSize</a>.</p>

</div>
</div>
<a id="accfeb35fd8694d1efddaf60c6795acd0" name="accfeb35fd8694d1efddaf60c6795acd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accfeb35fd8694d1efddaf60c6795acd0">&#9670;&#160;</a></span>getAdjacentCellsOwningParticle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::bitset&lt; <a class="el" href="../../d9/df1/Globals_8h.html#ae7c038f02be8703e671d700496803857">TwoPowerD</a> &gt; toolbox::particles::getAdjacentCellsOwningParticle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find out which adjacent cell will hold a particle. </p>
<p>Let the routine find out which of the neighbouring cells will try to claim ownership of a particle. In exact arithmetics, this routine would be the same as <a class="el" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#a0dcf0f5ee089b9a282db5ff4e22edf35" title="Find out which vertex should hold a particle.">internal::getParticleAssociationWithinCell()</a>. However, we work with floating point precision and cells with a slight overlap. Therefore, multiple adjacent cells might try to claim ownership of the particle potentially, and this is important to find out a priori whether a particle will be labelled as inside or not.</p>
<p>For the floating point reason, i.e. the fact that the particle ownership is not unique, VertexMarker::getRelativeAdjacentCell() is a more strict version of this routine and cannot be used in some cases.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particle</td><td>The particle of interest to be studied. </td></tr>
    <tr><td class="paramname">x</td><td>Vertex centre. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00129">129</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../db/d9e/Loop_8h_source.html#l00086">dfor2</a>, <a class="el" href="../../db/d9e/Loop_8h_source.html#l00117">enddforx</a>, <a class="el" href="../../db/d7c/CellMarker_8cpp_source.html#l00045">peano4::datamanagement::CellMarker::isContained()</a>, <a class="el" href="../../d0/deb/Scalar_8cpp_source.html#l00008">tarch::la::max()</a>, <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18">tarch::la::multiplyComponents()</a>, and <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d22/particles_8cpp_source.html#l00006">particleAssignedToVertexWillBeLocal()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_cgraph">
<area shape="rect" title="Find out which adjacent cell will hold a particle." alt="" coords="5,63,243,103"/>
<area shape="rect" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#aa95cd9a5ed79cb4935a878de1fa90fed" title="Is x contained within cell identified by marker object." alt="" coords="303,5,497,45"/>
<area shape="poly" title=" " alt="" coords="220,60,289,46,290,51,221,65"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="344,70,456,95"/>
<area shape="poly" title=" " alt="" coords="243,80,331,80,331,85,243,85"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="291,119,509,145"/>
<area shape="poly" title=" " alt="" coords="237,100,315,114,314,120,236,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_accfeb35fd8694d1efddaf60c6795acd0_icgraph">
<area shape="rect" title="Find out which adjacent cell will hold a particle." alt="" coords="515,91,752,131"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a9a5760759e013b208463c1ab5cadb0f1" title=" " alt="" coords="272,84,467,139"/>
<area shape="poly" title=" " alt="" coords="501,114,467,114,467,109,501,109"/>
<area shape="rect" href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html#a61c379ee6f8b7f1e88e26650a864d1a4" title="Get particles that are to be sieved into one vertex." alt="" coords="12,5,217,60"/>
<area shape="poly" title=" " alt="" coords="267,82,203,63,205,58,268,77"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#af4558458059ca35853e539daab9a1497" title="Implementation of liftParticleAssociatedWithVertex() without the template." alt="" coords="17,84,213,139"/>
<area shape="poly" title=" " alt="" coords="258,114,213,114,213,109,258,109"/>
<area shape="rect" href="../../d5/d12/classtoolbox_1_1particles_1_1tests_1_1TestHelpers.html#ad2f05c2baa428e77be95f48fb63b5ecb" title="Test particleAssignedToVertexWillBeLocal()" alt="" coords="5,163,224,233"/>
<area shape="poly" title=" " alt="" coords="276,146,218,166,216,161,274,141"/>
</map>
</div>

</div>
</div>
<a id="ad517f8c5b774c192d08e7fb7f8736e06" name="ad517f8c5b774c192d08e7fb7f8736e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad517f8c5b774c192d08e7fb7f8736e06">&#9670;&#160;</a></span>getParticleReassociationInstructionWithinCellWithIntraCellReassignment() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">toolbox::particles::ParticleReassociationInstruction</a> toolbox::particles::getParticleReassociationInstructionWithinCellWithIntraCellReassignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a></td>          <td class="paramname"><span class="paramname"><em>isLocal</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a></td>          <td class="paramname"><span class="paramname"><em>numberOfVertexWithinCell</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00051">51</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d92/CompressedFloat_8h_source.html#l00015">std::abs()</a>, <a class="el" href="../../d1/d45/Log_8h_source.html#l00050">logDebug</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00017">ParticleReassociationInstruction_Keep</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">ParticleReassociationInstruction_SieveGlobally</a>, <a class="el" href="../../db/dde/internal_8h_source.html#l00058">ReleaseOwnershipSpatialSortingTolerance</a>, <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00056">tarch::la::smallerEquals()</a>, and <a class="el" href="../../d9/df1/Globals_8h_source.html#l00021">TwoPowerD</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ad517f8c5b774c192d08e7fb7f8736e06_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ad517f8c5b774c192d08e7fb7f8736e06_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ad517f8c5b774c192d08e7fb7f8736e06_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_ad517f8c5b774c192d08e7fb7f8736e06_cgraph">
<area shape="rect" title=" " alt="" coords="5,9,248,78"/>
<area shape="rect" href="../../d8/dcc/namespacestd.html#abdf604272c8422a961aaedd1d68de0bd" title=" " alt="" coords="347,5,420,31"/>
<area shape="poly" title=" " alt="" coords="248,29,333,20,333,26,249,34"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="296,55,471,80"/>
<area shape="poly" title=" " alt="" coords="249,52,283,55,282,61,248,57"/>
</map>
</div>

</div>
</div>
<a id="a5d14cc5bcd11394d8de22a91727d2bd2" name="a5d14cc5bcd11394d8de22a91727d2bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d14cc5bcd11394d8de22a91727d2bd2">&#9670;&#160;</a></span>getParticleReassociationInstructionWithinCellWithIntraCellReassignment() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a> toolbox::particles::getParticleReassociationInstructionWithinCellWithIntraCellReassignment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a></td>          <td class="paramname"><span class="paramname"><em>numberOfVertexWithinCell</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If you use this operation, you can be sure that every particle is associated to the right vertex after we've finished the traversal, or it is dumped into the set of particles that have to be sieved. </p>
<p>Therefore, you don't have to check any particle anymore in touchVertexLastTime(). All should be in place.</p>
<p>We return</p>
<ul>
<li>ParticleReassociationInstruction_Keep if the particle should remain where it is.</li>
<li>A value between 0 and 2^d-1 if we should assign it to another vertex of this cell (on the same level).</li>
</ul>
<h2><a class="anchor" id="autotoc_md287"></a>
Algorithm</h2>
<ul>
<li>If the particle is not local or actually not covered by the current cell, we return keep, as we don't dare to make a decision.</li>
<li>When we identify the destination cell, we violate our halo discussion above, i.e. we move the association within a cell given harsh boundaries not subject to MultilevelSortingTolerance. </li>
</ul>

</div>
</div>
<a id="a75c97578e61400327b1bea2e77c52056" name="a75c97578e61400327b1bea2e77c52056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75c97578e61400327b1bea2e77c52056">&#9670;&#160;</a></span>getUnitTests()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html">tarch::tests::TestCase</a> * toolbox::particles::getUnitTests </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Please destroy after usage. </p>

<p class="definition">Definition at line <a class="el" href="../../d6/db4/toolbox_2particles_2UnitTests_8cpp_source.html#l00012">12</a> of file <a class="el" href="../../d6/db4/toolbox_2particles_2UnitTests_8cpp_source.html">UnitTests.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d7a/TreeTestCaseCollection_8cpp_source.html#l00126">tarch::tests::TreeTestCaseCollection::addTestCase()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d12/src_2unittests_2main_8cpp_source.html#l00047">runTests()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_cgraph">
<area shape="rect" title="Please destroy after usage." alt="" coords="5,5,140,45"/>
<area shape="rect" href="../../d7/da0/classtarch_1_1tests_1_1TreeTestCaseCollection.html#a221ed543b82f7c82d46b5368cf99b040" title="Adds a new test case." alt="" coords="188,5,376,45"/>
<area shape="poly" title=" " alt="" coords="141,23,174,23,174,28,141,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a75c97578e61400327b1bea2e77c52056_icgraph">
<area shape="rect" title="Please destroy after usage." alt="" coords="129,5,264,45"/>
<area shape="rect" href="../../d0/d12/src_2unittests_2main_8cpp.html#a2dcdccc8a8ededb7804d00ba921edb73" title=" " alt="" coords="5,13,81,38"/>
<area shape="poly" title=" " alt="" coords="116,28,82,28,82,23,116,23"/>
</map>
</div>

</div>
</div>
<a id="ac14ceda9c0640b68579d0c22646ad8b7" name="ac14ceda9c0640b68579d0c22646ad8b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14ceda9c0640b68579d0c22646ad8b7">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::init </td>
          <td>(</td>
          <td class="paramtype">T &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init particle. </p>
<p>This is the most generic, minimalist initialisation of a particle that one can think of. The minimal data we need per particle is</p>
<ul>
<li>a position x which defines where the particle is located,</li>
<li>a search radius which defines on which resolution level to hold the particle.</li>
</ul>
<p>The further attribute that is set is the parallel state. At this point, we set it to Virtual. This highlights that fact that you should not add particles directly to the mesh, but instead use <a class="el" href="#a593ad6871d8a624f665e22cb5cfc0ea8" title="Insert particle into cell.">insertParticleIntoCell()</a> which then in turn will toggle to Local. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html#l00014">14</a> of file <a class="el" href="../../d1/d03/ParticleFactory_8cpph_source.html">ParticleFactory.cpph</a>.</p>

</div>
</div>
<a id="a593ad6871d8a624f665e22cb5cfc0ea8" name="a593ad6871d8a624f665e22cb5cfc0ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593ad6871d8a624f665e22cb5cfc0ea8">&#9670;&#160;</a></span>insertParticleIntoCell()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle , typename <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::insertParticleIntoCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Particle *</td>          <td class="paramname"><span class="paramname"><em>newParticles</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>fineGridVertices</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a></td>          <td class="paramname"><span class="paramname"><em>spacetreeId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert particle into cell. </p>
<p>This routine assumes that the particle indeed fits into a cell. Otherwise, I cannot assign in properly. If it falls into a cell, then I can in return rightfully assume that the particle is local. Setting the flag to local is important, as the locality analysis of Peano usually sets particles to local in touchCellFirstTime(). You don't know if the particle insertion is called before or after this analysis step, so we might just have missed the local insertion and therefore miss out on particles.</p>
<p>I recommend never to insert a particle directly, but always to run through this routine and to combine it with a particle sorting step. On the one hand, thisensures that particles are inserted in a consistent way, i.e. stored next to their closest neighbour. On the other hand, this ensures that a particle is never assigned to a hanging vertex and then lost. If you assign to a hanging vertex in a step where no grid re-sorting is active, you will effectively loose the particle, as it will disappear with the elimination of the hanging vertex.</p>
<h2><a class="anchor" id="autotoc_md289"></a>
Realisation</h2>
<ul>
<li>Find which vertex in the cell is the closest vertex.</li>
<li>Set the particle state to local. As we know that we insert only into local cells, we can do this without any fear. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00093">93</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d5/db2/MatrixFreeMain_8template_8cpp.html#a5e0c560fe19fd1cf2f94b84de758afc3">_log</a>, <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01020">assertion3</a>, <a class="el" href="../../dc/d46/Assertions_8h_source.html#l01021">assertion4</a>, <a class="el" href="../../d8/d3f/TracingAPI_8cpp_source.html#l00535">toolbox::particles::assignmentchecks::assignParticleToVertex()</a>, <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00038">tarch::la::greaterEquals()</a>, <a class="el" href="../../d1/d45/Log_8h_source.html#l00050">logDebug</a>, <a class="el" href="../../d8/d88/VectorOperations_8cpph_source.html#l00264">tarch::la::min()</a>, <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18">tarch::la::multiplyComponents()</a>, <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00047">tarch::la::smaller()</a>, <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00056">tarch::la::smallerEquals()</a>, and <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00051">updateContainedInAdjacentCellProperty()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00039">insertParticlesIntoCell()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_cgraph">
<area shape="rect" title="Insert particle into cell." alt="" coords="5,177,171,217"/>
<area shape="rect" href="../../d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks.html#a08c87f6e5c2d2fccf672e8a07530e81d" title="Assign a particle to a vertex." alt="" coords="240,5,408,60"/>
<area shape="poly" title=" " alt="" coords="103,175,151,123,183,94,217,69,226,64,229,68,220,74,186,98,155,127,107,178"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="237,84,411,109"/>
<area shape="poly" title=" " alt="" coords="116,174,163,145,218,118,240,110,242,115,220,123,165,150,119,179"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="270,133,378,159"/>
<area shape="poly" title=" " alt="" coords="170,176,256,158,257,163,172,182"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="477,279,696,304"/>
<area shape="poly" title=" " alt="" coords="171,192,294,198,363,206,430,219,496,243,552,270,550,274,494,247,429,225,362,211,294,203,171,198"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ab3cd3664dd66aa6062b2e3feab03171e" title=" " alt="" coords="258,235,390,260"/>
<area shape="poly" title=" " alt="" coords="172,212,252,229,250,234,170,217"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="237,284,411,309"/>
<area shape="poly" title=" " alt="" coords="120,214,166,242,220,269,246,278,244,283,218,274,163,247,117,219"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a696ec1f344752aebc1eae15b646a7ad0" title="Update helper flag per particle for cell." alt="" coords="219,357,429,412"/>
<area shape="poly" title=" " alt="" coords="110,215,158,264,220,319,263,348,260,352,217,323,155,268,106,219"/>
<area shape="poly" title=" " alt="" coords="401,355,536,306,538,311,402,360"/>
<area shape="poly" title=" " alt="" coords="278,357,278,347,287,338,302,333,324,331,351,334,366,342,363,346,349,339,324,336,303,338,290,343,283,349,284,357"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a593ad6871d8a624f665e22cb5cfc0ea8_icgraph">
<area shape="rect" title="Insert particle into cell." alt="" coords="225,5,391,45"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aac52ee0c1974b7572d5207688f371946" title="Insert particle into a cell." alt="" coords="5,5,177,45"/>
<area shape="poly" title=" " alt="" coords="211,28,178,28,178,23,211,23"/>
</map>
</div>

</div>
</div>
<a id="aac52ee0c1974b7572d5207688f371946" name="aac52ee0c1974b7572d5207688f371946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac52ee0c1974b7572d5207688f371946">&#9670;&#160;</a></span>insertParticlesIntoCell()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle , typename <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::insertParticlesIntoCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::vector&lt; Particle * &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>newParticles</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d29/structpeano4_1_1datamanagement_1_1VertexEnumerator.html">peano4::datamanagement::VertexEnumerator</a>&lt; <a class="el" href="../../d5/ddd/classtoolbox_1_1particles_1_1ParticleSet.html">ParticleSet</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>fineGridVertices</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a></td>          <td class="paramname"><span class="paramname"><em>spacetreeId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert particle into a cell. </p>
<p>Shallow copy, i.e. you can remove the input container newParticles, but you may not delete the particles it is pointing to.</p>
<p>This routine basically runs through the vector passed and calls the other <a class="el" href="#a593ad6871d8a624f665e22cb5cfc0ea8" title="Insert particle into cell.">insertParticleIntoCell()</a> operation per particle. </p>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00039">39</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00093">insertParticleIntoCell()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_aac52ee0c1974b7572d5207688f371946_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_aac52ee0c1974b7572d5207688f371946_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_aac52ee0c1974b7572d5207688f371946_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_aac52ee0c1974b7572d5207688f371946_cgraph">
<area shape="rect" title="Insert particle into a cell." alt="" coords="5,177,177,217"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a593ad6871d8a624f665e22cb5cfc0ea8" title="Insert particle into cell." alt="" coords="225,177,391,217"/>
<area shape="poly" title=" " alt="" coords="178,194,212,194,212,199,178,199"/>
<area shape="rect" href="../../d5/d1c/namespacetoolbox_1_1particles_1_1assignmentchecks.html#a08c87f6e5c2d2fccf672e8a07530e81d" title="Assign a particle to a vertex." alt="" coords="460,5,628,60"/>
<area shape="poly" title=" " alt="" coords="323,175,371,123,403,94,437,69,446,64,449,68,440,74,406,98,375,127,327,178"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="457,84,631,109"/>
<area shape="poly" title=" " alt="" coords="336,174,383,145,438,118,460,110,462,115,440,123,385,150,339,179"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="490,133,598,159"/>
<area shape="poly" title=" " alt="" coords="390,176,476,158,477,163,392,182"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="697,279,916,304"/>
<area shape="poly" title=" " alt="" coords="391,192,514,198,583,206,650,219,716,243,772,270,770,274,714,247,649,225,582,211,514,203,391,198"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ab3cd3664dd66aa6062b2e3feab03171e" title=" " alt="" coords="478,235,610,260"/>
<area shape="poly" title=" " alt="" coords="392,212,472,229,470,234,390,217"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="457,284,631,309"/>
<area shape="poly" title=" " alt="" coords="340,214,386,242,440,269,466,278,464,283,438,274,383,247,337,219"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a696ec1f344752aebc1eae15b646a7ad0" title="Update helper flag per particle for cell." alt="" coords="439,357,649,412"/>
<area shape="poly" title=" " alt="" coords="330,215,378,264,440,319,483,348,480,352,437,323,375,268,326,219"/>
<area shape="poly" title=" " alt="" coords="621,355,756,306,758,311,622,360"/>
<area shape="poly" title=" " alt="" coords="498,357,498,347,507,338,522,333,544,331,571,334,586,342,583,346,569,339,544,336,523,338,510,343,503,349,504,357"/>
</map>
</div>

</div>
</div>
<a id="af4558458059ca35853e539daab9a1497" name="af4558458059ca35853e539daab9a1497"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4558458059ca35853e539daab9a1497">&#9670;&#160;</a></span>liftParticleAssociatedWithVertex() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">toolbox::particles::ParticleReassociationInstruction</a> toolbox::particles::liftParticleAssociatedWithVertex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a></td>          <td class="paramname"><span class="paramname"><em>isLocal</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a></td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of <a class="el" href="#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local.">liftParticleAssociatedWithVertex()</a> without the template. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00019">19</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../db/d7c/CellMarker_8cpp_source.html#l00045">peano4::datamanagement::CellMarker::isContained()</a>, <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>, <a class="el" href="../../dc/d22/particles_8cpp_source.html#l00006">particleAssignedToVertexWillBeLocal()</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00017">ParticleReassociationInstruction_Keep</a>, and <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">ParticleReassociationInstruction_SieveGlobally</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_af4558458059ca35853e539daab9a1497_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_af4558458059ca35853e539daab9a1497_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_af4558458059ca35853e539daab9a1497_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_af4558458059ca35853e539daab9a1497_cgraph">
<area shape="rect" title="Implementation of liftParticleAssociatedWithVertex() without the template." alt="" coords="5,30,201,85"/>
<area shape="rect" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#aa95cd9a5ed79cb4935a878de1fa90fed" title="Is x contained within cell identified by marker object." alt="" coords="789,5,984,45"/>
<area shape="poly" title=" " alt="" coords="201,50,249,48,775,27,775,32,249,53,202,55"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a9a5760759e013b208463c1ab5cadb0f1" title=" " alt="" coords="249,62,444,117"/>
<area shape="poly" title=" " alt="" coords="202,68,236,72,235,77,201,73"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#accfeb35fd8694d1efddaf60c6795acd0" title="Find out which adjacent cell will hold a particle." alt="" coords="492,65,729,105"/>
<area shape="poly" title=" " alt="" coords="444,85,478,85,478,90,444,91"/>
<area shape="poly" title=" " alt="" coords="703,63,780,46,781,51,704,68"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="831,71,943,97"/>
<area shape="poly" title=" " alt="" coords="729,82,817,82,817,87,730,87"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="777,121,996,146"/>
<area shape="poly" title=" " alt="" coords="726,103,800,116,799,121,725,108"/>
</map>
</div>

</div>
</div>
<a id="aca8ad847edf923b82ac67aed84f87872" name="aca8ad847edf923b82ac67aed84f87872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca8ad847edf923b82ac67aed84f87872">&#9670;&#160;</a></span>liftParticleAssociatedWithVertex() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ab30ce286caf1b7f3d29300013be3edaf">ParticleReassociationInstruction</a> toolbox::particles::liftParticleAssociatedWithVertex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>p</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a></td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take particle from current vertex and lift it or keep it local. </p>
<p>This routine should be called by touchVertexLastTime(). Different to its cousin <a class="el" href="#a5d14cc5bcd11394d8de22a91727d2bd2" title="If you use this operation, you can be sure that every particle is associated to the right vertex afte...">getParticleReassociationInstructionWithinCellWithIntraCellReassignment()</a>, it should not be called within the cell. Usually, users do not invoke the routine directly. Instead the action set peano4.toolbox.particles.api.UpdateParticleGridAssociation_ListDrop injects calls to this routine into the generated source code.</p>
<p>The function returns one of the following values:</p>
<ul>
<li>particles::internal::ParticleReassociationInstruction_Keep. All is fine, just analyse the next particles.</li>
<li>particles::internal::ParticleReassociationInstruction_SieveGlobally. Particle should not be associated with this vertex, but you can't just move it one level up. Remove it completely from mesh and push it into a global list of particles which shall be sieved in the next step.</li>
<li>A value between 0 and \( 2^d-1 \). In this case, the particle should not be associated to this vertex. Remove the association and associate to the next coarsest level. The vertex within this coarse cell is identified by the result number.</li>
</ul>
<h2><a class="anchor" id="autotoc_md282"></a>
Algorithm</h2>
<p>The algorithm starts from a simple observation:</p>
<ul>
<li>If a particle is not local, we keep it, as we don't dare to make a comment to which mesh entity is should be moved to. Actually, non-local particles should never be moved. Hence, we could run the association analysis and then check if a non-local particle is kept where it should be, but we do it the other way round: We don't continue to check for virtual particles. We use the local flag as an optimisation opportunity.</li>
<li>If a particle is local, it might have moved and it might have to be assigned to another vertex.</li>
</ul>
<div class="image">
<object type="image/svg+xml" data="../../MultiscaleTransitions_belongs-to-vertex.svg" style="pointer-events: none;"></object>
</div>
<p>Particles are always associated to their closest vertex. If the blue particle moves, it remains within that area around the vertex where it belongs to, and we can return a particles::internal::ParticleReassociationInstruction_Keep command. peano4::datatraversal::VertexMarker::isContainedInAdjacentCells() allows us to make this decision quickly: We check if a particle is contained within the h/2 environment around a vertex. If a particle has left this (greenish) area around a vertex, we have to associate it to another vertex. We have to lift. Lifts however can only be realised within the local spacetree, where we have local and thread-safe access to the coarse level data structures of the tree.</p>
<p><a class="el" href="#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local.">liftParticleAssociatedWithVertex()</a> is called by touchVertexLastTime() which in turn is called from within a cell: We are about to leave a cell, find out that a vertex won't be needed anymore, and consequently trigger touchVertexLastTime(). Each cell has a unique parent within the spacetree.</p>
<p>If the parent cell is not local, we have to assume that we just did hit a vertical tree cut. In this case, we are on the safe side if we just add the particles to the global sieve particle list. We return ParticleReassociationInstruction_SieveGlobally.</p>
<p>If the parent cell is local, we can determine which of the \( 2^d \) coarse grid vertices would hold the particle. If this coarse grid is not adjacent to the local domain, we have to sieve. In the illustration below, we can see this behaviour on the right-hand side:</p>
<div class="image">
<img src="../../MultiscaleTransitions_liftParticleAssociatedWithVertex.png" alt=""/>
</div>
<ul>
<li>The particle (red solid dot) moves from left to right.</li>
<li>Due to the move, the particle's current vertex association (blurry blue) becomes invalid.</li>
<li>We have would like to lift it to the red blurry vertex.</li>
<li>The parent cell belongs to another rank (yellow instaed of blue).</li>
<li>Therefore, we have to add it to the global sieve list.</li>
</ul>
<p>There is a second, more delicate case which is illustrated on the left-hand side of the sketch:</p>
<ul>
<li>Let the part move from left to right on the fine grid owned by the blue rank.</li>
<li>Therefore, the particle changes its vertex association from blurry blue to blurry green.</li>
<li>We cannot realise this reassociation directly within touchVertexLastTime(). Therefore, we lift the particle to the red coarse grid vertex.</li>
<li>This vertex also is adjacent to the blue rank. Nevertheless, we have to assign is to the global sieve list, as we move it through the horizontal tree cut.</li>
</ul>
<p>If we reassigned it locally, it would be labelled as remote on the coarser level in the next iteration. The yellow rank in return would receive a copy from the blue-yellow coarse grid boundary and then label it as local there. While this is correct, we now have to sieve it through a horizontal tree cut again. All not nice. We better get it straight and assign it to the global sieve list right from the start.</p>
<p>The need for special care becomes apparent once we take into account which cell triggers the touchVertexLastTime(): Should it be a cell above the two fine grid vertices of interest, we would always associate the particle to the global sieve set, as we spot the multilevel transition. If it is called from one of the two adjacent cells below, the parent cell is local and we cannot spot the tree cut.</p>
<p>Originally, I thought we could get away with an analysis of the coarse vertex and use <a class="el" href="#a9a5760759e013b208463c1ab5cadb0f1">particleAssignedToVertexWillBeLocal()</a> to figure out whether we lift thorough a tree cut or not. However, we do not have the marker of the coarse grid vertices. So we cannot access the information we'd need. So the only thing that we can do is to lift if and only if we lift within the coarse cell and therefore can be sure that our analysis of the parent cell's owner provides sufficient information.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#ae9c85bca69dc0117fa89c6e95c617c9d">toolbox::particles::internal::relativeReleaseOwnershipSpatialSortingTolerance()</a> </dd></dl>

<p class="reference">Referenced by <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00092">dropParticle()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00073">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex01()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00170">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex02()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03()</a>, and <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00343">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex04()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_aca8ad847edf923b82ac67aed84f87872_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_aca8ad847edf923b82ac67aed84f87872_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_aca8ad847edf923b82ac67aed84f87872_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_aca8ad847edf923b82ac67aed84f87872_icgraph">
<area shape="rect" title="Take particle from current vertex and lift it or keep it local." alt="" coords="320,170,516,225"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a882c7e1446d4cb2eedcb4084b1a02185" title="Alternative version of dropParticle() without templates." alt="" coords="71,5,206,45"/>
<area shape="poly" title=" " alt="" coords="385,161,335,108,304,82,271,60,239,46,206,37,207,32,241,41,273,55,307,77,339,104,389,157"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#af9034a229caf9c65da1753928150e8ba" title="Test the instructions indicatring whether to lift a particle." alt="" coords="5,69,272,139"/>
<area shape="poly" title=" " alt="" coords="322,168,242,141,244,136,324,163"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#a948cbb444f1de74b3054bc5480b9a6d7" title=" " alt="" coords="5,163,272,232"/>
<area shape="poly" title=" " alt="" coords="306,200,272,200,272,195,306,195"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#ab16bdd50cac983f6d181cacd6899120f" title=" " alt="" coords="5,256,272,325"/>
<area shape="poly" title=" " alt="" coords="324,232,244,259,242,253,322,227"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#af13cf37baca8e2566652e7c98dcf7459" title=" " alt="" coords="5,349,272,419"/>
<area shape="poly" title=" " alt="" coords="387,238,337,290,306,316,273,340,251,352,249,347,271,335,303,312,333,286,383,234"/>
</map>
</div>

</div>
</div>
<a id="a27a33db3cfffb9c89a48754bd0bd48e0" name="a27a33db3cfffb9c89a48754bd0bd48e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27a33db3cfffb9c89a48754bd0bd48e0">&#9670;&#160;</a></span>mirrorParticleAlongPeriodicDomains()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; toolbox::particles::mirrorParticleAlongPeriodicDomains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>domainOffset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>domainSize</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt;</td>          <td class="paramname"><span class="paramname"><em>periodicBC</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mirror a particle along the periodic domain boundaries. </p>
<p>We check for every boundary whether it is periodic. Furthermore, we check whether the particle would be already contained within a vertex along each dimension. This is necessary for vertices in corners of the domain: In these cases, we need to mirror the particle only along the boundary that isn't contained in the vertex. Otherwise, the particle is displaced too far away. E.g. For a vertex at (0, 0) a particle at (0.95, 0.) would be displaced to (-0.05, -1.) instead of (-0.5, 0.).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Position of the particle as received along a periodic boundary exchange. </td></tr>
    <tr><td class="paramname">marker</td><td>Marker of vertex which triggers the receive, i.e. the one to which the incoming particle at x will be attached to.</td></tr>
    <tr><td class="paramname">Position</td><td>of particle as "seen" from receiving side </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d22/particles_8cpp_source.html#l00014">14</a> of file <a class="el" href="../../dc/d22/particles_8cpp_source.html">particles.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00038">tarch::la::greaterEquals()</a>, <a class="el" href="../../dd/dbf/benchmarks_2peano4_2grid_2main_8cpp_source.html#l00019">periodicBC</a>, and <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00056">tarch::la::smallerEquals()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a27a33db3cfffb9c89a48754bd0bd48e0_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a27a33db3cfffb9c89a48754bd0bd48e0_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a27a33db3cfffb9c89a48754bd0bd48e0_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a27a33db3cfffb9c89a48754bd0bd48e0_cgraph">
<area shape="rect" title="Mirror a particle along the periodic domain boundaries." alt="" coords="5,16,212,71"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="261,5,434,31"/>
<area shape="poly" title=" " alt="" coords="212,30,247,26,247,31,212,35"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="260,55,435,80"/>
<area shape="poly" title=" " alt="" coords="212,51,247,55,246,60,212,56"/>
</map>
</div>

</div>
</div>
<a id="a9a5760759e013b208463c1ab5cadb0f1" name="a9a5760759e013b208463c1ab5cadb0f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a5760759e013b208463c1ab5cadb0f1">&#9670;&#160;</a></span>particleAssignedToVertexWillBeLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleAssignedToVertexWillBeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d22/particles_8cpp_source.html#l00006">6</a> of file <a class="el" href="../../dc/d22/particles_8cpp_source.html">particles.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00129">getAdjacentCellsOwningParticle()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dbc/SieveParticles_8cpph_source.html#l00209">toolbox::particles::SieveParticles&lt; T &gt;::getParticlesToBeSievedIntoVertex()</a>, <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00019">liftParticleAssociatedWithVertex()</a>, and <a class="el" href="../../d7/dee/tests_2TestHelpers_8cpp_source.html#l00016">toolbox::particles::tests::TestHelpers::testParticleAssignedToVertexWillBeLocal()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,200,110"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#accfeb35fd8694d1efddaf60c6795acd0" title="Find out which adjacent cell will hold a particle." alt="" coords="248,63,485,103"/>
<area shape="poly" title=" " alt="" coords="200,80,234,80,234,85,200,85"/>
<area shape="rect" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#aa95cd9a5ed79cb4935a878de1fa90fed" title="Is x contained within cell identified by marker object." alt="" coords="545,5,740,45"/>
<area shape="poly" title=" " alt="" coords="463,60,532,46,533,51,464,65"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="587,70,699,95"/>
<area shape="poly" title=" " alt="" coords="486,80,573,80,573,85,486,85"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="533,119,752,145"/>
<area shape="poly" title=" " alt="" coords="480,100,558,114,557,120,479,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a9a5760759e013b208463c1ab5cadb0f1_icgraph">
<area shape="rect" title=" " alt="" coords="272,84,467,139"/>
<area shape="rect" href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html#a61c379ee6f8b7f1e88e26650a864d1a4" title="Get particles that are to be sieved into one vertex." alt="" coords="12,5,217,60"/>
<area shape="poly" title=" " alt="" coords="267,82,203,63,205,58,268,77"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#af4558458059ca35853e539daab9a1497" title="Implementation of liftParticleAssociatedWithVertex() without the template." alt="" coords="17,84,213,139"/>
<area shape="poly" title=" " alt="" coords="258,114,213,114,213,109,258,109"/>
<area shape="rect" href="../../d5/d12/classtoolbox_1_1particles_1_1tests_1_1TestHelpers.html#ad2f05c2baa428e77be95f48fb63b5ecb" title="Test particleAssignedToVertexWillBeLocal()" alt="" coords="5,163,224,233"/>
<area shape="poly" title=" " alt="" coords="276,146,218,166,216,161,274,141"/>
</map>
</div>

</div>
</div>
<a id="a70e002bde7d928496eca999a6f686d23" name="a70e002bde7d928496eca999a6f686d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70e002bde7d928496eca999a6f686d23">&#9670;&#160;</a></span>particleIsDuplicate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Iterator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Iterator toolbox::particles::particleIsDuplicate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> typename Iterator::value_type &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Iterator</td>          <td class="paramname"><span class="paramname"><em>begin</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Iterator &amp;</td>          <td class="paramname"><span class="paramname"><em>end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if there's already a particle at p's position in the set. </p>
<p>As we return a non-const iterator, the operation may not be labelled as const. It is essential</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particle</td><td>You want to search the container identified by begin and end for this particle. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>container's end() if there is no duplicate. Otherwise, return iterator pointing to existing particle. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00011">11</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d5/db2/MatrixFreeMain_8template_8cpp.html#a5e0c560fe19fd1cf2f94b84de758afc3">_log</a>, <a class="el" href="../../d5/d0e/MatrixMatrixOperations_8cpph_source.html#l00100">tarch::la::equals()</a>, <a class="el" href="../../d1/d45/Log_8h_source.html#l00050">logDebug</a>, and <a class="el" href="../../d7/dd9/particles_8h_source.html#l00016">SpatialDuplicateTolerance</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a70e002bde7d928496eca999a6f686d23_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a70e002bde7d928496eca999a6f686d23_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a70e002bde7d928496eca999a6f686d23_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a70e002bde7d928496eca999a6f686d23_cgraph">
<area shape="rect" title="Check if there&#39;s already a particle at p&#39;s position in the set." alt="" coords="5,5,157,45"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#acc43ad318304ffefe5710bc3deec2800" title="Compares to matrices on equality by means of a numerical accuracy." alt="" coords="205,13,332,38"/>
<area shape="poly" title=" " alt="" coords="158,23,192,23,192,28,158,28"/>
</map>
</div>

</div>
</div>
<a id="a01f95ecb24d8df40a2e3c6bb4b44bda4" name="a01f95ecb24d8df40a2e3c6bb4b44bda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01f95ecb24d8df40a2e3c6bb4b44bda4">&#9670;&#160;</a></span>particleWillBeDroppedFurther() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleWillBeDroppedFurther </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Will the particle be dropped further throughout the traversal. </p>
<p>The sorting in Peano usually realises pull semantics. That is, the fine grid vertex pulls particles down from coarser levels into its own domain. Particles recursively drop down the resolution cascade. Throughout the top-down tree traversal, it is often important to know if a particle will be pulled down further later on throughout the mesh traversal. This routine tells the user if this will happen. It is somehow the top-down counterpart of <a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle()</a> and <a class="el" href="#a87df833da9d9721541a2828f40b09162" title="A particle is to be sieved into a vertex if.">sieveParticle()</a>.</p>
<p>Consult <a class="el" href="../../d6/de2/page_toolbox_particles_mesh_traversal.html">the generic mesh traversal discussion</a> for some further "use cases" where this operation becomes absolutely mandatory.</p>
<h2><a class="anchor" id="autotoc_md285"></a>
Realisation</h2>
<p>There are two major checks which determine if a particle will be dropped further or not: The mesh size vs the cut-off radius of a particle, and the mesh cell state. If a mesh cell is not refined and will not be refined throughout this very traversal, then the particle will also not be dropped. It will however be dropped if it resides within a cell that's already refined or will be refined in this mesh sweep, and the cut-off radius will also fit into the next finer level.</p>
<p>A cell is refined or will be refined</p>
<ul>
<li>if <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#a30846dbaf2d83a2eb5eaef6335264ea8" title="Has the cell been refined when we kicked off this mesh traversal.">peano4::datamanagement::CellMarker::hasBeenRefined()</a> holds, as this means that this cell actually already has children; or</li>
<li>if <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#afc9d972d2b2b8dede1a14490d906bc72" title="Will the cell be refined in the subsequent iteration.">peano4::datamanagement::CellMarker::willBeRefined()</a> holds, as this means that this cell either has children already or will be added children in this very mesh sweep.</li>
</ul>
<p>We note that hasBeenRefined() can be wrong and willBeRefined() might hold. In this case, the new children in the tree are added in this very mesh traversal. It can also happen that hasBeenRefined() holds and willBeRefined() is wrong. In this case, this very mesh traversal will eliminate the children, i.e. coarsen. Nevertheless, the particles still are to be dropped into their respective mesh level - even though we might then lift them straightaway again as we coarsen.</p>
<h2><a class="anchor" id="autotoc_md286"></a>
Usage in combination with particle-particle interactions</h2>
<p>Deciding whether to update a particle within a mesh sweep that also introduces drops is delicate: Quickly, we run into situations where particles are updated multiple times. The documentation of <a class="el" href="../../db/de5/namespacepeano4_1_1toolbox_1_1particles_1_1api_1_1AbstractUpdateParticleGridAssociation.html">peano4.toolbox.particles.api.AbstractUpdateParticleGridAssociation</a> provides examples for this. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00030">30</a> of file <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html">MultiscaleTransitions.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00030">particleWillBeDroppedFurther()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00030">particleWillBeDroppedFurther()</a>, and <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00036">particleWillBeDroppedFurther()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_cgraph">
<area shape="rect" title="Will the particle be dropped further throughout the traversal." alt="" coords="5,29,228,69"/>
<area shape="poly" title=" " alt="" coords="75,30,73,20,79,10,94,5,117,3,143,6,157,13,154,18,141,11,117,8,95,10,83,15,78,21,80,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a01f95ecb24d8df40a2e3c6bb4b44bda4_icgraph">
<area shape="rect" title="Will the particle be dropped further throughout the traversal." alt="" coords="276,29,499,69"/>
<area shape="poly" title=" " alt="" coords="433,18,417,11,387,8,361,10,345,15,340,21,343,28,337,30,334,20,343,10,360,5,387,3,419,5,436,13"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#abc9e6042994f3591eca0d42418965fec" title="Will a particle be dropped further." alt="" coords="5,29,228,69"/>
<area shape="poly" title=" " alt="" coords="262,52,228,52,228,47,262,47"/>
</map>
</div>

</div>
</div>
<a id="abc9e6042994f3591eca0d42418965fec" name="abc9e6042994f3591eca0d42418965fec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc9e6042994f3591eca0d42418965fec">&#9670;&#160;</a></span>particleWillBeDroppedFurther() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleWillBeDroppedFurther </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Will a particle be dropped further. </p>
<p>A a first glance, this routine seems to be a replica of <a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle()</a>. However, this is not the case. <a class="el" href="#aba49c14d40f0e218fb5d1f95daeb65d6">dropParticle()</a> is asked from a child for a parent vertex if it shall drop a particle from the parent into this particular child vertex. This routine is called for a plain vertex without any multiscale relation and tells the callee if a vertex holding this particular particle will later on be stipped off the particle. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00036">36</a> of file <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html">MultiscaleTransitions.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00030">particleWillBeDroppedFurther()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_abc9e6042994f3591eca0d42418965fec_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_abc9e6042994f3591eca0d42418965fec_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_abc9e6042994f3591eca0d42418965fec_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_abc9e6042994f3591eca0d42418965fec_cgraph">
<area shape="rect" title="Will a particle be dropped further." alt="" coords="5,29,228,69"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a01f95ecb24d8df40a2e3c6bb4b44bda4" title="Will the particle be dropped further throughout the traversal." alt="" coords="276,29,499,69"/>
<area shape="poly" title=" " alt="" coords="228,47,262,47,262,52,228,52"/>
<area shape="poly" title=" " alt="" coords="337,30,334,20,343,10,360,5,387,3,419,5,436,13,433,18,417,11,387,8,361,10,345,15,340,21,343,28"/>
</map>
</div>

</div>
</div>
<a id="a2988ccd80bf237bd303e5eb86c34f2f6" name="a2988ccd80bf237bd303e5eb86c34f2f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2988ccd80bf237bd303e5eb86c34f2f6">&#9670;&#160;</a></span>particleWillBeDroppedFurther() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleWillBeDroppedFurther </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00119">119</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

</div>
</div>
<a id="a32b4a443a1d5b99e293eb8b5aa44181b" name="a32b4a443a1d5b99e293eb8b5aa44181b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b4a443a1d5b99e293eb8b5aa44181b">&#9670;&#160;</a></span>particleWillBeDroppedFurther() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleWillBeDroppedFurther </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00124">124</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

</div>
</div>
<a id="ae2a5d1708409c2375be02feb440adb54" name="ae2a5d1708409c2375be02feb440adb54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2a5d1708409c2375be02feb440adb54">&#9670;&#160;</a></span>particleWillStayWithinComputationalDomain()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::particleWillStayWithinComputationalDomain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>domainOffset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>domainWidth</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return true if and only if. </p>
<ul>
<li>we deal with a local particle (virtual ones are copies, to we are not really entitled to say something about them), and</li>
<li>the particle resides within the computational domain. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00028">28</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d3/db1/VectorScalarOperations_8cpph_source.html#l00279">tarch::la::allGreaterEquals()</a>, and <a class="el" href="../../d3/db1/VectorScalarOperations_8cpph_source.html#l00299">tarch::la::allSmallerEquals()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ae2a5d1708409c2375be02feb440adb54_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ae2a5d1708409c2375be02feb440adb54_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ae2a5d1708409c2375be02feb440adb54_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_ae2a5d1708409c2375be02feb440adb54_cgraph">
<area shape="rect" title="Return true if and only if." alt="" coords="5,16,276,71"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a1a6da58471823d62caa314a5d8c358af" title=" " alt="" coords="325,5,515,31"/>
<area shape="poly" title=" " alt="" coords="276,28,310,25,311,31,277,34"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#ac8ceaae1b1e7086fe40fd2d9144ec57b" title=" " alt="" coords="324,55,516,80"/>
<area shape="poly" title=" " alt="" coords="277,52,311,55,310,61,276,58"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="565,5,738,31"/>
<area shape="poly" title=" " alt="" coords="516,15,551,15,551,21,516,21"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a92121dc012abf37d9346be03fa866bbc" title=" " alt="" coords="564,55,739,80"/>
<area shape="poly" title=" " alt="" coords="516,65,550,65,550,70,516,70"/>
</map>
</div>

</div>
</div>
<a id="ac43a4a60f1417b13ccaf6b7a758078b2" name="ac43a4a60f1417b13ccaf6b7a758078b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac43a4a60f1417b13ccaf6b7a758078b2">&#9670;&#160;</a></span>relativeSpatialOwnershipTolerance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> toolbox::particles::relativeSpatialOwnershipTolerance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">::peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ownership tolerance. </p>
<p>A particle is "owned" by a cell (or vertex, respectively), if it resides within its area. However, we slightly augment this area, and this tolerance reflects the augmentation. It basically invokes <a class="el" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#ae9c85bca69dc0117fa89c6e95c617c9d">internal::relativeReleaseOwnershipSpatialSortingTolerance()</a> and multiply it with the numerical zero <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#a78bcae01889a108e6db2dbb6daae09c0">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00013">13</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>.</p>

</div>
</div>
<a id="a87df833da9d9721541a2828f40b09162" name="a87df833da9d9721541a2828f40b09162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87df833da9d9721541a2828f40b09162">&#9670;&#160;</a></span>sieveParticle() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::sieveParticle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A particle is to be sieved into a vertex if. </p>
<ul>
<li>this vertex is closer to the particle than half the mesh size of an adjacent mesh element, as we always store particles next to their closest vertex; AND</li>
<li>this vertex's search radius would not fit into the next finer mesh level OR there is no next finer mesh level; AND</li>
<li>the particle's search radius is not too big for the current mesh level.</li>
</ul>
<p>This routine does not check in any way if the particle will be local.</p>
<h2><a class="anchor" id="autotoc_md283"></a>
Rationale and usage</h2>
<p>I assume that the tree sieving particles removes a particle from the sieve set as soon as it is inserted into the domain. The association of particles to vertices is not unique. In line with this, the sieving is not unique either. So it is important that you remove the particle from the sieve set once it is inserted.</p>
<p>In theory, we could insert particles on the top level of a segment and then rely on the drops to move them down. This all works fine in a serial code. Once you parallelise, we however encounter an issue when particles drop through vertical tree cuts, i.e. if the fine grid child of a cell is remote. In this case, we might have inserted a particle into a rather coarse resolution level and rely on the drop. The remote child will insert the particle as well. The father will not be able to drop the particle all the way down into a remote tree.</p>
<p>When we sieve a particle into the next level, we have to find out to which particle we do so. To find this out, we run over the vertices as we encounter touchVertexFirstTime(). As particles are not uniquely assigned to cells or vertices, we have some flexibility here. There are two things to weight up:</p>
<ul>
<li>We have to ensure that the particles actually go down;</li>
<li>We have to ensure that we don't immediately lift the particle again.</li>
</ul>
<p>The latter property is essential: Usually, drops, sieves and lifts are done within one action set. However, we always need a second sweep after each lift. If the user runs two sweeps with the action set, the users relies upon the fact that all is sorted completely. If you lift again immediately due to an invalid drop, we mess up this logic. Therefore, it is important that this sorting tolerance is always smaller than the lift tolerance.</p>
<p>We always try to sieve a particle directly into the right level. Once more, it is absolutely essential that we don't sieve into a cell or vertex where we then have to lift stuff again.</p>
<p>Lifting will always be subject to a comparison similar to </p><pre class="fragment">  marker.h() &lt; 2.0 * particle.getSearchRadius()
</pre><p> This threshold is hard. However, we can sieve into a coarser level obviously to ensure that we don't violate it.</p>
<h2><a class="anchor" id="autotoc_md284"></a>
Optimisation</h2>
<p>I started off with this nice simple code</p>
<div class="fragment"><div class="line"> <span class="keyword">const</span> <span class="keywordtype">bool</span>   fitsIntoThisGridResolution      = <a class="code hl_function" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b">tarch::la::min</a>( marker.h() )     * MultilevelSortingTolerance *</div>
<div class="line">AsymmetricSortingDamping &gt;= 2.0 * particle.getSearchRadius(); <span class="keyword">const</span> <span class="keywordtype">bool</span>   fitsIntoNextFinerGridResolution =</div>
<div class="line"><a class="code hl_function" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b">tarch::la::min</a>( marker.h() )/3.0 &gt;  2.0 * particle.getSearchRadius();</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">return</span> marker.isContainedInAdjacentCells( particle.getX(), 0.5, relativeReleaseOwnershipSpatialSortingTolerance(marker) *</div>
<div class="line">AsymmetricSortingDamping * <a class="code hl_variable" href="../../d2/d45/namespacetarch_1_1la.html#a78bcae01889a108e6db2dbb6daae09c0">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>) and fitsIntoThisGridResolution and ( not</div>
<div class="line">fitsIntoNextFinerGridResolution or not marker.hasBeenRefined()</div>
<div class="line">    );</div>
<div class="ttc" id="anamespacetarch_1_1la_html_a78bcae01889a108e6db2dbb6daae09c0"><div class="ttname"><a href="../../d2/d45/namespacetarch_1_1la.html#a78bcae01889a108e6db2dbb6daae09c0">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a></div><div class="ttdeci">constexpr double NUMERICAL_ZERO_DIFFERENCE</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d10/Scalar_8h_source.html#l00017">Scalar.h:17</a></div></div>
<div class="ttc" id="anamespacetarch_1_1la_html_af593db8b0c3c24bfae8b1aaeeda9782b"><div class="ttname"><a href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b">tarch::la::min</a></div><div class="ttdeci">Scalar min(const Vector&lt; Size, Scalar &gt; &amp;vector)</div><div class="ttdoc">Returns the element with minimal value (NOT absolute value).</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d88/VectorOperations_8cpph_source.html#l00264">VectorOperations.cpph:264</a></div></div>
</div><!-- fragment --><p>However, it turns out a lot of runtime is spent in getSearchRadius(). It is not clear if the compiler manages to exploit the non-strict evaluation if we first define the two const bools. So I moved them now into the boolean expression, i.e. work without the explicit temporary variables.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a87df833da9d9721541a2828f40b09162" title="A particle is to be sieved into a vertex if.">sieveParticle()</a> </dd></dl>

<p class="reference">Referenced by <a class="el" href="../../df/dbc/SieveParticles_8cpph_source.html#l00209">toolbox::particles::SieveParticles&lt; T &gt;::getParticlesToBeSievedIntoVertex()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00343">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex04()</a>, and <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00018">toolbox::particles::tests::MultiscaleTransitionsTest::testSievePredicate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a87df833da9d9721541a2828f40b09162_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a87df833da9d9721541a2828f40b09162_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a87df833da9d9721541a2828f40b09162_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a87df833da9d9721541a2828f40b09162_icgraph">
<area shape="rect" title="A particle is to be sieved into a vertex if." alt="" coords="320,146,455,186"/>
<area shape="rect" href="../../dd/d6b/classtoolbox_1_1particles_1_1SieveParticles.html#a61c379ee6f8b7f1e88e26650a864d1a4" title="Get particles that are to be sieved into one vertex." alt="" coords="36,5,241,60"/>
<area shape="poly" title=" " alt="" coords="355,138,316,105,271,75,240,61,243,56,273,70,320,101,358,134"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#ab16bdd50cac983f6d181cacd6899120f" title=" " alt="" coords="5,85,272,154"/>
<area shape="poly" title=" " alt="" coords="306,153,272,147,273,142,307,148"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#af13cf37baca8e2566652e7c98dcf7459" title=" " alt="" coords="5,178,272,247"/>
<area shape="poly" title=" " alt="" coords="307,184,273,190,272,185,306,179"/>
<area shape="rect" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html#ab3c4fb97761cb42f78a10ec0216deb80" title="Test setup from the Swift test case:" alt="" coords="35,272,242,327"/>
<area shape="poly" title=" " alt="" coords="358,198,320,231,273,262,243,275,241,270,271,257,316,227,355,194"/>
</map>
</div>

</div>
</div>
<a id="a4172f19e8257217f4fb04665c58ae529" name="a4172f19e8257217f4fb04665c58ae529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4172f19e8257217f4fb04665c58ae529">&#9670;&#160;</a></span>sieveParticle() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a> toolbox::particles::sieveParticle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>searchRadius</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00107">107</a> of file <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html">MultiscaleTransitions.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>.</p>

</div>
</div>
<a id="abb77f60ea4069f4895c301af3db1c390" name="abb77f60ea4069f4895c301af3db1c390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb77f60ea4069f4895c301af3db1c390">&#9670;&#160;</a></span>staticPosition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::staticPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a></td>          <td class="paramname"><span class="paramname"><em>timeStepSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Leave the tracer particles where they are. </p>
<p>Essentially, this is a complicated way to write down a `&lsquo;not an operation&rsquo;' (nope). The routine simply does nothing with the particle passed. </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d62/toolbox_2particles_2Tracer_8h_source.html#l00020">20</a> of file <a class="el" href="../../d6/d62/toolbox_2particles_2Tracer_8h_source.html">Tracer.h</a>.</p>

</div>
</div>
<a id="a696ec1f344752aebc1eae15b646a7ad0" name="a696ec1f344752aebc1eae15b646a7ad0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a696ec1f344752aebc1eae15b646a7ad0">&#9670;&#160;</a></span>updateContainedInAdjacentCellProperty() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::updateContainedInAdjacentCellProperty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html">peano4::datamanagement::CellMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::bitset&lt; Dimensions &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>assignedVertex</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update helper flag per particle for cell. </p>
<p>Each particle is associated with a vertex of a cell. This vertex is identified by assignedVertex. We now compute a bitset that tells us, from the vertex' point of view, which of the adjacent cells will host this particle. This might not be unique, as we work with a fuzzy geometric ownership.</p>
<dl class="section see"><dt>See also</dt><dd>the explanation in Particle.py </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00051">51</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18">tarch::la::multiplyComponents()</a>, and <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00051">updateContainedInAdjacentCellProperty()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00093">insertParticleIntoCell()</a>, <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00051">updateContainedInAdjacentCellProperty()</a>, and <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00063">updateContainedInAdjacentCellProperty()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_cgraph">
<area shape="rect" title="Update helper flag per particle for cell." alt="" coords="5,29,216,84"/>
<area shape="poly" title=" " alt="" coords="60,29,60,19,69,10,86,5,111,3,140,6,157,14,154,18,139,11,111,8,87,10,72,15,65,21,65,29"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="264,44,483,69"/>
<area shape="poly" title=" " alt="" coords="216,54,251,54,251,59,216,59"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_icgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_icgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_icgraph" id="ad0/d29/namespacetoolbox_1_1particles_a696ec1f344752aebc1eae15b646a7ad0_icgraph">
<area shape="rect" title="Update helper flag per particle for cell." alt="" coords="484,34,695,89"/>
<area shape="poly" title=" " alt="" coords="633,23,617,16,589,13,566,15,551,19,544,26,544,34,539,34,539,24,548,15,565,9,589,7,618,10,635,18"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a593ad6871d8a624f665e22cb5cfc0ea8" title="Insert particle into cell." alt="" coords="248,5,413,45"/>
<area shape="poly" title=" " alt="" coords="470,47,413,39,414,34,471,42"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#ab1c1930b6516475ba08fffd651f85fa0" title=" " alt="" coords="225,70,436,125"/>
<area shape="poly" title=" " alt="" coords="471,81,436,85,436,80,470,75"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aac52ee0c1974b7572d5207688f371946" title="Insert particle into a cell." alt="" coords="5,5,177,45"/>
<area shape="poly" title=" " alt="" coords="234,28,177,28,177,23,234,23"/>
</map>
</div>

</div>
</div>
<a id="ab1c1930b6516475ba08fffd651f85fa0" name="ab1c1930b6516475ba08fffd651f85fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c1930b6516475ba08fffd651f85fa0">&#9670;&#160;</a></span>updateContainedInAdjacentCellProperty() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::updateContainedInAdjacentCellProperty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../dd/dc6/structpeano4_1_1datamanagement_1_1VertexMarker.html">peano4::datamanagement::VertexMarker</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>marker</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00063">63</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00051">updateContainedInAdjacentCellProperty()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ab1c1930b6516475ba08fffd651f85fa0_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ab1c1930b6516475ba08fffd651f85fa0_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ab1c1930b6516475ba08fffd651f85fa0_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_ab1c1930b6516475ba08fffd651f85fa0_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,216,84"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a696ec1f344752aebc1eae15b646a7ad0" title="Update helper flag per particle for cell." alt="" coords="264,29,475,84"/>
<area shape="poly" title=" " alt="" coords="216,54,251,54,251,59,216,59"/>
<area shape="poly" title=" " alt="" coords="319,29,319,19,328,10,345,5,369,3,398,6,415,14,413,18,397,11,369,8,346,10,331,15,324,21,324,29"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="523,44,741,69"/>
<area shape="poly" title=" " alt="" coords="475,54,509,54,509,59,475,59"/>
</map>
</div>

</div>
</div>
<a id="ace5053e90a4ccbddd2732cd8cd8af658" name="ace5053e90a4ccbddd2732cd8cd8af658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace5053e90a4ccbddd2732cd8cd8af658">&#9670;&#160;</a></span>updateContainedInAdjacentCellProperty() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Particle &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::updateContainedInAdjacentCellProperty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>x</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> <a class="el" href="../../d7/d26/structtarch_1_1la_1_1Vector.html">tarch::la::Vector</a>&lt; Dimensions, <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>h</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Particle &amp;</td>          <td class="paramname"><span class="paramname"><em>particle</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update internal marker of particle. </p>
<p>Each particle is associated to a vertex. The vertex is identified by its position x and the surrounding cells with size h. Each vertex has \( 2^d \) adjacent cells. The particle's ContainedInAdjacentCellProperty bitset flags which of these adjacent cells consider the particle to fall in their area.</p>
<p>As we work with a weak ownership, there can be more than two bits (if the particle sits exactly on the face between two adjacent cells).</p>
<h2><a class="anchor" id="autotoc_md290"></a>
Particle movement</h2>
<p>We have to call <a class="el" href="#a696ec1f344752aebc1eae15b646a7ad0" title="Update helper flag per particle for cell.">updateContainedInAdjacentCellProperty()</a> after each particle movement. Even if we don't change the vertex association as a particle drifts, it might stay with the same vertex and still move from one cell into another one and hence require an update of the flags.</p>
<dl class="section see"><dt>See also</dt><dd>the explanation in toolbox.particles.Particle </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00071">71</a> of file <a class="el" href="../../d7/dfd/particles_8cpph_source.html">particles.cpph</a>.</p>

<p class="reference">References <a class="el" href="../../db/d9e/Loop_8h_source.html#l00086">dfor2</a>, <a class="el" href="../../db/d9e/Loop_8h_source.html#l00117">enddforx</a>, <a class="el" href="../../db/d7c/CellMarker_8cpp_source.html#l00045">peano4::datamanagement::CellMarker::isContained()</a>, <a class="el" href="../../d0/deb/Scalar_8cpp_source.html#l00008">tarch::la::max()</a>, <a class="el" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18">tarch::la::multiplyComponents()</a>, <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>, and <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00023">toolbox::particles::internal::relativeGrabOwnershipSpatialSortingTolerance()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d29/namespacetoolbox_1_1particles_ace5053e90a4ccbddd2732cd8cd8af658_cgraph.png" border="0" usemap="#ad0/d29/namespacetoolbox_1_1particles_ace5053e90a4ccbddd2732cd8cd8af658_cgraph" alt=""/></div>
<map name="ad0/d29/namespacetoolbox_1_1particles_ace5053e90a4ccbddd2732cd8cd8af658_cgraph" id="ad0/d29/namespacetoolbox_1_1particles_ace5053e90a4ccbddd2732cd8cd8af658_cgraph">
<area shape="rect" title="Update internal marker of particle." alt="" coords="5,81,216,135"/>
<area shape="rect" href="../../dc/d59/structpeano4_1_1datamanagement_1_1CellMarker.html#aa95cd9a5ed79cb4935a878de1fa90fed" title="Is x contained within cell identified by marker object." alt="" coords="286,5,481,45"/>
<area shape="poly" title=" " alt="" coords="191,78,263,55,292,46,293,52,265,60,192,83"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a9ab5aa4e4252e6d78ba62df6a711c47a" title="I need the maximum of three values all the time, to I decided to write a function for this." alt="" coords="327,70,439,95"/>
<area shape="poly" title=" " alt="" coords="216,96,313,86,314,92,216,101"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#adca36f9134d5ca53daa05b82d9a1ce18" title=" " alt="" coords="274,119,493,145"/>
<area shape="poly" title=" " alt="" coords="216,115,260,119,260,124,216,120"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#a4fa20e3efb2e06ead5e27709f8194476" title=" " alt="" coords="264,193,503,247"/>
<area shape="poly" title=" " alt="" coords="179,133,304,185,302,190,177,138"/>
<area shape="poly" title=" " alt="" coords="331,193,331,182,340,174,358,168,383,166,414,169,431,177,429,182,413,174,383,171,359,173,343,178,336,185,336,193"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="adb9faad12774af486a9ea1353a19c2ee" name="adb9faad12774af486a9ea1353a19c2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9faad12774af486a9ea1353a19c2ee">&#9670;&#160;</a></span>GrabOwnershipSpatialSortingTolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> toolbox::particles::GrabOwnershipSpatialSortingTolerance = 1.001</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section see"><dt>See also</dt><dd>SpatialReassignmentTolerance </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dde/internal_8h_source.html#l00063">63</a> of file <a class="el" href="../../db/dde/internal_8h_source.html">internal.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00033">toolbox::particles::internal::relativeGrabOwnershipSpatialSortingTolerance()</a>.</p>

</div>
</div>
<a id="af9c5a5545943f3a19f8565724cfbb992" name="af9c5a5545943f3a19f8565724cfbb992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9c5a5545943f3a19f8565724cfbb992">&#9670;&#160;</a></span>ParticleReassociationInstruction_Keep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> toolbox::particles::ParticleReassociationInstruction_Keep = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00017">17</a> of file <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html">MultiscaleTransitions.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00051">getParticleReassociationInstructionWithinCellWithIntraCellReassignment()</a>, <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00019">liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00073">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex01()</a>, and <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03()</a>.</p>

</div>
</div>
<a id="a0435c43e782c1a0bf5dd4882d5212d04" name="a0435c43e782c1a0bf5dd4882d5212d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0435c43e782c1a0bf5dd4882d5212d04">&#9670;&#160;</a></span>ParticleReassociationInstruction_SieveGlobally</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a> toolbox::particles::ParticleReassociationInstruction_SieveGlobally = -2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">18</a> of file <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html">MultiscaleTransitions.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00092">dropParticle()</a>, <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00051">getParticleReassociationInstructionWithinCellWithIntraCellReassignment()</a>, <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00019">liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03()</a>, and <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00343">toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex04()</a>.</p>

</div>
</div>
<a id="acf81b96409bec4ab025251d611201785" name="acf81b96409bec4ab025251d611201785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf81b96409bec4ab025251d611201785">&#9670;&#160;</a></span>ReleaseOwnershipSpatialSortingTolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> toolbox::particles::ReleaseOwnershipSpatialSortingTolerance = 1.01</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sorting tolerance. </p>
<p>As the particle association is not unique and not sharp, as we work with floating point numbers. The correlation</p>
<p>\( centre_{left} + h/2 &lt; centre_{right} - h/2 \)</p>
<p>might not hold for two neighbouring voxels, i.e. there might be a floating-point gap in-between two voxels. If particles fall into this gap, they would not belong to any voxel. We therefore give each voxel a small overlap. The relative size of this overlap is quantified by ReleaseOwnershipSpatialSortingTolerance. This is out first principle: particles are always assigned to a cell/volume relative to a relative threshold. We issue a resort if and only if the particle is outside of its respective control volume subject to the additional tolerance. If a particle leaves a cell or-vertex environment subject to the ReleaseOwnershipSpatialSortingTolerance, we either assign it to a neighbouring voxel or lift it into a coarser level or assign it to a global sorting list.</p>
<p>There is a second threshold: Our sorting should be idempotent. That is, once we assign a particle to a vertex or cell, we should not immediately require yet another resorting step. Two rules formalise this:</p>
<ol type="1">
<li>If a vertex releases a stationary particle, it will never grab it back.</li>
<li>If a vertex grabs a stationary particle, it will never release it.</li>
</ol>
<p>The two principles imply that we work with two thresholds: We trigger a resort if a particle leaves its control volume. The region in which we grab a particle however is slightly smaller. We work with two thresholds, which all span areas which are slighter than the control volumes. However, releases are way more conservative/careful than grabs or drops.</p>
<h2><a class="anchor" id="autotoc_md277"></a>
Related action sets</h2>
<p>The action set <a class="el" href="../../dc/d4c/namespacepeano4_1_1toolbox_1_1particles_1_1api_1_1UpdateParallelState.html">peano4.toolbox.particles.api.UpdateParallelState</a> employs the threshold to decide if a particle is local or not. It has to use the most generic environment, i.e. the release radius.</p>
<dl class="section see"><dt>See also</dt><dd>AsymmetricSortingDamping </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/dde/internal_8h_source.html#l00058">58</a> of file <a class="el" href="../../db/dde/internal_8h_source.html">internal.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d93/MultiscaleTransitions_8cpp_source.html#l00051">getParticleReassociationInstructionWithinCellWithIntraCellReassignment()</a>, and <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00018">toolbox::particles::internal::relativeReleaseOwnershipSpatialSortingTolerance()</a>.</p>

</div>
</div>
<a id="a2f330e2aca3719717d69e968dec69e4e" name="a2f330e2aca3719717d69e968dec69e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f330e2aca3719717d69e968dec69e4e">&#9670;&#160;</a></span>SpatialDuplicateTolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="../../db/d20/DiscontinuousGalerkinDiscretisation_8Abstract_8template_8cpp.html#a962c06c0fea2c76dd28c454654a79417">double</a> toolbox::particles::SpatialDuplicateTolerance = 1e-6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default tolerance to decide when two particles are the same. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a70e002bde7d928496eca999a6f686d23" title="Check if there&#39;s already a particle at p&#39;s position in the set.">toolbox::particles::particleIsDuplicate()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/dd9/particles_8h_source.html#l00016">16</a> of file <a class="el" href="../../d7/dd9/particles_8h_source.html">particles.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dfd/particles_8cpph_source.html#l00012">particleIsDuplicate()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/dd9/namespacetoolbox.html">toolbox</a></li><li class="navelem"><a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html">particles</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:31:08 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
