<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d0/d10/page_tutorials_exahype2_symhype_swe.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The Shallow Water Equation (SWE)</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md597">Two-dimensional Shallow Water Equations</a><ul><li class="level2"><a href="#autotoc_md598">Initial Conditions</a></li>
<li class="level2"><a href="#autotoc_md599">Boundary Conditions</a></li>
<li class="level2"><a href="#autotoc_md600">Eigenvalues</a></li>
<li class="level2"><a href="#autotoc_md601">Flux</a></li>
<li class="level2"><a href="#autotoc_md602">Non-conservative Term</a></li>
<li class="level2"><a href="#autotoc_md603">Result</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md604">Increasing Resolution</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md597"></a>
Two-dimensional Shallow Water Equations</h1>
<p>The shallow water equations describe the flow of fluid given the assumption that the horizontal length scale is much higher than the vertical length scale and are defined by the following formula:</p>
<p>\(
    \frac{\partial}{\partial t}\left(
    \begin{array}{lr} h \\
        h u_1 \\
        h u_2 \\
        b
        \end{array} \right) +
    \nabla \begin{pmatrix}
        h u_1           &amp; h u_2     \\
        h u_1^2         &amp; h u_1 u_2 \\
        h u_2 u_1       &amp; h u_2^2   \\
        0               &amp; 0
    \end{pmatrix} +
    \begin{pmatrix}
        0                     &amp; 0\\
        h g*\partial_x(b+h)   &amp; 0\\
        0                     &amp; h g*\partial_y(b+h) \\
        0                     &amp; 0
    \end{pmatrix}  = \vec{0}
\)</p>
<p>With eigenvalues:</p>
<p>\(
    \left(
    \begin{array}{lr}
        \lambda_1 \\
        \lambda_2 \\
        \lambda_3
    \end{array} \right) =
    \left(
    \begin{array}{lr}
        u + \sqrt{g (h+b)} \\
        u \\
        u - \sqrt{g (h+b)} \\
    \end{array} \right)
\)</p>
<p>These depend on the fluid height h, velocities in x- and y-directions, the bathymetry b (the height of the floor underneath the fluid) and the gravity g.</p>
<p>To implement this equation, the following things are needed: the initial condition, the boundary conditions, the maximal eigenvalue, the flux, the non-conservative term and (optionally) the refinement criterion.</p>
<p>We also have an auxiliary variable since the bathymetry never changes. We can define this auxiliary variable by setting the parameter for the auxiliary variables in the solver to 1. These auxiliary variables are accessed in the same way as the regular variables, except that they are not modified by the solver. Initial- and boundary conditions for these auxiliary variables should be defined, but no flux or non-conservative product can be set, as they can never change anyway.</p>
<h2><a class="anchor" id="autotoc_md598"></a>
Initial Conditions</h2>
<p>We start with the initial conditions: For this, we want the initial water height to be 1.0 everywhere, the initial velocities to be 0.0 everywhere and the bathymetry should be 0.0 in a radius of 0.40 around the center of the domain, 0.1 anywhere else.</p>
<h2><a class="anchor" id="autotoc_md599"></a>
Boundary Conditions</h2>
<p>Then we can define our boundary conditions. For this simple case, we will simply use reflecting boundary conditions. This means all values except the momenta will be the same outside of the as inside of it.</p>
<h2><a class="anchor" id="autotoc_md600"></a>
Eigenvalues</h2>
<p>Next, we can define the eigenvalues of our system. This is important because the largest eigenvalue defines the behaviour of the <a class="el" href="../../da/db8/namespacePDE.html">PDE</a>, and among others the maximum allowable timestep for which the solver remains stable. Since the maximal eigenvalue is dependent on the velocity, you will need to take into account the normal direction as this will determine whether you should use the velocity in the x- or y-direction to compute it. For the gravity g, you can use 9.81 m/s^2.</p>
<h2><a class="anchor" id="autotoc_md601"></a>
Flux</h2>
<p>Now, let's define our flux in x- and y-direction. The directions of the flux are defined by the normal parameter. This parameter defines through which surface, and therefore in which direction, the flux is being computed. Here if the normal is 0, we are computing the flux in x-direction and if the normal is 1, we are computing the flux in y-direction. For higher dimensions, there would logically be additional directions to implement the flux.</p>
<h2><a class="anchor" id="autotoc_md602"></a>
Non-conservative Term</h2>
<p>Finally, we fill in the non-conservative part in the function nonconservativeProduct. This needs to go into the variable BTimesDeltaQ. This function has a parameter deltaQ through which you can access the space derivatives of the unknowns and auxiliary variables in the direction defined by the normal's current value.</p>
<h2><a class="anchor" id="autotoc_md603"></a>
Result</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">t=0.0 s   </th><th class="markdownTableHeadCenter">t=1.0 s    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><p class="starttd"><img src="../../SWE_start.png" alt="" class="inline"/>    </p>
<p class="endtd"></p>
</td><td class="markdownTableBodyCenter"><p class="starttd"><img src="../../SWE_end.png" alt="" class="inline"/>    </p>
<p class="endtd"></p>
</td></tr>
</table>
<p>The computed height of the fluid according to our computation of the shallow water equations at times t=0.0 s and t=1.0 s. The fluid has rushed in from the sides to fill the depression at the center.</p>
<h1><a class="anchor" id="autotoc_md604"></a>
Increasing Resolution</h1>
<p>If you've completed the implementation, you may have noticed that the resolution is somewhat low. We're interested in increasing the resolution so we can see more details in the solution. This means we need to consider our volume size, so in the first step, we will discuss how the volume size is calculated.</p>
<p>This determines the maximal allowable size for volumes in our domain, in essence guaranteeing \( max\_volume\_h &gt; volume\_size \). However, since Peano is based upon three-partitioning, it refines the domain into \( 3^d \) volumes, where d is the smallest possible integer that satisfies \( max\_volume\_h &gt; domain\_size / 3^d \). For our tutorial, we have set a domain size of 2.0 in each direction and \( max\_volume\_h = 0.05 \). The first three-partition of 2.0 that is lower than 0.05 is \( \frac{2.0}{3^4}\approx0.0247 \). This means that there are a total of 3^4=81 volumes in each dimension. Of these, two are used for the boundary conditions, which means there are a total of 79 volumes per dimension inside the domain. In total, that makes 79*79=6241 volumes inside the domain, or (with a parameter \( max\_volume\_h = 0.02 \)) 241*241=58081 volumes in two dimensions, an increase of factor 9. However, because the smallest admissible timesteps are proportional to the size of the mesh, the overall computational effort increases by a total factor of about 27.</p>
<p>In short, if one wishes to increase or decrease the mesh size, one can just modify the parameter \( max\_volume\_h \), but one should be aware that this comes at a significant cost. You may have noticed that there is a second parameter \( min\_volume\_h \) however, and this parameter logically determines the minimal mesh size. If this parameter is given a value lower or equal to \( max\_volume\_h / 3 \) (again, three-partitioning), adaptive refinement is switched on, this means the volume size need not be the same in the entire domain. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Peano</a></li><li class="navelem"><a class="el" href="../../d3/d82/page_exahype2_home.html">ExaHyPE 2</a></li><li class="navelem"><a class="el" href="../../d8/d60/page_exahype2_tutorials.html">Tutorials</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:28:59 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
