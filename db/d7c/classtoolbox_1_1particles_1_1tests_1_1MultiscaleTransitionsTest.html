<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="icon" href="../../Peano-icon.png" type="image/x-icon" />
<title>Peano</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="../../doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="../../toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="../../custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!-- https://bryce.io/gitlab-corners/ -->
<style>.gitlab-corner-wrapper{overflow:hidden;width:100px;height:100px;position:absolute;top:0;right:0}.gitlab-corner{position:absolute;top:-16px;right:-50px;transform:rotate(45deg);background:#333;border:44px solid #333;border-bottom:none;border-top:#333 solid 16px}.gitlab-corner svg{width:60px;height:60px;margin-bottom:-4px}.cls-1{fill:#fc6d26}.cls-2{fill:#e24329}.cls-3{fill:#fca326}.gitlab-corner:hover .cls-1{animation:cycle .6s}.gitlab-corner:hover .cls-2{animation:cycleMid .6s}.gitlab-corner:hover .cls-3{animation:cycleEnd .6s}@keyframes cycle{100%,15%,60%{fill:#fc6d26}30%,75%{fill:#e24329}45%,90%{fill:#fca326}}@keyframes cycleMid{100%,15%,60%{fill:#e24329}30%,75%{fill:#fca326}45%,90%{fill:#fc6d26}}@keyframes cycleEnd{100%,15%,60%{fill:#fca326}30%,75%{fill:#fc6d26}45%,90%{fill:#e24329}}@media (max-width:500px){.gitlab-corner:hover .cls-1,.gitlab-corner:hover .cls-2,.gitlab-corner:hover .cls-3{animation:none}.gitlab-corner .cls-1{animation:cycle .6s}.gitlab-corner .cls-2{animation:cycleMid .6s}.gitlab-corner .cls-3{animation:cycleEnd .6s}}</style><div class="gitlab-corner-wrapper"><a href="https://gitlab.lrz.de/hpcsoftware/Peano" class="gitlab-corner" aria-label="View source on GitLab"><svg id="logo_art" data-name="logo art" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 586 559"><g id="g44"><path id="path46" class="cls-1" d="M461.17,301.83l-18.91-58.12L404.84,128.43a6.47,6.47,0,0,0-12.27,0L355.15,243.64H230.82L193.4,128.43a6.46,6.46,0,0,0-12.26,0L143.78,243.64l-18.91,58.19a12.88,12.88,0,0,0,4.66,14.39L293,435,456.44,316.22a12.9,12.9,0,0,0,4.73-14.39"/></g><g id="g48"><path id="path50" class="cls-2" d="M293,434.91h0l62.16-191.28H230.87L293,434.91Z"/></g><g id="g56"><path id="path58" class="cls-1" d="M293,434.91,230.82,243.63h-87L293,434.91Z"/></g><g id="g64"><path id="path66" class="cls-3" d="M143.75,243.69h0l-18.91,58.12a12.88,12.88,0,0,0,4.66,14.39L293,435,143.75,243.69Z"/></g><g id="g72"><path id="path74" class="cls-2" d="M143.78,243.69h87.11L193.4,128.49a6.47,6.47,0,0,0-12.27,0l-37.35,115.2Z"/></g><g id="g76"><path id="path78" class="cls-1" d="M293,434.91l62.16-191.28H442.3L293,434.91Z"/></g><g id="g80"><path id="path82" class="cls-3" d="M442.24,243.69h0l18.91,58.12a12.85,12.85,0,0,1-4.66,14.39L293,434.91l149.2-191.22Z"/></g><g id="g84"><path id="path86" class="cls-2" d="M442.28,243.69h-87.1l37.42-115.2a6.46,6.46,0,0,1,12.26,0l37.42,115.2Z"/></g></svg></a></div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Peano-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Peano
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a>  </div>
  <div class="headertitle"><div class="title">toolbox::particles::tests::MultiscaleTransitionsTest Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html">MultiscaleTransitionsTest.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for toolbox::particles::tests::MultiscaleTransitionsTest:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/ddd/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest__inherit__graph.png" border="0" usemap="#atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_inherit__map" alt="Inheritance graph"/></div>
<map name="atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_inherit__map" id="atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_inherit__map">
<area shape="rect" title=" " alt="" coords="5,79,239,119"/>
<area shape="rect" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html" title="Represents one test case." alt="" coords="41,5,203,31"/>
<area shape="poly" title=" " alt="" coords="125,44,125,79,119,79,119,44"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for toolbox::particles::tests::MultiscaleTransitionsTest:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dc2/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest__coll__graph.png" border="0" usemap="#atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_coll__map" alt="Collaboration graph"/></div>
<map name="atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_coll__map" id="atoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_coll__map">
<area shape="rect" title=" " alt="" coords="56,271,289,311"/>
<area shape="rect" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html" title="Represents one test case." alt="" coords="5,183,167,208"/>
<area shape="poly" title=" " alt="" coords="108,216,157,269,153,272,104,220"/>
<area shape="rect" title=" " alt="" coords="131,95,217,120"/>
<area shape="poly" title=" " alt="" coords="139,129,117,146,103,165,93,184,88,181,98,162,113,142,136,125"/>
<area shape="rect" href="../../da/d79/classtarch_1_1logging_1_1Log.html" title="Log Device." alt="" coords="191,183,333,208"/>
<area shape="poly" title=" " alt="" coords="205,126,225,142,257,181,252,184,221,146,202,130"/>
<area shape="rect" title=" " alt="" coords="105,5,243,45"/>
<area shape="poly" title=" " alt="" coords="177,59,177,94,171,94,171,59"/>
<area shape="poly" title=" " alt="" coords="243,220,193,272,189,269,240,216"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a10d988edff1748d47991c79b1cae7525" id="r_a10d988edff1748d47991c79b1cae7525"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a10d988edff1748d47991c79b1cae7525">MultiscaleTransitionsTest</a> ()</td></tr>
<tr class="separator:a10d988edff1748d47991c79b1cae7525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb521d4e94c8e2ee8223b589a405d2d" id="r_a6bb521d4e94c8e2ee8223b589a405d2d"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6bb521d4e94c8e2ee8223b589a405d2d">run</a> () override</td></tr>
<tr class="memdesc:a6bb521d4e94c8e2ee8223b589a405d2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine is triggered by the TestCaseCollection.  <br /></td></tr>
<tr class="separator:a6bb521d4e94c8e2ee8223b589a405d2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classtarch_1_1tests_1_1TestCase"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classtarch_1_1tests_1_1TestCase')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html">tarch::tests::TestCase</a></td></tr>
<tr class="memitem:a0f4b1de752852aac3eb0e8c7f1cc04d5 inherit pub_methods_classtarch_1_1tests_1_1TestCase" id="r_a0f4b1de752852aac3eb0e8c7f1cc04d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a0f4b1de752852aac3eb0e8c7f1cc04d5">TestCase</a> (<a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::string &amp;testCaseName)</td></tr>
<tr class="memdesc:a0f4b1de752852aac3eb0e8c7f1cc04d5 inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a0f4b1de752852aac3eb0e8c7f1cc04d5 inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0491a7ab979e452aacaa8abd9ce55466 inherit pub_methods_classtarch_1_1tests_1_1TestCase" id="r_a0491a7ab979e452aacaa8abd9ce55466"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a0491a7ab979e452aacaa8abd9ce55466">~TestCase</a> ()</td></tr>
<tr class="memdesc:a0491a7ab979e452aacaa8abd9ce55466 inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a0491a7ab979e452aacaa8abd9ce55466 inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032d565b3670f9855380438add55dbfd inherit pub_methods_classtarch_1_1tests_1_1TestCase" id="r_a032d565b3670f9855380438add55dbfd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a032d565b3670f9855380438add55dbfd">getNumberOfErrors</a> () <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a></td></tr>
<tr class="separator:a032d565b3670f9855380438add55dbfd inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac816e9f7b8406f3e24ca61eb64d16d8c inherit pub_methods_classtarch_1_1tests_1_1TestCase" id="r_ac816e9f7b8406f3e24ca61eb64d16d8c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#ac816e9f7b8406f3e24ca61eb64d16d8c">getTestCaseName</a> () <a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a></td></tr>
<tr class="separator:ac816e9f7b8406f3e24ca61eb64d16d8c inherit pub_methods_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab3c4fb97761cb42f78a10ec0216deb80" id="r_ab3c4fb97761cb42f78a10ec0216deb80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3c4fb97761cb42f78a10ec0216deb80">testSievePredicate</a> ()</td></tr>
<tr class="memdesc:ab3c4fb97761cb42f78a10ec0216deb80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test setup from the Swift test case:  <br /></td></tr>
<tr class="separator:ab3c4fb97761cb42f78a10ec0216deb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9034a229caf9c65da1753928150e8ba" id="r_af9034a229caf9c65da1753928150e8ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9034a229caf9c65da1753928150e8ba">testLiftDropOfParticleAssociatedWithVertex01</a> ()</td></tr>
<tr class="memdesc:af9034a229caf9c65da1753928150e8ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the instructions indicatring whether to lift a particle.  <br /></td></tr>
<tr class="separator:af9034a229caf9c65da1753928150e8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a948cbb444f1de74b3054bc5480b9a6d7" id="r_a948cbb444f1de74b3054bc5480b9a6d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a948cbb444f1de74b3054bc5480b9a6d7">testLiftDropOfParticleAssociatedWithVertex02</a> ()</td></tr>
<tr class="separator:a948cbb444f1de74b3054bc5480b9a6d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16bdd50cac983f6d181cacd6899120f" id="r_ab16bdd50cac983f6d181cacd6899120f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab16bdd50cac983f6d181cacd6899120f">testLiftDropOfParticleAssociatedWithVertex03</a> ()</td></tr>
<tr class="separator:ab16bdd50cac983f6d181cacd6899120f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13cf37baca8e2566652e7c98dcf7459" id="r_af13cf37baca8e2566652e7c98dcf7459"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af13cf37baca8e2566652e7c98dcf7459">testLiftDropOfParticleAssociatedWithVertex04</a> ()</td></tr>
<tr class="separator:af13cf37baca8e2566652e7c98dcf7459"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-attribs" name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a07e5aa32dc875d8ebea046f7ef9aa942" id="r_a07e5aa32dc875d8ebea046f7ef9aa942"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../da/d79/classtarch_1_1logging_1_1Log.html">tarch::logging::Log</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07e5aa32dc875d8ebea046f7ef9aa942">_log</a></td></tr>
<tr class="memdesc:a07e5aa32dc875d8ebea046f7ef9aa942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logging device.  <br /></td></tr>
<tr class="separator:a07e5aa32dc875d8ebea046f7ef9aa942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classtarch_1_1tests_1_1TestCase"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_methods_classtarch_1_1tests_1_1TestCase')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html">tarch::tests::TestCase</a></td></tr>
<tr class="memitem:a74a50f48c8d902e063c94647d5a057d9 inherit pro_methods_classtarch_1_1tests_1_1TestCase" id="r_a74a50f48c8d902e063c94647d5a057d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a74a50f48c8d902e063c94647d5a057d9">TestCase</a> ()=delete</td></tr>
<tr class="separator:a74a50f48c8d902e063c94647d5a057d9 inherit pro_methods_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classtarch_1_1tests_1_1TestCase"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_classtarch_1_1tests_1_1TestCase')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html">tarch::tests::TestCase</a></td></tr>
<tr class="memitem:ae1114b8279a89e3c231ac2251dde25c8 inherit pro_attribs_classtarch_1_1tests_1_1TestCase" id="r_ae1114b8279a89e3c231ac2251dde25c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/df3/CustomRiemann_8template_8h.html#a92b303b76a3f942ea819498907d5e83c">const</a> std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#ae1114b8279a89e3c231ac2251dde25c8">_testCaseName</a></td></tr>
<tr class="memdesc:ae1114b8279a89e3c231ac2251dde25c8 inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the test case.  <br /></td></tr>
<tr class="separator:ae1114b8279a89e3c231ac2251dde25c8 inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba818a0bc030040a5e62326fb6583cc inherit pro_attribs_classtarch_1_1tests_1_1TestCase" id="r_a8ba818a0bc030040a5e62326fb6583cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d99/Prediction_8EnclaveTask_8template_8cpp.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a8ba818a0bc030040a5e62326fb6583cc">_errors</a></td></tr>
<tr class="memdesc:a8ba818a0bc030040a5e62326fb6583cc inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error counter.  <br /></td></tr>
<tr class="separator:a8ba818a0bc030040a5e62326fb6583cc inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ec779329ab2d39cdbdb04f2e634eb4 inherit pro_attribs_classtarch_1_1tests_1_1TestCase" id="r_a44ec779329ab2d39cdbdb04f2e634eb4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d8b/SWIFTMain_8template_8cpp.html#af6a258d8f3ee5206d682d799316314b1">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a44ec779329ab2d39cdbdb04f2e634eb4">_error</a></td></tr>
<tr class="memdesc:a44ec779329ab2d39cdbdb04f2e634eb4 inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate within macro if one specific validation failed.  <br /></td></tr>
<tr class="separator:a44ec779329ab2d39cdbdb04f2e634eb4 inherit pro_attribs_classtarch_1_1tests_1_1TestCase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html#l00016">16</a> of file <a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html">MultiscaleTransitionsTest.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a10d988edff1748d47991c79b1cae7525" name="a10d988edff1748d47991c79b1cae7525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10d988edff1748d47991c79b1cae7525">&#9670;&#160;</a></span>MultiscaleTransitionsTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">toolbox::particles::tests::MultiscaleTransitionsTest::MultiscaleTransitionsTest </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00015">15</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6bb521d4e94c8e2ee8223b589a405d2d" name="a6bb521d4e94c8e2ee8223b589a405d2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb521d4e94c8e2ee8223b589a405d2d">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::run </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This routine is triggered by the TestCaseCollection. </p>

<p>Implements <a class="el" href="../../d5/d8e/classtarch_1_1tests_1_1TestCase.html#a89a48cb757104625eb04adce6a782158">tarch::tests::TestCase</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00162">162</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00024">testMethod</a>.</p>

</div>
</div>
<a id="af9034a229caf9c65da1753928150e8ba" name="af9034a229caf9c65da1753928150e8ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9034a229caf9c65da1753928150e8ba">&#9670;&#160;</a></span>testLiftDropOfParticleAssociatedWithVertex01()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex01 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test the instructions indicatring whether to lift a particle. </p>
<h2><a class="anchor" id="autotoc_md297"></a>
Case</h2>
<p>Within the Swift project, I got the following output:</p>
<div class="fragment"><div class="line">91564839883  00:01:31     rank:0       core:2       info         benchmarks::swift2::noh::observers::StepHydroPartDrift_sweep12peano4_toolbox_particles_api_UpdateParticleGridAssociation_LiftDrop1::touchVertexLastTime(...)                 have to lift particle (debugX=[0.555,0.165],debugH=[0,0],x=[0.554725,0.166678],cellH=[0.111111,0.111111],searchRadius=0.0185185,ParallelState=Local,NewParallelState=Local,MoveState=Moved,CellHasUpdatedParticle=1,cfl=0.1,initialTimeStepSize=0.0001,adjustTimeStepSize=0,hydroDimensions=2,etaFactor=1.2348,smlMin=1e-06,smlMax=0.166667,smlTolerance=0.0001,smlMaxIterations=30,alphaAV=0.8,betaAV=3,mass=2.5e-05,v=[-0.16201,0.986788],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[8.12471e-05,-0.000445081],density=1.00453,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a>=6.71798e-07,smoothingLength=0.00616007,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a>=1.00315e-06,uDot=1.97937e-06,f=-1.06997e-07,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a>=-55596,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a>=-1.3899,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a>=40181.1,hDot=-0.00911606,smoothingLengthIterCount=0,balsara=0.799973,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a>=8.11773e-05,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a>=-2.94711,v_sig_AV=0.0934877,soundSpeed=0.00105575,v_full=[-0.16201,0.986788],<a class="code hl_variable" href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a>=1.00325e-06,hasNoNeighbours=0,isBoundaryParticle=0,partid=1,dependencyChecksPeanoEventUsedBySwift=touchVertexFirstTime,dependencyChecksAlgorithmStepLastUpdated=FlagBoundaryParticles,dependencyChecksAlgorithmStepUpdates=1,...,dependencyChecksAlgorithmStepMaskOuts=0,...,dependencyChecksInitStepLastUpdated=FlagBoundaryParticles,dependencyChecksInitStepUpdates=1,...,dependencyChecksInitStepMaskOuts=0,...) to next coarser vertex 1. Previously assigned to (cell-centre=[0.611111,0.166667],cell-h=[0.111111,0.111111],local=1111,hanging=0000,select=0,has-been-refined=1111,will-be-refined=1111,is-parent-vertex-local=1111,is-parent-cell-local=1)</div>
<div class="ttc" id="abenchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h_html_a08a220d348f01f19a6b0c5d9416bb298"><div class="ttname"><a href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a></div><div class="ttdeci">float pressure</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h_source.html#l00079">equation_of_state.h:79</a></div></div>
<div class="ttc" id="abenchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h_html_ab596bf6dc1a695a2a3d7cad5da0e0f17"><div class="ttname"><a href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a></div><div class="ttdeci">float u</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h_source.html#l00107">equation_of_state.h:107</a></div></div>
<div class="ttc" id="ahydro_8h_html_a08d49d4d0cd7a19361946f2172b74598"><div class="ttname"><a href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a></div><div class="ttdeci">xp u_full</div><div class="ttdef"><b>Definition</b> <a href="../../db/dba/hydro_8h_source.html#l00336">hydro.h:336</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_a380490193b38194b08c2e01ab602b56d"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a></div><div class="ttdeci">pi density rho_dh</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00081">hydro_iact.h:81</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_a485c42a8c0ea9af3d9d1b1405a18fec2"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a></div><div class="ttdeci">pi density wcount_dh</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00083">hydro_iact.h:83</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_a55eb300f7e42f6659c46acaaef6747ec"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a></div><div class="ttdeci">pi density wcount</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00082">hydro_iact.h:82</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_a8cbb00f59bca2c48d4560b23f07a4de2"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a></div><div class="ttdeci">const float const float const float struct part *restrict struct part *restrict const float a</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00055">hydro_iact.h:55</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_a9d08ad2879d60be0a8c742ff0abf4cf5"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a></div><div class="ttdeci">pi density div_v</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00108">hydro_iact.h:108</a></div></div>
<div class="ttc" id="ahydro__iact_8h_html_ad200d1093b1de871d3296a760c6a5cf0"><div class="ttname"><a href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a></div><div class="ttdeci">pi density rot_v[0]</div><div class="ttdef"><b>Definition</b> <a href="../../d0/de2/hydro__iact_8h_source.html#l00116">hydro_iact.h:116</a></div></div>
</div><!-- fragment --><p>That one is just a tiny little bit too much away from its closest vertex (x-marker._cellCentre=[-0.056386,1.1e-05]) and therefore should be assigned to parent 0.</p>
<p>In the subsequent iteration, it should be dropped again. In a version of the code dated 18/12/23, I was not able to see this drop however. I check the drop behaviour in two steps: I first ensure that the particle is not(!) dropped into the very same vertex again, and then I check that it is indeed dropped into the neighbour vertex.</p>
<h2><a class="anchor" id="autotoc_md298"></a>
Realisation</h2>
<p>I depend heavily on the fact that this test is a friend of the vertex marker. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00073">73</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00042">toolbox::particles::dropParticle()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872">toolbox::particles::liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00017">toolbox::particles::ParticleReassociationInstruction_Keep</a>, and <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00119">validateWithParams6</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af9034a229caf9c65da1753928150e8ba_cgraph.png" border="0" usemap="#adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af9034a229caf9c65da1753928150e8ba_cgraph" alt=""/></div>
<map name="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af9034a229caf9c65da1753928150e8ba_cgraph" id="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af9034a229caf9c65da1753928150e8ba_cgraph">
<area shape="rect" title="Test the instructions indicatring whether to lift a particle." alt="" coords="5,27,272,96"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aba49c14d40f0e218fb5d1f95daeb65d6" title=" " alt="" coords="351,5,485,45"/>
<area shape="poly" title=" " alt="" coords="272,41,337,33,337,38,273,47"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local." alt="" coords="320,70,516,125"/>
<area shape="poly" title=" " alt="" coords="273,76,307,80,306,86,272,81"/>
</map>
</div>

</div>
</div>
<a id="a948cbb444f1de74b3054bc5480b9a6d7" name="a948cbb444f1de74b3054bc5480b9a6d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a948cbb444f1de74b3054bc5480b9a6d7">&#9670;&#160;</a></span>testLiftDropOfParticleAssociatedWithVertex02()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex02 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00170">170</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00042">toolbox::particles::dropParticle()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872">toolbox::particles::liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00119">validateWithParams6</a>, and <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00135">validateWithParams7</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_a948cbb444f1de74b3054bc5480b9a6d7_cgraph.png" border="0" usemap="#adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_a948cbb444f1de74b3054bc5480b9a6d7_cgraph" alt=""/></div>
<map name="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_a948cbb444f1de74b3054bc5480b9a6d7_cgraph" id="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_a948cbb444f1de74b3054bc5480b9a6d7_cgraph">
<area shape="rect" title=" " alt="" coords="5,27,272,96"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aba49c14d40f0e218fb5d1f95daeb65d6" title=" " alt="" coords="351,5,485,45"/>
<area shape="poly" title=" " alt="" coords="272,41,337,33,337,38,273,47"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local." alt="" coords="320,70,516,125"/>
<area shape="poly" title=" " alt="" coords="273,76,307,80,306,86,272,81"/>
</map>
</div>

</div>
</div>
<a id="ab16bdd50cac983f6d181cacd6899120f" name="ab16bdd50cac983f6d181cacd6899120f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16bdd50cac983f6d181cacd6899120f">&#9670;&#160;</a></span>testLiftDropOfParticleAssociatedWithVertex03()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex03 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> Another test from the Swift runs where seven particles disappeared

 This is the dump of the seven missing particles. We only focus on the
 first one from hereon:

 @icode 
</pre><ul>
<li>(HydroPart,[0.0555708,0.322228]): -&gt;(moved-while-associated-to-vertex,[0.05,0.32]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[0,0.333333],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li>(HydroPart,[0.0556128,0.33212]): -&gt;(moved-while-associated-to-vertex,[0.05,0.33]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[0,0.333333],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li>(HydroPart,[0.944203,0.618454]): -&gt;(moved-while-associated-to-vertex,[0.95,0.62]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[1,0.666667],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li>(HydroPart,[0.944236,0.628335]): -&gt;(moved-while-associated-to-vertex,[0.95,0.63]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[1,0.666667],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li>(HydroPart,[0.944271,0.638218]): -&gt;(moved-while-associated-to-vertex,[0.95,0.64]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[1,0.666667],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li>(HydroPart,[0.944308,0.648103]): -&gt;(moved-while-associated-to-vertex,[0.95,0.65]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[1,0.666667],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)</li>
<li><p class="startli">(HydroPart,[0.944347,0.65799]): -&gt;(moved-while-associated-to-vertex,[0.95,0.66]-&gt;x_new,tree=0,trace=substitute-for-whole-trajectory)-&gt;(detach-from-vertex,local=1,x=[1,0.666667],h=[0.111111,0.111111],tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_LiftDrop::__Template_LiftOrReassignParticles) </p>
<p class="startli">This is due to lifts without the corresponding drops. We can see the following line for the first particle:</p>
<div class="fragment"><div class="line">482512398740 00:08:02     rank:0       core:7       info         benchmarks::swift2::noh::vertexdata::HydroPartSet::mergeWithParticle(...)                           inflying particle=(debugX=[0.05,0.32],debugH=[0,0],x=[0.0555708,0.322228],cellH=[0.111111,0.111111],searchRadius=0.0555556,ParallelState=Virtual,MoveState=Moved,CellHasUpdatedParticle=1,mass=0.0001,v=[0.928474,0.37139],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[-0.000587972,-0.000240799],density=1.01022,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a>=6.76278e-07,smoothingLength=0.0122854,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a>=1.00416e-06,uDot=1.39669e-06,v_full=[0.928473,0.37139],<a class="code hl_variable" href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a>=1.00416e-06,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a>=10102.2,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a>=-6995.6,f=-4.27191e-07,hDot=-0.0128069,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a>=-0.69956,smoothingLengthIterCount=0,hasNoNeighbours=0,isBoundaryParticle=0,partid=1,cfl=0.1,initialTimeStepSize=0.001,adjustTimeStepSize=0,hydroDimensions=2,etaFactor=1.2348,smlMin=1e-06,smlMax=0.166667,smlTolerance=0.0001,smlMaxIterations=30,alphaAV=0.8,betaAV=3,balsara=0.799889,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a>=0.000278591,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a>=-2.07604,v_sig_AV=0.140208,soundSpeed=0.00105628,dependencyChecksPeanoEventUsedBySwift=touchVertexFirstTime,dependencyChecksAlgorithmStepLastUpdated=FlagBoundaryParticles,dependencyChecksAlgorithmStepUpdates=1,...,dependencyChecksAlgorithmStepMaskOuts=0,...,dependencyChecksInitStepLastUpdated=FlagBoundaryParticles,dependencyChecksInitStepUpdates=1,...,dependencyChecksInitStepMaskOuts=0,...) at vertex (cell-centre=[0.0555556,0.388889],cell-h=[0.111111,0.111111],local=1111,hanging=0000,select=1,has-been-refined=0000,will-be-refined=0000,is-parent-vertex-local=1111,is-parent-cell-local=1,rel-pos-within-father=[0,0],is-adjacent-cell-local=110110000,x(selected)=[0.111111,0.333333]) is new and will be remote on tree  1 (marker=(cell-centre=[0.0555556,0.388889],cell-h=[0.111111,0.111111],local=1111,hanging=0000,select=1,has-been-refined=0000,will-be-refined=0000,is-parent-vertex-local=1111,is-parent-cell-local=1,rel-pos-within-father=[0,0],is-adjacent-cell-local=110110000,x(selected)=[0.111111,0.333333]))</div>
</div><!-- fragment --><p class="startli">so the particle has been local on tree 0 and remote on tree 1, before it started to move. Then it moves and is lifted. We obtain only one drop after that. That drop yields a remote particle on tree 1, i.e. it seems that it is really only dropped on tree 1. And on this tree 1, it is then erased, as it is not local. What we'd like to see is that it is</p><ul>
<li>dropped on both tree 0 and tree 1, with one of them yielding a local particle; or</li>
<li>dropped on either of the trees where it yields a local particle.</li>
</ul>
</li>
</ul>
<div class="image">
<img src="../../MultiscaleTransitionsTest_testLiftDropOfParticleAssociatedWithVertex03.png" alt=""/>
</div>
<p>After studying the setup, it became clear that the sorting per se was correct: The problem here is that the particle should never have ended up on the fine level anyway. If it is there, it should be lifted and counted there, which it is not apparently. So the lift/drop behaves correctly, but the constellation is ill-posed in the first place. If we remove the search radius (as in the implementation of the test), the code shows the correct behaviour.</p>
<p>Once we have assessed the original setup, we therefore return to the large search radius of 0.0555556 </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00228">228</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d1/de0/MultiscaleTransitions_8cpph_source.html#l00042">toolbox::particles::dropParticle()</a>, <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00038">toolbox::particles::internal::fitsIntoLevel()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872">toolbox::particles::liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00017">toolbox::particles::ParticleReassociationInstruction_Keep</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">toolbox::particles::ParticleReassociationInstruction_SieveGlobally</a>, <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00023">toolbox::particles::internal::relativeGrabOwnershipSpatialSortingTolerance()</a>, <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00008">toolbox::particles::internal::relativeReleaseOwnershipSpatialSortingTolerance()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162">toolbox::particles::sieveParticle()</a>, <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00318">validateEqualsWithParams1</a>, <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00359">validateEqualsWithParams5</a>, <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00059">validateWithParams1</a>, and <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00105">validateWithParams5</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab16bdd50cac983f6d181cacd6899120f_cgraph.png" border="0" usemap="#adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab16bdd50cac983f6d181cacd6899120f_cgraph" alt=""/></div>
<map name="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab16bdd50cac983f6d181cacd6899120f_cgraph" id="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab16bdd50cac983f6d181cacd6899120f_cgraph">
<area shape="rect" title=" " alt="" coords="5,179,272,248"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aba49c14d40f0e218fb5d1f95daeb65d6" title=" " alt="" coords="375,5,509,45"/>
<area shape="poly" title=" " alt="" coords="169,176,234,114,275,82,319,55,360,38,362,43,321,60,278,87,238,118,173,180"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#afe9b28ff4e7fe6168023804a2fb96242" title=" " alt="" coords="358,69,526,109"/>
<area shape="poly" title=" " alt="" coords="200,176,257,147,319,120,345,111,347,116,321,125,259,152,203,181"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local." alt="" coords="344,134,540,189"/>
<area shape="poly" title=" " alt="" coords="272,188,330,178,331,183,273,193"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#a4fa20e3efb2e06ead5e27709f8194476" title=" " alt="" coords="323,237,561,291"/>
<area shape="poly" title=" " alt="" coords="273,233,310,239,309,244,272,238"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#ae9c85bca69dc0117fa89c6e95c617c9d" title=" " alt="" coords="320,339,564,394"/>
<area shape="poly" title=" " alt="" coords="209,246,376,331,373,335,207,251"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162" title="A particle is to be sieved into a vertex if." alt="" coords="375,419,509,459"/>
<area shape="poly" title=" " alt="" coords="165,247,193,284,229,327,273,369,321,404,362,422,360,427,319,409,269,373,226,330,189,287,161,250"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="612,53,785,78"/>
<area shape="poly" title=" " alt="" coords="526,79,598,72,598,77,526,84"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="645,102,753,127"/>
<area shape="poly" title=" " alt="" coords="526,95,632,105,631,111,526,100"/>
<area shape="poly" title=" " alt="" coords="392,237,393,226,401,218,418,212,442,210,471,213,487,221,485,226,469,218,442,215,419,217,404,222,397,228,398,237"/>
<area shape="poly" title=" " alt="" coords="392,339,393,329,401,320,418,315,442,313,471,316,487,324,485,328,469,321,442,318,419,320,404,325,397,331,398,339"/>
</map>
</div>

</div>
</div>
<a id="af13cf37baca8e2566652e7c98dcf7459" name="af13cf37baca8e2566652e7c98dcf7459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13cf37baca8e2566652e7c98dcf7459">&#9670;&#160;</a></span>testLiftDropOfParticleAssociatedWithVertex04()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::testLiftDropOfParticleAssociatedWithVertex04 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> Another lift/drop test

 I found the following entry in the database after a particle had disappeared:

 @icode 
</pre><ul>
<li><p class="startli">(HydroPart,[0.5,0.5]): -&gt;(detach-from-vertex,local=1,x=[0.333333,0.333333],h=[0.333333,0.333333],tree=0,trace=UpdateParticleGridAssociation_BucketSort::__Template_LiftParticles)-&gt;(assign-to-sieve-set,local=1,tree=0,trace=UpdateParticleGridAssociation_BucketSort::__Template_LiftParticles) (<a href="file:assignmentchecks/TracingAPI.cpp,line:836">file:assignmentchecks/TracingAPI.cpp,line:836</a>) </p>
<p class="startli">This particle resides exactly in the centre of a cell and seems to be lifted, which contradicts our working assumption that vertices are careful with releasing particles and not aggressive when it comes to grabbing them.</p>
<p class="startli">The lift stems from this place: </p><div class="fragment"><div class="line">496656108    00:00:00     rank:0       core:1       info         benchmarks::swift2::noh::observers::StepHydroPartDrift_sweep12peano4_toolbox_particles_api_UpdateParticleGridAssociation_BucketSort0::touchVertexLastTime(...) lift particle (,x=[0.5,0.5],cellH=[0.333333,0.333333],searchRadius=0.15,ParallelState=Local,MoveState=Moved,CellHasUpdatedParticle=1,mass=0.01,v=[-3.51825e-06,3.5199e-06],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[1.29168e-05,-9.76758e-05],density=1.01558,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a>=6.80968e-07,smoothingLength=0.12252,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a>=1.00578e-06,uDot=1.15969e-05,v_full=[-3.5176e-06,3.51502e-06],<a class="code hl_variable" href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a>=1.00578e-06,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a>=101.558,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a>=-14.06,f=0,hDot=-1.06525,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a>=-0.1406,smoothingLengthIterCount=0,hasNoNeighbours=0,isBoundaryParticle=0,partid=1,cfl=0.1,initialTimeStepSize=0.0001,adjustTimeStepSize=0,hydroDimensions=2,etaFactor=1.2348,smlMin=1e-06,smlMax=0.166667,smlTolerance=0.0001,smlMaxIterations=30,alphaAV=0.8,betaAV=3,balsara=0.8,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a>=4.39144e-07,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a>=-17.2853,v_sig_AV=3.00064,soundSpeed=0.00105714) globally. Previously assigned to (cell-centre=[0.166667,0.5],cell-h=[0.333333,0.333333],local=1011,hanging=0000,select=1,has-been-refined=0000,will-be-refined=0000,is-parent-vertex-local=1111,is-parent-cell-local=0,rel-pos-within-father=[0,1],is-adjacent-cell-local=000100110,x(selected)=[0.333333,0.333333])</div>
<div class="line">500006642    00:00:00     rank:0       core:2       info         <a class="code hl_namespace" href="../../d3/d22/namespacebenchmarks.html">benchmarks</a>::<a class="code hl_namespace" href="../../de/dac/namespaceswift2.html">swift2</a>::<a class="code hl_namespace" href="../../d3/d2a/namespacenoh.html">noh</a>::repositories::GlobalState::finishIntermediateStep() sort statistics: <span class="preprocessor">#lifts=0, #drops=0, #lifts-into-sieve-set=1, #drops-from-sieve-set=0, #drops-into-horizontal-tree-decomposition=0, #reassignments=0</span></div>
<div class="ttc" id="anamespacebenchmarks_html"><div class="ttname"><a href="../../d3/d22/namespacebenchmarks.html">benchmarks</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d80/Poisson_8h_source.html#l00015">Poisson.h:15</a></div></div>
<div class="ttc" id="anamespacenoh_html"><div class="ttname"><a href="../../d3/d2a/namespacenoh.html">noh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/daf/benchmarks_2swift2_2hydro_2noh-implosion-test-2D_2noh_8py_source.html#l00001">noh.py:1</a></div></div>
<div class="ttc" id="anamespaceswift2_html"><div class="ttname"><a href="../../de/dac/namespaceswift2.html">swift2</a></div><div class="ttdoc">This file is part of the SWIFT 2 project.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d65/FixedBoundary_8h_source.html#l00008">FixedBoundary.h:8</a></div></div>
</div><!-- fragment --><p class="startli">Funny enough, this particular bug did arise only for two threads, but passed with eight. Digging into the output revealed that the inflying particle seems to not to be local on either rank:</p>
<div class="fragment"><div class="line">1616501080   00:00:01     rank:0       core:7       info         benchmarks::swift2::noh::observers::StepHydroPartDrift_sweep12peano4_toolbox_particles_api_UpdateParticleGridAssociation_BucketSort0::touchVertexLastTime(...) lift particle (,x=[0.5,0.5],cellH=[0.333333,0.333333],searchRadius=0.15,ParallelState=Local,MoveState=Moved,CellHasUpdatedParticle=1,mass=0.01,v=[-3.51825e-06,3.5199e-06],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[1.29168e-05,-9.76758e-05],density=1.01558,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a>=6.80968e-07,smoothingLength=0.12252,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a>=1.00578e-06,uDot=1.15969e-05,v_full=[-3.5176e-06,3.51502e-06],<a class="code hl_variable" href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a>=1.00578e-06,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a>=101.558,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a>=-14.06,f=0,hDot=-1.06525,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a>=-0.1406,smoothingLengthIterCount=0,hasNoNeighbours=0,isBoundaryParticle=0,partid=1,cfl=0.1,initialTimeStepSize=0.0001,adjustTimeStepSize=0,hydroDimensions=2,etaFactor=1.2348,smlMin=1e-06,smlMax=0.166667,smlTolerance=0.0001,smlMaxIterations=30,alphaAV=0.8,betaAV=3,balsara=0.8,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a>=4.39144e-07,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a>=-17.2853,v_sig_AV=3.00064,soundSpeed=0.00105714) globally from tree 0. Previously assigned to (cell-centre=[0.166667,0.5],cell-h=[0.333333,0.333333],local=1011,hanging=0000,select=1,has-been-refined=0000,will-be-refined=0000,is-parent-vertex-local=1111,is-parent-cell-local=0,rel-pos-within-father=[0,1],is-adjacent-cell-local=000100110,x(selected)=[0.333333,0.333333])</div>
<div class="line">1620846099   00:00:01     rank:0       core:6       info         <a class="code hl_namespace" href="../../d3/d22/namespacebenchmarks.html">benchmarks</a>::<a class="code hl_namespace" href="../../de/dac/namespaceswift2.html">swift2</a>::<a class="code hl_namespace" href="../../d3/d2a/namespacenoh.html">noh</a>::observers::DummyStepHydroPartPredictHydro_sweep22peano4_toolbox_particles_api_UpdateParticleGridAssociation_BucketSort0::touchVertexFirstTime() now we drop particle (,x=[0.5,0.5],cellH=[0.333333,0.333333],searchRadius=0.15,ParallelState=Local,MoveState=Moved,CellHasUpdatedParticle=1,mass=0.01,v=[-3.51825e-06,3.5199e-06],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[1.29168e-05,-9.76758e-05],density=1.01558,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#a08a220d348f01f19a6b0c5d9416bb298">pressure</a>=6.80968e-07,smoothingLength=0.12252,<a class="code hl_variable" href="../../dd/dc9/benchmarks_2other_2noh2d-common_2swift_2equation__of__state_8h.html#ab596bf6dc1a695a2a3d7cad5da0e0f17">u</a>=1.00578e-06,uDot=1.15969e-05,v_full=[-3.5176e-06,3.51502e-06],<a class="code hl_variable" href="../../db/dba/hydro_8h.html#a08d49d4d0cd7a19361946f2172b74598">u_full</a>=1.00578e-06,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a55eb300f7e42f6659c46acaaef6747ec">wcount</a>=101.558,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a485c42a8c0ea9af3d9d1b1405a18fec2">wcount_dh</a>=-14.06,f=0,hDot=-1.06525,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a380490193b38194b08c2e01ab602b56d">rho_dh</a>=-0.1406,smoothingLengthIterCount=0,hasNoNeighbours=0,isBoundaryParticle=0,partid=1,cfl=0.1,initialTimeStepSize=0.0001,adjustTimeStepSize=0,hydroDimensions=2,etaFactor=1.2348,smlMin=1e-06,smlMax=0.166667,smlTolerance=0.0001,smlMaxIterations=30,alphaAV=0.8,betaAV=3,balsara=0.8,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#ad200d1093b1de871d3296a760c6a5cf0">rot_v</a>=4.39144e-07,<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a9d08ad2879d60be0a8c742ff0abf4cf5">div_v</a>=-17.2853,v_sig_AV=3.00064,soundSpeed=0.00105714)</div>
</div><!-- fragment --> </li>
</ul>

<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00343">343</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00038">toolbox::particles::internal::fitsIntoLevel()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872">toolbox::particles::liftParticleAssociatedWithVertex()</a>, <a class="el" href="../../d0/d10/Scalar_8h_source.html#l00017">tarch::la::NUMERICAL_ZERO_DIFFERENCE</a>, <a class="el" href="../../d6/dc2/MultiscaleTransitions_8h_source.html#l00018">toolbox::particles::ParticleReassociationInstruction_SieveGlobally</a>, <a class="el" href="../../d3/dc0/internal_8cpp_source.html#l00008">toolbox::particles::internal::relativeReleaseOwnershipSpatialSortingTolerance()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162">toolbox::particles::sieveParticle()</a>, <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00318">validateEqualsWithParams1</a>, and <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00105">validateWithParams5</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af13cf37baca8e2566652e7c98dcf7459_cgraph.png" border="0" usemap="#adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af13cf37baca8e2566652e7c98dcf7459_cgraph" alt=""/></div>
<map name="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af13cf37baca8e2566652e7c98dcf7459_cgraph" id="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_af13cf37baca8e2566652e7c98dcf7459_cgraph">
<area shape="rect" title=" " alt="" coords="5,131,272,201"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#afe9b28ff4e7fe6168023804a2fb96242" title=" " alt="" coords="358,22,526,62"/>
<area shape="poly" title=" " alt="" coords="200,129,257,100,319,73,345,64,347,69,321,78,259,105,203,134"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#aca8ad847edf923b82ac67aed84f87872" title="Take particle from current vertex and lift it or keep it local." alt="" coords="344,87,540,141"/>
<area shape="poly" title=" " alt="" coords="272,140,330,130,331,136,273,146"/>
<area shape="rect" href="../../d0/d68/namespacetoolbox_1_1particles_1_1internal.html#ae9c85bca69dc0117fa89c6e95c617c9d" title=" " alt="" coords="320,189,564,244"/>
<area shape="poly" title=" " alt="" coords="273,186,307,191,306,197,272,191"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162" title="A particle is to be sieved into a vertex if." alt="" coords="375,269,509,309"/>
<area shape="poly" title=" " alt="" coords="202,198,259,227,321,254,362,268,360,273,319,259,257,232,200,203"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a5e951ee2e1896bb641af43b495dc1e4a" title=" " alt="" coords="612,5,785,31"/>
<area shape="poly" title=" " alt="" coords="526,32,598,25,598,30,526,37"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#af593db8b0c3c24bfae8b1aaeeda9782b" title="Returns the element with minimal value (NOT absolute value)." alt="" coords="645,55,753,80"/>
<area shape="poly" title=" " alt="" coords="526,48,632,58,631,63,526,53"/>
<area shape="poly" title=" " alt="" coords="392,189,393,179,401,170,418,165,442,163,471,166,487,174,485,178,469,171,442,168,419,170,404,175,397,181,398,189"/>
</map>
</div>

</div>
</div>
<a id="ab3c4fb97761cb42f78a10ec0216deb80" name="ab3c4fb97761cb42f78a10ec0216deb80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c4fb97761cb42f78a10ec0216deb80">&#9670;&#160;</a></span>testSievePredicate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4d/FaceIntegral_8template_8cpp.html#a7ce6528e12d0effe4d57054974659f90">void</a> toolbox::particles::tests::MultiscaleTransitionsTest::testSievePredicate </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test setup from the Swift test case: </p>
<div class="fragment"><div class="line">      ...::touchVertexFirstTime(...)                       ok, let<span class="stringliteral">&#39;s sieve:</span></div>
<div class="line"><span class="stringliteral">(debugX=[0.75,0.5],debugH=[0,0],x=[0.721487,0.624479],ParallelState=Local,searchRadius=0.0001,MoveState=Moved,CellHasUpdatedParticle=0,v=[-0.728231,1.39488],a=[-7.97473,-4.38055],energyKin=1.23859,energyPot=2.3109,energyTot=1.07232)</span></div>
<div class="line"><span class="stringliteral">into ([0.685185,0.648148],[0.037037,0.037037],hanging=0000,select=1)</span></div>
</div><!-- fragment --><p>So it is clear that this sieve should go through. This info is fine, and the unit test simply confirms it. In the test case, this event/message did arise twice when I run the code with two trees. Which is, in principle, fine, given that the vertex of interest might be exactly at the domain boundary.</p>
<p>I would now expect one cell to say "hey, this particle is local here". As particles are associated to vertices, we might to get up to three "no, not here" messages if a vertex is local. These numbers refer to a 2d setup. However, I got</p>
<div class="fragment"><div class="line">      touchVertexFirstTime(...) ok, let&#39;s sieve:</div>
<div class="line">(debugX=[0.75,0.5],debugH=[0,0],x=[0.721487,0.624479],ParallelState=Virtual,searchRadius=0.0001,MoveState=Moved,CellHasUpdatedParticle=0,v=[-0.728231,1.39488],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[-7.97473,-4.38055],energyKin=1.23859,energyPot=2.3109,energyTot=1.07232)</div>
<div class="line">into ([0.685185,0.648148],[0.037037,0.037037],hanging=0000,select=1) on tree 0 enterCell(...)            cannot</div>
<div class="line">confirm (yet) that particle is local on tree 0:</div>
<div class="line">particle=(debugX=[0.75,0.5],debugH=[0,0],x=[0.721487,0.624479],ParallelState=Virtual,searchRadius=0.0001,MoveState=Moved,CellHasUpdatedParticle=0,v=[-0.728231,1.39488],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[-7.97473,-4.38055],energyKin=1.23859,energyPot=2.3109,energyTot=1.07232),</div>
<div class="line">cell=(x=[0.685185,0.648148],h=[0.037037,0.037037],has-been-refined=0,will-be-refined=0,is-local=1,one-vertex-hanging=0,one-vertex-destroyed/created=0,all-vertices-inside-domain=0,no-lb=1,rel-pos=[0,2],has-been-enclave=0,will-be-enclave=0)</div>
<div class="line">      enterCell(...)            cannot confirm (yet) that particle is local on tree 0:</div>
<div class="line">particle=(debugX=[0.75,0.5],debugH=[0,0],x=[0.721487,0.624479],ParallelState=Virtual,searchRadius=0.0001,MoveState=Moved,CellHasUpdatedParticle=0,v=[-0.728231,1.39488],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[-7.97473,-4.38055],energyKin=1.23859,energyPot=2.3109,energyTot=1.07232),</div>
<div class="line">cell=(x=[0.722222,0.648148],h=[0.037037,0.037037],has-been-refined=0,will-be-refined=0,is-local=1,one-vertex-hanging=0,one-vertex-destroyed/created=0,all-vertices-inside-domain=0,no-lb=1,rel-pos=[1,2],has-been-enclave=0,will-be-enclave=0)</div>
<div class="line">      enterCell(...)            cannot confirm (yet) that particle is local on tree 0:</div>
<div class="line">particle=(debugX=[0.75,0.5],debugH=[0,0],x=[0.721487,0.624479],ParallelState=Local,searchRadius=0.0001,MoveState=Moved,CellHasUpdatedParticle=0,v=[-0.728231,1.39488],<a class="code hl_variable" href="../../d0/de2/hydro__iact_8h.html#a8cbb00f59bca2c48d4560b23f07a4de2">a</a>=[-7.97473,-4.38055],energyKin=1.23859,energyPot=2.3109,energyTot=1.07232),</div>
<div class="line">cell=(x=[0.685185,0.611111],h=[0.037037,0.037037],has-been-refined=0,will-be-refined=0,is-local=1,one-vertex-hanging=0,one-vertex-destroyed/created=0,all-vertices-inside-domain=0,no-lb=1,rel-pos=[0,1],has-been-enclave=0,will-be-enclave=0)</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html#l00018">18</a> of file <a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../da/dfd/ScalarOperations_8cpph_source.html#l00015">tarch::la::abs()</a>, <a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162">toolbox::particles::sieveParticle()</a>, and <a class="el" href="../../dc/d61/TestMacros_8h_source.html#l00119">validateWithParams6</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab3c4fb97761cb42f78a10ec0216deb80_cgraph.png" border="0" usemap="#adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab3c4fb97761cb42f78a10ec0216deb80_cgraph" alt=""/></div>
<map name="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab3c4fb97761cb42f78a10ec0216deb80_cgraph" id="adb/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest_ab3c4fb97761cb42f78a10ec0216deb80_cgraph">
<area shape="rect" title="Test setup from the Swift test case:" alt="" coords="5,20,212,75"/>
<area shape="rect" href="../../d2/d45/namespacetarch_1_1la.html#a429fdf3a84e551ee1023ef7ec3abb631" title="Returns the absolute value of a type by redirecting to std::abs." alt="" coords="274,5,381,31"/>
<area shape="poly" title=" " alt="" coords="212,31,260,24,261,30,213,36"/>
<area shape="rect" href="../../d0/d29/namespacetoolbox_1_1particles.html#a87df833da9d9721541a2828f40b09162" title="A particle is to be sieved into a vertex if." alt="" coords="260,55,395,95"/>
<area shape="poly" title=" " alt="" coords="213,58,247,62,246,68,212,63"/>
<area shape="rect" href="../../d8/dcc/namespacestd.html#abdf604272c8422a961aaedd1d68de0bd" title=" " alt="" coords="443,5,516,31"/>
<area shape="poly" title=" " alt="" coords="381,15,429,15,429,21,381,21"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a07e5aa32dc875d8ebea046f7ef9aa942" name="a07e5aa32dc875d8ebea046f7ef9aa942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e5aa32dc875d8ebea046f7ef9aa942">&#9670;&#160;</a></span>_log</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d79/classtarch_1_1logging_1_1Log.html">tarch::logging::Log</a> toolbox::particles::tests::MultiscaleTransitionsTest::_log</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Logging device. </p>

<p class="definition">Definition at line <a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html#l00021">21</a> of file <a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html">MultiscaleTransitionsTest.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/toolbox/particles/tests/<a class="el" href="../../de/d94/MultiscaleTransitionsTest_8h_source.html">MultiscaleTransitionsTest.h</a></li>
<li>src/toolbox/particles/tests/<a class="el" href="../../d9/d93/MultiscaleTransitionsTest_8cpp_source.html">MultiscaleTransitionsTest.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/dd9/namespacetoolbox.html">toolbox</a></li><li class="navelem"><a class="el" href="../../d0/d29/namespacetoolbox_1_1particles.html">particles</a></li><li class="navelem"><a class="el" href="../../d1/dd4/namespacetoolbox_1_1particles_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="../../db/d7c/classtoolbox_1_1particles_1_1tests_1_1MultiscaleTransitionsTest.html">MultiscaleTransitionsTest</a></li>
    <li class="footer">Generated on Tue Jul 1 2025 11:31:10 for Peano by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
